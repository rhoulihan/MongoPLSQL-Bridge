<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MongoPLSQL-Bridge Test Catalog</title>
    <style>
        :root {
            --bg-primary: #1a1a2e;
            --bg-secondary: #16213e;
            --bg-card: #0f3460;
            --text-primary: #e8e8e8;
            --text-secondary: #a0a0a0;
            --accent: #00d9ff;
            --accent-hover: #00b8d9;
            --success: #4caf50;
            --warning: #ff9800;
            --error: #f44336;
            --border: #2a2a4a;
            --code-bg: #0d1b2a;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container { max-width: 1600px; margin: 0 auto; padding: 20px; }

        /* Header */
        header {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-card) 100%);
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 24px;
            border: 1px solid var(--border);
        }

        header h1 {
            font-size: 2rem;
            margin-bottom: 8px;
            background: linear-gradient(90deg, var(--accent), #7b68ee);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        header .subtitle { color: var(--text-secondary); font-size: 1rem; }
        .generated-time { color: var(--text-secondary); font-size: 0.85rem; margin-top: 8px; }

        /* Test Suite Tabs */
        .suite-tabs {
            display: flex;
            gap: 4px;
            margin-bottom: 24px;
            background: var(--bg-secondary);
            padding: 8px;
            border-radius: 12px;
            border: 1px solid var(--border);
            flex-wrap: wrap;
        }

        .suite-tab {
            padding: 12px 24px;
            background: transparent;
            border: none;
            border-radius: 8px;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }

        .suite-tab:hover { color: var(--text-primary); background: rgba(255,255,255,0.05); }
        .suite-tab.active { background: var(--accent); color: var(--bg-primary); }
        .suite-tab .count { font-size: 0.75rem; opacity: 0.8; }

        /* Summary Cards */
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .summary-card {
            background: var(--bg-secondary);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid var(--border);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .summary-card:hover { transform: translateY(-2px); box-shadow: 0 4px 20px rgba(0, 217, 255, 0.1); }
        .summary-card .value { font-size: 2.5rem; font-weight: bold; }
        .summary-card .label { color: var(--text-secondary); font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; }
        .summary-card.total .value { color: var(--accent); }
        .summary-card.passed .value { color: var(--success); }
        .summary-card.failed .value { color: var(--error); }
        .summary-card.skipped .value { color: var(--warning); }

        /* Controls */
        .controls { display: flex; gap: 16px; margin-bottom: 24px; flex-wrap: wrap; align-items: center; }

        .search-box { flex: 1; min-width: 250px; position: relative; }

        .search-box input {
            width: 100%;
            padding: 12px 16px 12px 44px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 1rem;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .search-box input:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 3px rgba(0, 217, 255, 0.1); }
        .search-box::before { content: "\1F50D"; position: absolute; left: 14px; top: 50%; transform: translateY(-50%); font-size: 1.1rem; }

        .filter-group { display: flex; gap: 8px; flex-wrap: wrap; }

        .filter-btn {
            padding: 8px 16px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 20px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
        }

        .filter-btn:hover { border-color: var(--accent); color: var(--text-primary); }
        .filter-btn.active { background: var(--accent); border-color: var(--accent); color: var(--bg-primary); }

        /* Category Tabs */
        .category-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 24px;
            padding: 16px;
            background: var(--bg-secondary);
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .category-tab {
            padding: 10px 18px;
            background: transparent;
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .category-tab:hover { border-color: var(--accent); color: var(--text-primary); }
        .category-tab.active { background: var(--accent); border-color: var(--accent); color: var(--bg-primary); }
        .category-tab .count { background: rgba(0,0,0,0.2); padding: 2px 8px; border-radius: 12px; font-size: 0.8rem; }
        .category-tab.active .count { background: rgba(0,0,0,0.3); }

        /* Test List */
        .test-list { display: flex; flex-direction: column; gap: 12px; }

        /* Test Card */
        .test-card {
            background: var(--bg-secondary);
            border-radius: 12px;
            border: 1px solid var(--border);
            overflow: hidden;
            transition: box-shadow 0.2s;
        }

        .test-card:hover { box-shadow: 0 4px 24px rgba(0, 0, 0, 0.3); }
        .test-card.status-pass { border-left: 4px solid var(--success); }
        .test-card.status-fail { border-left: 4px solid var(--error); }
        .test-card.status-skip { border-left: 4px solid var(--warning); }
        .test-card.status-error { border-left: 4px solid var(--error); }

        .test-header {
            padding: 14px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            user-select: none;
        }

        .test-header:hover { background: rgba(0, 217, 255, 0.05); }
        .test-info { display: flex; align-items: center; gap: 16px; flex: 1; flex-wrap: wrap; }
        .test-id { font-family: 'Monaco', 'Menlo', monospace; font-size: 0.85rem; color: var(--accent); background: var(--code-bg); padding: 4px 10px; border-radius: 6px; }
        .test-name { font-weight: 500; font-size: 0.95rem; }
        .test-operator { color: var(--text-secondary); font-size: 0.8rem; background: var(--bg-card); padding: 3px 10px; border-radius: 4px; }
        .test-meta { display: flex; align-items: center; gap: 12px; flex-wrap: wrap; }

        .status-badge { padding: 4px 12px; border-radius: 16px; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; }
        .status-badge.pass { background: var(--success); color: white; }
        .status-badge.fail { background: var(--error); color: white; }
        .status-badge.skip { background: var(--warning); color: black; }
        .status-badge.error { background: var(--error); color: white; }
        .status-badge.na { background: var(--text-secondary); color: white; }

        .match-indicator { width: 12px; height: 12px; border-radius: 50%; display: inline-block; margin-left: 6px; vertical-align: middle; }
        .match-indicator.strict { background: var(--success); box-shadow: 0 0 4px var(--success); }
        .match-indicator.loose { background: var(--warning); box-shadow: 0 0 4px var(--warning); }
        .match-indicator.none { background: var(--error); box-shadow: 0 0 4px var(--error); }
        .match-indicator.unknown { background: var(--text-secondary); }

        .count-badge { font-size: 0.8rem; color: var(--text-secondary); }
        .expand-icon { font-size: 1.2rem; color: var(--text-secondary); transition: transform 0.3s; }
        .test-card.expanded .expand-icon { transform: rotate(180deg); }

        /* Test Details */
        .test-details { display: none; padding: 0 20px 20px; border-top: 1px solid var(--border); }
        .test-card.expanded .test-details { display: block; }
        .test-description { padding: 16px 0; color: var(--text-secondary); font-size: 0.9rem; }

        /* Code Tabs */
        .code-tabs { display: flex; gap: 4px; margin-bottom: 0; background: var(--bg-card); padding: 8px 8px 0; border-radius: 8px 8px 0 0; }
        .code-tab { padding: 10px 20px; background: transparent; border: none; border-radius: 6px 6px 0 0; color: var(--text-secondary); cursor: pointer; font-size: 0.9rem; transition: all 0.2s; }
        .code-tab:hover { color: var(--text-primary); background: rgba(255,255,255,0.05); }
        .code-tab.active { background: var(--code-bg); color: var(--accent); }

        .code-panels { background: var(--code-bg); border-radius: 0 0 8px 8px; overflow: hidden; }
        .code-panel { display: none; padding: 16px; max-height: 350px; overflow: auto; }
        .code-panel.active { display: block; }

        pre { margin: 0; font-family: 'Monaco', 'Menlo', 'Consolas', monospace; font-size: 0.8rem; line-height: 1.5; white-space: pre-wrap; word-break: break-word; }
        .json-code { color: #98c379; }
        .sql-code { color: #61afef; }

        /* Results Section */
        .results-section { margin-top: 16px; }
        .results-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .results-header h4 { color: var(--text-primary); font-size: 1rem; }

        .run-test-btn {
            padding: 8px 20px;
            background: linear-gradient(135deg, var(--accent), #7b68ee);
            border: none;
            border-radius: 6px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .run-test-btn:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(0, 217, 255, 0.3); }
        .run-test-btn:disabled { opacity: 0.5; cursor: not-allowed; }

        .results-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
        .result-panel { background: var(--code-bg); border-radius: 8px; overflow: hidden; }
        .result-panel-header { padding: 10px 16px; background: var(--bg-card); display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border); }
        .result-panel-header h5 { font-size: 0.85rem; display: flex; align-items: center; gap: 8px; }
        .result-panel-header .count { font-size: 0.75rem; color: var(--text-secondary); }
        .result-panel-content { padding: 12px; max-height: 250px; overflow: auto; font-family: 'Monaco', 'Menlo', monospace; font-size: 0.75rem; color: var(--text-secondary); }

        .comparison-status { margin-top: 12px; padding: 12px 16px; border-radius: 8px; font-size: 0.85rem; }
        .comparison-status.match { background: rgba(76, 175, 80, 0.1); border: 1px solid var(--success); color: var(--success); }
        .comparison-status.mismatch { background: rgba(244, 67, 54, 0.1); border: 1px solid var(--error); color: var(--error); }

        /* Unit/Integration Test Card (simpler) */
        .test-card.simple .test-details { padding: 12px 20px; }
        .test-time { font-size: 0.8rem; color: var(--text-secondary); }

        /* Loading */
        .loading-overlay { display: none; position: fixed; inset: 0; background: var(--bg-primary); z-index: 9999; align-items: center; justify-content: center; flex-direction: column; gap: 16px; }
        .loading-overlay.show { display: flex; }
        .spinner { width: 24px; height: 24px; border: 3px solid var(--border); border-top-color: var(--accent); border-radius: 50%; animation: spin 1s linear infinite; }
        .loading-overlay .spinner { width: 48px; height: 48px; }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* No Results */
        .no-results { text-align: center; padding: 60px 20px; color: var(--text-secondary); }
        .no-results h3 { font-size: 1.2rem; margin-bottom: 8px; }

        /* Settings */
        .settings-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            transition: all 0.2s;
            z-index: 100;
        }
        .settings-btn:hover { background: var(--accent); transform: scale(1.1); }

        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center; }
        .modal.show { display: flex; }
        .modal-content { background: var(--bg-secondary); border-radius: 12px; padding: 24px; max-width: 500px; width: 90%; border: 1px solid var(--border); }
        .modal-content h3 { margin-bottom: 16px; color: var(--accent); }
        .form-group { margin-bottom: 16px; }
        .form-group label { display: block; margin-bottom: 6px; color: var(--text-secondary); font-size: 0.9rem; }
        .form-group input { width: 100%; padding: 10px; background: var(--bg-card); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary); font-size: 0.95rem; }
        .modal-buttons { display: flex; gap: 12px; justify-content: flex-end; margin-top: 20px; }
        .modal-btn { padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 0.95rem; border: 1px solid var(--border); transition: all 0.2s; }
        .modal-btn.primary { background: var(--accent); border-color: var(--accent); color: var(--bg-primary); }
        .modal-btn.secondary { background: transparent; color: var(--text-secondary); }

        @media (max-width: 768px) {
            .controls { flex-direction: column; }
            .search-box { width: 100%; }
            .results-grid { grid-template-columns: 1fr; }
            .test-info, .test-meta { flex-wrap: wrap; }
        }
    </style>


<script id="embedded-test-data">const TEST_CATALOG_DATA = {"generated":"2025-12-05T19:18:14.472498","version":"2.0","summary":{"queryTests":{"total":152,"passed":0,"failed":0,"skipped":0},"largeScaleTests":{"total":10,"passed":10,"failed":0},"unitTests":{"count":0,"passed":0,"failed":0,"skipped":0,"errors":0},"integrationTests":{"count":0,"passed":0,"failed":0,"skipped":0,"errors":0},"overall":{"total":162,"passed":10,"failed":0,"skipped":0}},"categories":{"comparison":{"count":10,"passed":0,"failed":0,"skipped":0,"name":"Comparison Operators"},"logical":{"count":6,"passed":0,"failed":0,"skipped":0,"name":"Logical Operators"},"accumulator":{"count":10,"passed":0,"failed":0,"skipped":0,"name":"Accumulator Operators"},"stage":{"count":7,"passed":0,"failed":0,"skipped":0,"name":"Pipeline Stages"},"arithmetic":{"count":10,"passed":0,"failed":0,"skipped":0,"name":"Arithmetic Operators"},"conditional":{"count":3,"passed":0,"failed":0,"skipped":0,"name":"Conditional Operators"},"complex":{"count":8,"passed":0,"failed":0,"skipped":0,"name":"Complex Pipelines"},"edge":{"count":3,"passed":0,"failed":0,"skipped":0,"name":"Edge Cases"},"string":{"count":14,"passed":0,"failed":0,"skipped":0,"name":"String Operators"},"date":{"count":11,"passed":0,"failed":0,"skipped":0,"name":"Date Operators"},"array":{"count":18,"passed":0,"failed":0,"skipped":0,"name":"Array Operators"},"lookup":{"count":9,"passed":0,"failed":0,"skipped":0,"name":"Lookup Operations"},"unwind":{"count":2,"passed":0,"failed":0,"skipped":0,"name":"Unwind Operations"},"addFields":{"count":2,"passed":0,"failed":0,"skipped":0,"name":"AddFields/Set Operations"},"unionWith":{"count":3,"passed":0,"failed":0,"skipped":0,"name":"Union Operations"},"bucket":{"count":2,"passed":0,"failed":0,"skipped":0,"name":"Bucket Operations"},"bucketAuto":{"count":2,"passed":0,"failed":0,"skipped":0,"name":"BucketAuto Operations"},"facet":{"count":3,"passed":0,"failed":0,"skipped":0,"name":"Facet Operations"},"setWindowFields":{"count":4,"passed":0,"failed":0,"skipped":0,"name":"Window Functions"},"typeConversion":{"count":5,"passed":0,"failed":0,"skipped":0,"name":"Type Conversion"},"redact":{"count":2,"passed":0,"failed":0,"skipped":0,"name":"Redact Operations"},"sample":{"count":2,"passed":0,"failed":0,"skipped":0,"name":"Sample Operations"},"count":{"count":3,"passed":0,"failed":0,"skipped":0,"name":"Count Operations"},"graphLookup":{"count":2,"passed":0,"failed":0,"skipped":0,"name":"Graph Lookup"},"null_handling":{"count":5,"passed":0,"failed":0,"skipped":0,"name":"Null Handling"},"expression":{"count":2,"passed":0,"failed":0,"skipped":0,"name":"Expression Operators"},"replaceRoot":{"count":1,"passed":0,"failed":0,"skipped":0,"name":"Replace Root"},"object":{"count":1,"passed":0,"failed":0,"skipped":0,"name":"Object Operations"},"window":{"count":2,"passed":0,"failed":0,"skipped":0,"name":"Window Operations"},"large_scale":{"count":10,"passed":10,"failed":0,"skipped":0,"name":"Large-Scale Pipelines"}},"testSuites":{"query":{"name":"Cross-Database Query Tests","description":"MongoDB pipeline to Oracle SQL translation validation","tests":[{"id":"CMP001","name":"Equality match - string","description":"Tests $eq operator with string field","category":"comparison","categoryName":"Comparison Operators","operator":"$eq","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"status":"completed"}},{"$project":{"_id":1,"orderId":1,"status":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"status\": \"completed\"\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"status\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, base.data.status AS status FROM sales base WHERE base.data.status = 'completed'","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n       base.data.status AS status\nFROM sales base\nWHERE base.data.status = 'completed'","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"CMP002","name":"Greater than - numeric","description":"Tests $gt operator with numeric field","category":"comparison","categoryName":"Comparison Operators","operator":"$gt","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"amount":{"$gt":200}}},{"$project":{"_id":1,"amount":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"amount\": {\n        \"$gt\": 200\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"amount\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.amount AS amount FROM sales base WHERE CAST(base.data.amount AS NUMBER) > 200","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.amount AS amount\nFROM sales base\nWHERE CAST(base.data.amount AS NUMBER) > 200","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"CMP003","name":"Greater than or equal - numeric","description":"Tests $gte operator with numeric field","category":"comparison","categoryName":"Comparison Operators","operator":"$gte","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"salary":{"$gte":90000}}},{"$project":{"_id":1,"name":1,"salary":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"salary\": {\n        \"$gte\": 90000\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"salary\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, base.data.salary AS salary FROM employees base WHERE CAST(base.data.salary AS NUMBER) >= 90000","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       base.data.salary AS salary\nFROM employees base\nWHERE CAST(base.data.salary AS NUMBER) >= 90000","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":3,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"CMP004","name":"Less than - numeric","description":"Tests $lt operator with numeric field","category":"comparison","categoryName":"Comparison Operators","operator":"$lt","collection":"products","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"price":{"$lt":50}}},{"$project":{"_id":1,"name":1,"price":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"price\": {\n        \"$lt\": 50\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"price\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, base.data.price AS price FROM products base WHERE CAST(base.data.price AS NUMBER) < 50","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       base.data.price AS price\nFROM products base\nWHERE CAST(base.data.price AS NUMBER) < 50","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":4,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"CMP005","name":"Less than or equal - numeric","description":"Tests $lte operator with numeric field","category":"comparison","categoryName":"Comparison Operators","operator":"$lte","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"yearsOfService":{"$lte":2}}},{"$project":{"_id":1,"name":1,"yearsOfService":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"yearsOfService\": {\n        \"$lte\": 2\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"yearsOfService\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, base.data.yearsOfService AS yearsOfService FROM employees base WHERE CAST(base.data.yearsOfService AS NUMBER) <= 2","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       base.data.yearsOfService AS yearsOfService\nFROM employees base\nWHERE CAST(base.data.yearsOfService AS NUMBER) <= 2","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":4,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"CMP006","name":"Not equal - string","description":"Tests $ne operator with string field","category":"comparison","categoryName":"Comparison Operators","operator":"$ne","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"status":{"$ne":"completed"}}},{"$project":{"_id":1,"status":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"status\": {\n        \"$ne\": \"completed\"\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"status\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.status AS status FROM sales base WHERE base.data.status <> 'completed'","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.status AS status\nFROM sales base\nWHERE base.data.status <> 'completed'","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"CMP007","name":"In array - string values","description":"Tests $in operator with array of strings","category":"comparison","categoryName":"Comparison Operators","operator":"$in","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"status":{"$in":["completed","pending"]}}},{"$project":{"_id":1,"status":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"status\": {\n        \"$in\": [\n          \"completed\",\n          \"pending\"\n        ]\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"status\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.status AS status FROM sales base WHERE base.data.status IN ('completed', 'pending')","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.status AS status\nFROM sales base\nWHERE base.data.status IN ('completed',\n                           'pending')","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":7,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"CMP008","name":"Not in array - string values","description":"Tests $nin operator with array of strings","category":"comparison","categoryName":"Comparison Operators","operator":"$nin","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"region":{"$nin":["north","south"]}}},{"$project":{"_id":1,"region":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"region\": {\n        \"$nin\": [\n          \"north\",\n          \"south\"\n        ]\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"region\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.region AS region FROM sales base WHERE base.data.region NOT IN ('north', 'south')","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.region AS region\nFROM sales base\nWHERE base.data.region NOT IN ('north',\n                               'south')","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":4,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"LOG001","name":"Logical AND - two conditions","description":"Tests $and operator with two conditions","category":"logical","categoryName":"Logical Operators","operator":"$and","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"$and":[{"status":"completed"},{"category":"electronics"}]}},{"$project":{"_id":1,"status":1,"category":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"$and\": [\n        {\n          \"status\": \"completed\"\n        },\n        {\n          \"category\": \"electronics\"\n        }\n      ]\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"status\": 1,\n      \"category\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.status AS status, base.data.category AS category FROM sales base WHERE (base.data.status = 'completed') AND (base.data.category = 'electronics')","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.status AS status,\n       base.data.category AS category\nFROM sales base\nWHERE (base.data.status = 'completed')\n  AND (base.data.category = 'electronics')","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":3,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"LOG002","name":"Logical AND - three conditions","description":"Tests $and operator with three conditions","category":"logical","categoryName":"Logical Operators","operator":"$and","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"$and":[{"department":"Engineering"},{"active":true},{"salary":{"$gte":90000}}]}},{"$project":{"_id":1,"name":1,"department":1,"salary":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"$and\": [\n        {\n          \"department\": \"Engineering\"\n        },\n        {\n          \"active\": true\n        },\n        {\n          \"salary\": {\n            \"$gte\": 90000\n          }\n        }\n      ]\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"department\": 1,\n      \"salary\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, base.data.department AS department, base.data.salary AS salary FROM employees base WHERE (base.data.department = 'Engineering') AND (base.data.active = true) AND (CAST(base.data.salary AS NUMBER) >= 90000)","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       base.data.department AS department,\n       base.data.salary AS salary\nFROM employees base\nWHERE (base.data.department = 'Engineering')\n  AND (base.data.active = TRUE)\n  AND (CAST(base.data.salary AS NUMBER) >= 90000)","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":3,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"LOG003","name":"Logical OR - two conditions","description":"Tests $or operator with two conditions","category":"logical","categoryName":"Logical Operators","operator":"$or","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"$or":[{"status":"cancelled"},{"status":"refunded"}]}},{"$project":{"_id":1,"status":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"$or\": [\n        {\n          \"status\": \"cancelled\"\n        },\n        {\n          \"status\": \"refunded\"\n        }\n      ]\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"status\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.status AS status FROM sales base WHERE (base.data.status = 'cancelled') OR (base.data.status = 'refunded')","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.status AS status\nFROM sales base\nWHERE (base.data.status = 'cancelled')\n  OR (base.data.status = 'refunded')","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":2,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"LOG004","name":"Logical OR with AND","description":"Tests combination of $or and $and operators","category":"logical","categoryName":"Logical Operators","operator":"$or/$and","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"$or":[{"department":"Engineering"},{"$and":[{"department":"Sales"},{"active":true}]}]}},{"$project":{"_id":1,"name":1,"department":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"$or\": [\n        {\n          \"department\": \"Engineering\"\n        },\n        {\n          \"$and\": [\n            {\n              \"department\": \"Sales\"\n            },\n            {\n              \"active\": true\n            }\n          ]\n        }\n      ]\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"department\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, base.data.department AS department FROM employees base WHERE (base.data.department = 'Engineering') OR ((base.data.department = 'Sales') AND (base.data.active = true))","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       base.data.department AS department\nFROM employees base\nWHERE (base.data.department = 'Engineering')\n  OR ((base.data.department = 'Sales')\n      AND (base.data.active = TRUE))","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":6,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"LOG005","name":"Logical NOT","description":"Tests $not operator","category":"logical","categoryName":"Logical Operators","operator":"$not","collection":"products","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"price":{"$not":{"$gt":100}}}},{"$project":{"_id":1,"name":1,"price":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"price\": {\n        \"$not\": {\n          \"$gt\": 100\n        }\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"price\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, base.data.price AS price FROM products base WHERE NOT (CAST(base.data.price AS NUMBER) > 100)","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       base.data.price AS price\nFROM products base\nWHERE NOT (CAST(base.data.price AS NUMBER) > 100)","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"AGG001","name":"Group with count","description":"Tests $group with $sum: 1 for counting","category":"accumulator","categoryName":"Accumulator Operators","operator":"$count","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$group":{"_id":"$status","count":{"$sum":1}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$group\": {\n      \"_id\": \"$status\",\n      \"count\": {\n        \"$sum\": 1\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.status AS \"_id\", SUM(1) AS count FROM sales base GROUP BY base.data.status ORDER BY \"_id\"","sqlFormatted":"SELECT base.data.status AS \"_id\",\n       SUM(1) AS COUNT\nFROM sales base\nGROUP BY base.data.status\nORDER BY \"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"AGG002","name":"Group with sum","description":"Tests $group with $sum on numeric field","category":"accumulator","categoryName":"Accumulator Operators","operator":"$sum","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"status":"completed"}},{"$group":{"_id":"$category","totalAmount":{"$sum":"$amount"}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"status\": \"completed\"\n    }\n  },\n  {\n    \"$group\": {\n      \"_id\": \"$category\",\n      \"totalAmount\": {\n        \"$sum\": \"$amount\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.category AS \"_id\", SUM(base.data.amount) AS totalAmount FROM sales base WHERE base.data.status = 'completed' GROUP BY base.data.category ORDER BY \"_id\"","sqlFormatted":"SELECT base.data.category AS \"_id\",\n       SUM(base.data.amount) AS totalAmount\nFROM sales base\nWHERE base.data.status = 'completed'\nGROUP BY base.data.category\nORDER BY \"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":3,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"AGG003","name":"Group with average","description":"Tests $group with $avg on numeric field","category":"accumulator","categoryName":"Accumulator Operators","operator":"$avg","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$group":{"_id":"$department","avgSalary":{"$avg":"$salary"}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$group\": {\n      \"_id\": \"$department\",\n      \"avgSalary\": {\n        \"$avg\": \"$salary\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.department AS \"_id\", AVG(base.data.salary) AS avgSalary FROM employees base GROUP BY base.data.department ORDER BY \"_id\"","sqlFormatted":"SELECT base.data.department AS \"_id\",\n       AVG(base.data.salary) AS avgSalary\nFROM employees base\nGROUP BY base.data.department\nORDER BY \"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":4,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"AGG004","name":"Group with min","description":"Tests $group with $min on numeric field","category":"accumulator","categoryName":"Accumulator Operators","operator":"$min","collection":"products","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"active":true}},{"$group":{"_id":"$category","minPrice":{"$min":"$price"}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"active\": true\n    }\n  },\n  {\n    \"$group\": {\n      \"_id\": \"$category\",\n      \"minPrice\": {\n        \"$min\": \"$price\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.category AS \"_id\", MIN(base.data.price) AS minPrice FROM products base WHERE base.data.active = true GROUP BY base.data.category ORDER BY \"_id\"","sqlFormatted":"SELECT base.data.category AS \"_id\",\n       MIN(base.data.price) AS minPrice\nFROM products base\nWHERE base.data.active = TRUE\nGROUP BY base.data.category\nORDER BY \"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":3,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"AGG005","name":"Group with max","description":"Tests $group with $max on numeric field","category":"accumulator","categoryName":"Accumulator Operators","operator":"$max","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$group":{"_id":"$department","maxSalary":{"$max":"$salary"}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$group\": {\n      \"_id\": \"$department\",\n      \"maxSalary\": {\n        \"$max\": \"$salary\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.department AS \"_id\", MAX(base.data.salary) AS maxSalary FROM employees base GROUP BY base.data.department ORDER BY \"_id\"","sqlFormatted":"SELECT base.data.department AS \"_id\",\n       MAX(base.data.salary) AS maxSalary\nFROM employees base\nGROUP BY base.data.department\nORDER BY \"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":4,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"AGG006","name":"Group with multiple accumulators","description":"Tests $group with multiple accumulators","category":"accumulator","categoryName":"Accumulator Operators","operator":"$sum/$avg/$min/$max","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$group":{"_id":"$department","count":{"$sum":1},"totalSalary":{"$sum":"$salary"},"avgSalary":{"$avg":"$salary"},"minSalary":{"$min":"$salary"},"maxSalary":{"$max":"$salary"}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$group\": {\n      \"_id\": \"$department\",\n      \"count\": {\n        \"$sum\": 1\n      },\n      \"totalSalary\": {\n        \"$sum\": \"$salary\"\n      },\n      \"avgSalary\": {\n        \"$avg\": \"$salary\"\n      },\n      \"minSalary\": {\n        \"$min\": \"$salary\"\n      },\n      \"maxSalary\": {\n        \"$max\": \"$salary\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.department AS \"_id\", SUM(1) AS count, SUM(base.data.salary) AS totalSalary, AVG(base.data.salary) AS avgSalary, MIN(base.data.salary) AS minSalary, MAX(base.data.salary) AS maxSalary FROM employees base GROUP BY base.data.department ORDER BY \"_id\"","sqlFormatted":"SELECT base.data.department AS \"_id\",\n       SUM(1) AS COUNT,\n       SUM(base.data.salary) AS totalSalary,\n       AVG(base.data.salary) AS avgSalary,\n       MIN(base.data.salary) AS minSalary,\n       MAX(base.data.salary) AS maxSalary\nFROM employees base\nGROUP BY base.data.department\nORDER BY \"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":4,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"STG001","name":"Limit results","description":"Tests $limit stage","category":"stage","categoryName":"Pipeline Stages","operator":"$limit","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$sort":{"orderId":1}},{"$limit":3},{"$project":{"_id":1,"orderId":1}}],"pipelineFormatted":"[\n  {\n    \"$sort\": {\n      \"orderId\": 1\n    }\n  },\n  {\n    \"$limit\": 3\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId FROM sales base ORDER BY base.data.orderId FETCH FIRST 3 ROWS ONLY","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId\nFROM sales base\nORDER BY base.data.orderId FETCH FIRST 3 ROWS ONLY","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":3,"comparisonResult":"","sortBy":"orderId","mongodbResults":null,"oracleResults":null},{"id":"STG002","name":"Skip results","description":"Tests $skip stage","category":"stage","categoryName":"Pipeline Stages","operator":"$skip","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$sort":{"name":1}},{"$skip":5},{"$project":{"_id":1,"name":1}}],"pipelineFormatted":"[\n  {\n    \"$sort\": {\n      \"name\": 1\n    }\n  },\n  {\n    \"$skip\": 5\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name FROM employees base ORDER BY base.data.name OFFSET 5 ROWS","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name\nFROM employees base\nORDER BY base.data.name\nOFFSET 5 ROWS","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"name","mongodbResults":null,"oracleResults":null},{"id":"STG003","name":"Skip and limit combined","description":"Tests $skip and $limit stages combined (pagination)","category":"stage","categoryName":"Pipeline Stages","operator":"$skip/$limit","collection":"products","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$sort":{"price":-1}},{"$skip":2},{"$limit":3},{"$project":{"_id":1,"name":1,"price":1}}],"pipelineFormatted":"[\n  {\n    \"$sort\": {\n      \"price\": -1\n    }\n  },\n  {\n    \"$skip\": 2\n  },\n  {\n    \"$limit\": 3\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"price\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, base.data.price AS price FROM products base ORDER BY base.data.price DESC OFFSET 2 ROWS FETCH FIRST 3 ROWS ONLY","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       base.data.price AS price\nFROM products base\nORDER BY base.data.price DESC\nOFFSET 2 ROWS FETCH FIRST 3 ROWS ONLY","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":3,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"STG004","name":"Sort ascending","description":"Tests $sort stage with ascending order","category":"stage","categoryName":"Pipeline Stages","operator":"$sort","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$sort":{"salary":1}},{"$project":{"_id":1,"name":1,"salary":1}}],"pipelineFormatted":"[\n  {\n    \"$sort\": {\n      \"salary\": 1\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"salary\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, base.data.salary AS salary FROM employees base ORDER BY base.data.salary","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       base.data.salary AS salary\nFROM employees base\nORDER BY base.data.salary","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"STG005","name":"Sort descending","description":"Tests $sort stage with descending order","category":"stage","categoryName":"Pipeline Stages","operator":"$sort","collection":"products","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"active":true}},{"$sort":{"price":-1}},{"$project":{"_id":1,"name":1,"price":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"active\": true\n    }\n  },\n  {\n    \"$sort\": {\n      \"price\": -1\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"price\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, base.data.price AS price FROM products base WHERE base.data.active = true ORDER BY base.data.price DESC","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       base.data.price AS price\nFROM products base\nWHERE base.data.active = TRUE\nORDER BY base.data.price DESC","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":7,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"STG006","name":"Sort with multiple fields","description":"Tests $sort stage with multiple fields","category":"stage","categoryName":"Pipeline Stages","operator":"$sort","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$sort":{"department":1,"salary":-1}},{"$project":{"_id":1,"name":1,"department":1,"salary":1}}],"pipelineFormatted":"[\n  {\n    \"$sort\": {\n      \"department\": 1,\n      \"salary\": -1\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"department\": 1,\n      \"salary\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, base.data.department AS department, base.data.salary AS salary FROM employees base ORDER BY base.data.department, base.data.salary DESC","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       base.data.department AS department,\n       base.data.salary AS salary\nFROM employees base\nORDER BY base.data.department,\n         base.data.salary DESC","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"STG007","name":"Project include fields","description":"Tests $project stage with field inclusion","category":"stage","categoryName":"Pipeline Stages","operator":"$project","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"status":"completed"}},{"$project":{"orderId":1,"amount":1,"tax":1,"_id":0}},{"$sort":{"orderId":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"status\": \"completed\"\n    }\n  },\n  {\n    \"$project\": {\n      \"orderId\": 1,\n      \"amount\": 1,\n      \"tax\": 1,\n      \"_id\": 0\n    }\n  },\n  {\n    \"$sort\": {\n      \"orderId\": 1\n    }\n  }\n]","sql":"SELECT base.data.orderId AS orderId, base.data.amount AS amount, base.data.tax AS tax FROM sales base WHERE base.data.status = 'completed' ORDER BY base.data.orderId","sqlFormatted":"SELECT base.data.orderId AS orderId,\n       base.data.amount AS amount,\n       base.data.tax AS tax\nFROM sales base\nWHERE base.data.status = 'completed'\nORDER BY base.data.orderId","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"orderId","mongodbResults":null,"oracleResults":null},{"id":"ARITH001","name":"Addition in project","description":"Tests $add operator in projection","category":"arithmetic","categoryName":"Arithmetic Operators","operator":"$add","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"status":"completed"}},{"$project":{"_id":1,"orderId":1,"total":{"$add":["$amount","$tax"]}}},{"$sort":{"orderId":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"status\": \"completed\"\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"total\": {\n        \"$add\": [\n          \"$amount\",\n          \"$tax\"\n        ]\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"orderId\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, (base.data.amount + base.data.tax) AS total FROM sales base WHERE base.data.status = 'completed' ORDER BY base.data.orderId","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n       (base.data.amount + base.data.tax) AS total\nFROM sales base\nWHERE base.data.status = 'completed'\nORDER BY base.data.orderId","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"orderId","mongodbResults":null,"oracleResults":null},{"id":"ARITH002","name":"Subtraction in project","description":"Tests $subtract operator in projection","category":"arithmetic","categoryName":"Arithmetic Operators","operator":"$subtract","collection":"products","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"active":true}},{"$project":{"_id":1,"name":1,"profit":{"$subtract":["$price","$cost"]}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"active\": true\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"profit\": {\n        \"$subtract\": [\n          \"$price\",\n          \"$cost\"\n        ]\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, (base.data.price - base.data.cost) AS profit FROM products base WHERE base.data.active = true ORDER BY base.data.\"_id\"","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       (base.data.price - base.data.cost) AS profit\nFROM products base\nWHERE base.data.active = TRUE\nORDER BY base.data.\"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":7,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"ARITH003","name":"Multiplication in project","description":"Tests $multiply operator in projection","category":"arithmetic","categoryName":"Arithmetic Operators","operator":"$multiply","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"name":1,"totalComp":{"$add":["$salary",{"$multiply":["$bonus",1]}]}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"totalComp\": {\n        \"$add\": [\n          \"$salary\",\n          {\n            \"$multiply\": [\n              \"$bonus\",\n              1\n            ]\n          }\n        ]\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, (base.data.salary + (base.data.bonus * 1)) AS totalComp FROM employees base ORDER BY base.data.\"_id\"","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       (base.data.salary + (base.data.bonus * 1)) AS totalComp\nFROM employees base\nORDER BY base.data.\"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"ARITH004","name":"Division in project","description":"Tests $divide operator in projection","category":"arithmetic","categoryName":"Arithmetic Operators","operator":"$divide","collection":"products","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"cost":{"$gt":0}}},{"$project":{"_id":1,"name":1,"margin":{"$divide":[{"$subtract":["$price","$cost"]},"$cost"]}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"cost\": {\n        \"$gt\": 0\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"margin\": {\n        \"$divide\": [\n          {\n            \"$subtract\": [\n              \"$price\",\n              \"$cost\"\n            ]\n          },\n          \"$cost\"\n        ]\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, ((base.data.price - base.data.cost) / base.data.cost) AS margin FROM products base WHERE CAST(base.data.cost AS NUMBER) > 0 ORDER BY base.data.\"_id\"","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       ((base.data.price - base.data.cost) / base.data.cost) AS margin\nFROM products base\nWHERE CAST(base.data.cost AS NUMBER) > 0\nORDER BY base.data.\"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":8,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"ARITH005","name":"Modulo in project","description":"Tests $mod operator in projection","category":"arithmetic","categoryName":"Arithmetic Operators","operator":"$mod","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"orderId":1,"orderIdMod3":{"$mod":["$orderId",3]}}},{"$sort":{"orderId":1}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"orderIdMod3\": {\n        \"$mod\": [\n          \"$orderId\",\n          3\n        ]\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"orderId\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, MOD(base.data.orderId, 3) AS orderIdMod3 FROM sales base ORDER BY base.data.orderId","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n       MOD(base.data.orderId, 3) AS orderIdMod3\nFROM sales base\nORDER BY base.data.orderId","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":"orderId","mongodbResults":null,"oracleResults":null},{"id":"COND001","name":"Conditional with $cond","description":"Tests $cond operator for conditional logic","category":"conditional","categoryName":"Conditional Operators","operator":"$cond","collection":"products","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"name":1,"priceCategory":{"$cond":{"if":{"$gte":["$price",100]},"then":"expensive","else":"affordable"}}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"priceCategory\": {\n        \"$cond\": {\n          \"if\": {\n            \"$gte\": [\n              \"$price\",\n              100\n            ]\n          },\n          \"then\": \"expensive\",\n          \"else\": \"affordable\"\n        }\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, CASE WHEN base.data.price >= 100 THEN 'expensive' ELSE 'affordable' END AS priceCategory FROM products base ORDER BY base.data.\"_id\"","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       CASE\n           WHEN base.data.price >= 100 THEN 'expensive'\n           ELSE 'affordable'\n       END AS priceCategory\nFROM products base\nORDER BY base.data.\"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":8,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"COND002","name":"IfNull handling","description":"Tests $ifNull operator for null handling","category":"conditional","categoryName":"Conditional Operators","operator":"$ifNull","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"orderId":1,"discountApplied":{"$ifNull":["$discount",0]}}},{"$sort":{"orderId":1}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"discountApplied\": {\n        \"$ifNull\": [\n          \"$discount\",\n          0\n        ]\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"orderId\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, NVL(CAST(base.data.discount AS NUMBER), 0) AS discountApplied FROM sales base ORDER BY base.data.orderId","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n       NVL(CAST(base.data.discount AS NUMBER), 0) AS discountApplied\nFROM sales base\nORDER BY base.data.orderId","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":"orderId","mongodbResults":null,"oracleResults":null},{"id":"COMPLEX001","name":"Complex pipeline - match, group, sort","description":"Tests complex pipeline with multiple stages","category":"complex","categoryName":"Complex Pipelines","operator":"multiple","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"status":{"$in":["completed","processing"]}}},{"$group":{"_id":"$region","totalSales":{"$sum":"$amount"},"orderCount":{"$sum":1}}},{"$sort":{"totalSales":-1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"status\": {\n        \"$in\": [\n          \"completed\",\n          \"processing\"\n        ]\n      }\n    }\n  },\n  {\n    \"$group\": {\n      \"_id\": \"$region\",\n      \"totalSales\": {\n        \"$sum\": \"$amount\"\n      },\n      \"orderCount\": {\n        \"$sum\": 1\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"totalSales\": -1\n    }\n  }\n]","sql":"SELECT base.data.region AS \"_id\", SUM(base.data.amount) AS totalSales, SUM(1) AS orderCount FROM sales base WHERE base.data.status IN ('completed', 'processing') GROUP BY base.data.region ORDER BY totalSales DESC","sqlFormatted":"SELECT base.data.region AS \"_id\",\n       SUM(base.data.amount) AS totalSales,\n       SUM(1) AS orderCount\nFROM sales base\nWHERE base.data.status IN ('completed',\n                           'processing')\nGROUP BY base.data.region\nORDER BY totalSales DESC","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":4,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"COMPLEX002","name":"Complex pipeline - filter, project, sort, limit","description":"Tests complex pipeline with filter, projection, sort, and limit","category":"complex","categoryName":"Complex Pipelines","operator":"multiple","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"active":true}},{"$project":{"_id":1,"name":1,"department":1,"totalComp":{"$add":["$salary","$bonus"]}}},{"$sort":{"totalComp":-1}},{"$limit":5}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"active\": true\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"department\": 1,\n      \"totalComp\": {\n        \"$add\": [\n          \"$salary\",\n          \"$bonus\"\n        ]\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"totalComp\": -1\n    }\n  },\n  {\n    \"$limit\": 5\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, base.data.department AS department, (base.data.salary + base.data.bonus) AS totalComp FROM employees base WHERE base.data.active = true ORDER BY base.data.totalComp DESC FETCH FIRST 5 ROWS ONLY","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       base.data.department AS department,\n       (base.data.salary + base.data.bonus) AS totalComp\nFROM employees base\nWHERE base.data.active = TRUE\nORDER BY base.data.totalComp DESC FETCH FIRST 5 ROWS ONLY","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"COMPLEX003","name":"Complex pipeline - nested AND/OR","description":"Tests complex pipeline with nested logical operators","category":"complex","categoryName":"Complex Pipelines","operator":"multiple","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"$and":[{"$or":[{"category":"electronics"},{"category":"jewelry"}]},{"amount":{"$gte":100}}]}},{"$project":{"_id":1,"orderId":1,"category":1,"amount":1}},{"$sort":{"amount":-1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"$and\": [\n        {\n          \"$or\": [\n            {\n              \"category\": \"electronics\"\n            },\n            {\n              \"category\": \"jewelry\"\n            }\n          ]\n        },\n        {\n          \"amount\": {\n            \"$gte\": 100\n          }\n        }\n      ]\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"category\": 1,\n      \"amount\": 1\n    }\n  },\n  {\n    \"$sort\": {\n      \"amount\": -1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, base.data.category AS category, base.data.amount AS amount FROM sales base WHERE ((base.data.category = 'electronics') OR (base.data.category = 'jewelry')) AND (CAST(base.data.amount AS NUMBER) >= 100) ORDER BY base.data.amount DESC","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n       base.data.category AS category,\n       base.data.amount AS amount\nFROM sales base\nWHERE ((base.data.category = 'electronics')\n       OR (base.data.category = 'jewelry'))\n  AND (CAST(base.data.amount AS NUMBER) >= 100)\nORDER BY base.data.amount DESC","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"EDGE001","name":"Zero values in aggregation","description":"Tests aggregation with zero values","category":"edge","categoryName":"Edge Cases","operator":"$sum","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"quantity":0}},{"$group":{"_id":null,"totalAmount":{"$sum":"$amount"}}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"quantity\": 0\n    }\n  },\n  {\n    \"$group\": {\n      \"_id\": null,\n      \"totalAmount\": {\n        \"$sum\": \"$amount\"\n      }\n    }\n  }\n]","sql":"SELECT SUM(base.data.amount) AS totalAmount FROM sales base WHERE CAST(base.data.quantity AS NUMBER) = 0","sqlFormatted":"SELECT SUM(base.data.amount) AS totalAmount\nFROM sales base\nWHERE CAST(base.data.quantity AS NUMBER) = 0","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":1,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"EDGE002","name":"Negative values in aggregation","description":"Tests aggregation with negative values","category":"edge","categoryName":"Edge Cases","operator":"$sum","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"amount":{"$lt":0}}},{"$group":{"_id":null,"totalRefunds":{"$sum":"$amount"}}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"amount\": {\n        \"$lt\": 0\n      }\n    }\n  },\n  {\n    \"$group\": {\n      \"_id\": null,\n      \"totalRefunds\": {\n        \"$sum\": \"$amount\"\n      }\n    }\n  }\n]","sql":"SELECT SUM(base.data.amount) AS totalRefunds FROM sales base WHERE CAST(base.data.amount AS NUMBER) < 0","sqlFormatted":"SELECT SUM(base.data.amount) AS totalRefunds\nFROM sales base\nWHERE CAST(base.data.amount AS NUMBER) < 0","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":1,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"EDGE003","name":"Empty result set","description":"Tests query that returns no results","category":"edge","categoryName":"Edge Cases","operator":"$match","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"status":"nonexistent_status"}},{"$project":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"status\": \"nonexistent_status\"\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\" FROM sales base WHERE base.data.status = 'nonexistent_status'","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\"\nFROM sales base\nWHERE base.data.status = 'nonexistent_status'","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":0,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"STR001","name":"String concatenation","description":"Tests $concat operator to join strings","category":"string","categoryName":"String Operators","operator":"$concat","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"fullInfo":{"$concat":["$name"," - ","$department"]}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"fullInfo\": {\n        \"$concat\": [\n          \"$name\",\n          \" - \",\n          \"$department\"\n        ]\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", (base.data.name || ' - ' || base.data.department) AS fullInfo FROM employees base ORDER BY base.data.\"_id\"","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       (base.data.name || ' - ' || base.data.department) AS fullInfo\nFROM employees base\nORDER BY base.data.\"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"STR002","name":"String to lowercase","description":"Tests $toLower operator","category":"string","categoryName":"String Operators","operator":"$toLower","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"deptLower":{"$toLower":"$department"}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"deptLower\": {\n        \"$toLower\": \"$department\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", LOWER(base.data.department) AS deptLower FROM employees base ORDER BY base.data.\"_id\"","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       LOWER(base.data.department) AS deptLower\nFROM employees base\nORDER BY base.data.\"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"STR003","name":"String to uppercase","description":"Tests $toUpper operator","category":"string","categoryName":"String Operators","operator":"$toUpper","collection":"products","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"nameUpper":{"$toUpper":"$name"}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"nameUpper\": {\n        \"$toUpper\": \"$name\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", UPPER(base.data.name) AS nameUpper FROM products base ORDER BY base.data.\"_id\"","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       UPPER(base.data.name) AS nameUpper\nFROM products base\nORDER BY base.data.\"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":8,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"STR004","name":"Substring extraction","description":"Tests $substr operator to extract part of string","category":"string","categoryName":"String Operators","operator":"$substr","collection":"customers","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"namePrefix":{"$substr":["$name",0,4]}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"namePrefix\": {\n        \"$substr\": [\n          \"$name\",\n          0,\n          4\n        ]\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", SUBSTR(base.data.name, 1, 4) AS namePrefix FROM customers base ORDER BY base.data.\"_id\"","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       SUBSTR(base.data.name, 1, 4) AS namePrefix\nFROM customers base\nORDER BY base.data.\"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":7,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"STR005","name":"String length","description":"Tests $strLenCP operator to get string length","category":"string","categoryName":"String Operators","operator":"$strLenCP","collection":"products","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"name":1,"nameLength":{"$strLenCP":"$name"}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"nameLength\": {\n        \"$strLenCP\": \"$name\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, LENGTH(base.data.name) AS nameLength FROM products base ORDER BY base.data.\"_id\"","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       LENGTH(base.data.name) AS nameLength\nFROM products base\nORDER BY base.data.\"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":8,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"STR006","name":"String trim","description":"Tests $trim operator (using existing data)","category":"string","categoryName":"String Operators","operator":"$trim","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"trimmedName":{"$trim":{"input":"$name"}}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"trimmedName\": {\n        \"$trim\": {\n          \"input\": \"$name\"\n        }\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", TRIM(base.data.name) AS trimmedName FROM employees base ORDER BY base.data.\"_id\"","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       TRIM(base.data.name) AS trimmedName\nFROM employees base\nORDER BY base.data.\"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"DATE001","name":"Extract year from date","description":"Tests $year operator to extract year component","category":"date","categoryName":"Date Operators","operator":"$year","collection":"events","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"title":1,"eventYear":{"$year":"$eventDate"}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"title\": 1,\n      \"eventYear\": {\n        \"$year\": \"$eventDate\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.title AS title, EXTRACT(YEAR FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.eventDate'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"')) AS eventYear FROM events base ORDER BY base.data.\"_id\"","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.title AS title,\n       EXTRACT(YEAR\n               FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.eventDate'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"')) AS eventYear\nFROM EVENTS base\nORDER BY base.data.\"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":8,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"DATE002","name":"Extract month from date","description":"Tests $month operator to extract month component","category":"date","categoryName":"Date Operators","operator":"$month","collection":"events","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"title":1,"eventMonth":{"$month":"$eventDate"}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"title\": 1,\n      \"eventMonth\": {\n        \"$month\": \"$eventDate\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.title AS title, EXTRACT(MONTH FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.eventDate'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"')) AS eventMonth FROM events base ORDER BY base.data.\"_id\"","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.title AS title,\n       EXTRACT(MONTH\n               FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.eventDate'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"')) AS eventMonth\nFROM EVENTS base\nORDER BY base.data.\"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":8,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"DATE003","name":"Extract day from date","description":"Tests $dayOfMonth operator to extract day component","category":"date","categoryName":"Date Operators","operator":"$dayOfMonth","collection":"events","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"title":1,"eventDay":{"$dayOfMonth":"$eventDate"}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"title\": 1,\n      \"eventDay\": {\n        \"$dayOfMonth\": \"$eventDate\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.title AS title, EXTRACT(DAY FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.eventDate'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"')) AS eventDay FROM events base ORDER BY base.data.\"_id\"","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.title AS title,\n       EXTRACT(DAY\n               FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.eventDate'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"')) AS eventDay\nFROM EVENTS base\nORDER BY base.data.\"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":8,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"DATE004","name":"Extract hour from date","description":"Tests $hour operator to extract hour component","category":"date","categoryName":"Date Operators","operator":"$hour","collection":"events","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"title":1,"eventHour":{"$hour":"$eventDate"}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"title\": 1,\n      \"eventHour\": {\n        \"$hour\": \"$eventDate\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.title AS title, EXTRACT(HOUR FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.eventDate'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"')) AS eventHour FROM events base ORDER BY base.data.\"_id\"","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.title AS title,\n       EXTRACT(HOUR\n               FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.eventDate'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"')) AS eventHour\nFROM EVENTS base\nORDER BY base.data.\"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":8,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"DATE005","name":"Group events by month","description":"Tests $month with $group for monthly aggregation","category":"date","categoryName":"Date Operators","operator":"$month/$group","collection":"events","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$group":{"_id":{"$month":"$eventDate"},"eventCount":{"$sum":1}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$group\": {\n      \"_id\": {\n        \"$month\": \"$eventDate\"\n      },\n      \"eventCount\": {\n        \"$sum\": 1\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT EXTRACT(MONTH FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.eventDate'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"')) AS \"_id\", SUM(1) AS eventCount FROM events base GROUP BY EXTRACT(MONTH FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.eventDate'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"')) ORDER BY \"_id\"","sqlFormatted":"SELECT EXTRACT(MONTH\n               FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.eventDate'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"')) AS \"_id\",\n       SUM(1) AS eventCount\nFROM EVENTS base\nGROUP BY EXTRACT(MONTH\n                 FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.eventDate'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"'))\nORDER BY \"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":8,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"ARR001","name":"Get first array element","description":"Tests $arrayElemAt to get first element","category":"array","categoryName":"Array Operators","operator":"$arrayElemAt","collection":"products","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"tags":{"$ne":[]}}},{"$project":{"_id":1,"name":1,"firstTag":{"$arrayElemAt":["$tags",0]}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"tags\": {\n        \"$ne\": []\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"firstTag\": {\n        \"$arrayElemAt\": [\n          \"$tags\",\n          0\n        ]\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, JSON_QUERY(base.data, '$.tags[0]') AS firstTag FROM products base WHERE JSON_VALUE(base.data, '$.tags.size()') > 0 ORDER BY base.data.\"_id\"","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       JSON_QUERY(base.data, '$.tags[0]') AS firstTag\nFROM products base\nWHERE JSON_VALUE(base.data, '$.tags.size()') > 0\nORDER BY base.data.\"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":7,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"ARR002","name":"Get array size","description":"Tests $size operator to get array length","category":"array","categoryName":"Array Operators","operator":"$size","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"orderId":1,"itemCount":{"$size":"$items"}}},{"$sort":{"orderId":1}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"itemCount\": {\n        \"$size\": \"$items\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"orderId\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, JSON_VALUE(base.data, '$.items.size()' RETURNING NUMBER) AS itemCount FROM sales base ORDER BY base.data.orderId","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n       JSON_VALUE(base.data, '$.items.size()' RETURNING NUMBER) AS itemCount\nFROM sales base\nORDER BY base.data.orderId","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":"orderId","mongodbResults":null,"oracleResults":null},{"id":"ARR003","name":"Array first element with $first","description":"Tests $first operator as array accessor","category":"array","categoryName":"Array Operators","operator":"$first","collection":"products","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"tags":{"$ne":[]}}},{"$project":{"_id":1,"name":1,"firstTag":{"$first":"$tags"}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"tags\": {\n        \"$ne\": []\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"firstTag\": {\n        \"$first\": \"$tags\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, JSON_QUERY(base.data, '$.tags[0]') AS firstTag FROM products base WHERE JSON_VALUE(base.data, '$.tags.size()') > 0 ORDER BY base.data.\"_id\"","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       JSON_QUERY(base.data, '$.tags[0]') AS firstTag\nFROM products base\nWHERE JSON_VALUE(base.data, '$.tags.size()') > 0\nORDER BY base.data.\"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":7,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"ARR004","name":"Array last element with $last","description":"Tests $last operator as array accessor","category":"array","categoryName":"Array Operators","operator":"$last","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"tags":{"$ne":[]}}},{"$project":{"_id":1,"orderId":1,"lastTag":{"$last":"$tags"}}},{"$sort":{"orderId":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"tags\": {\n        \"$ne\": []\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"lastTag\": {\n        \"$last\": \"$tags\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"orderId\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, JSON_QUERY(base.data, '$.tags[last]') AS lastTag FROM sales base WHERE JSON_VALUE(base.data, '$.tags.size()') > 0 ORDER BY base.data.orderId","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n       JSON_QUERY(base.data, '$.tags[last]') AS lastTag\nFROM sales base\nWHERE JSON_VALUE(base.data, '$.tags.size()') > 0\nORDER BY base.data.orderId","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":8,"comparisonResult":"","sortBy":"orderId","mongodbResults":null,"oracleResults":null},{"id":"LOOKUP001","name":"Basic $lookup join","description":"Tests $lookup stage for basic left outer join","category":"lookup","categoryName":"Lookup Operations","operator":"$lookup","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"status":"completed"}},{"$lookup":{"from":"customers","localField":"customerId","foreignField":"_id","as":"customerInfo"}},{"$project":{"_id":1,"orderId":1,"customerTier":{"$arrayElemAt":["$customerInfo.tier",0]}}},{"$sort":{"orderId":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"status\": \"completed\"\n    }\n  },\n  {\n    \"$lookup\": {\n      \"from\": \"customers\",\n      \"localField\": \"customerId\",\n      \"foreignField\": \"_id\",\n      \"as\": \"customerInfo\"\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"customerTier\": {\n        \"$arrayElemAt\": [\n          \"$customerInfo.tier\",\n          0\n        ]\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"orderId\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, JSON_QUERY(base.data, '$.customerInfo.tier[0]') AS customerTier FROM sales base LEFT OUTER JOIN customers customers_1 ON JSON_VALUE(base.data, '$.customerId') = JSON_VALUE(customers_1.data, '$._id') WHERE base.data.status = 'completed' ORDER BY base.data.orderId","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n       JSON_QUERY(base.data, '$.customerInfo.tier[0]') AS customerTier\nFROM sales base\nLEFT OUTER JOIN customers customers_1 ON JSON_VALUE(base.data, '$.customerId') = JSON_VALUE(customers_1.data, '$._id')\nWHERE base.data.status = 'completed'\nORDER BY base.data.orderId","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"orderId","mongodbResults":null,"oracleResults":null},{"id":"LOOKUP002","name":"$lookup with inventory","description":"Tests $lookup stage joining products with inventory","category":"lookup","categoryName":"Lookup Operations","operator":"$lookup","collection":"products","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"active":true}},{"$lookup":{"from":"inventory","localField":"_id","foreignField":"productId","as":"inventoryRecords"}},{"$project":{"_id":1,"name":1,"warehouseCount":{"$size":"$inventoryRecords"}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"active\": true\n    }\n  },\n  {\n    \"$lookup\": {\n      \"from\": \"inventory\",\n      \"localField\": \"_id\",\n      \"foreignField\": \"productId\",\n      \"as\": \"inventoryRecords\"\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"warehouseCount\": {\n        \"$size\": \"$inventoryRecords\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, (SELECT COUNT(*) FROM inventory sz_inv WHERE sz_inv.data.\"productId\" = base.data.\"_id\") AS warehouseCount FROM products base WHERE base.data.active = true ORDER BY base.data.\"_id\"","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n\n  (SELECT COUNT(*)\n   FROM inventory sz_inv\n   WHERE sz_inv.data.\"productId\" = base.data.\"_id\") AS warehouseCount\nFROM products base\nWHERE base.data.active = TRUE\nORDER BY base.data.\"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":7,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"UNWIND001","name":"Basic $unwind array","description":"Tests $unwind stage to flatten array","category":"unwind","categoryName":"Unwind Operations","operator":"$unwind","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"orderId":1001}},{"$unwind":"$items"},{"$project":{"_id":1,"orderId":1,"product":"$items.product","qty":"$items.qty"}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"orderId\": 1001\n    }\n  },\n  {\n    \"$unwind\": \"$items\"\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"product\": \"$items.product\",\n      \"qty\": \"$items.qty\"\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, unwind_1.value.product AS product, unwind_1.value.qty AS qty FROM sales base, JSON_TABLE(base.data, '$.items[*]' COLUMNS (value JSON PATH '$')) unwind_1 WHERE CAST(base.data.orderId AS NUMBER) = 1001","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n       unwind_1.value.product AS product,\n       unwind_1.value.qty AS qty\nFROM sales base,\n     JSON_TABLE(base.data, '$.items[*]' COLUMNS (value JSON PATH '$')) unwind_1\nWHERE CAST(base.data.orderId AS NUMBER) = 1001","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":2,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"UNWIND002","name":"$unwind with preserveNullAndEmptyArrays","description":"Tests $unwind with empty array preservation","category":"unwind","categoryName":"Unwind Operations","operator":"$unwind","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"orderId":{"$in":[1001,1007]}}},{"$unwind":{"path":"$tags","preserveNullAndEmptyArrays":true}},{"$project":{"_id":1,"orderId":1,"tag":"$tags"}},{"$sort":{"orderId":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"orderId\": {\n        \"$in\": [\n          1001,\n          1007\n        ]\n      }\n    }\n  },\n  {\n    \"$unwind\": {\n      \"path\": \"$tags\",\n      \"preserveNullAndEmptyArrays\": true\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"tag\": \"$tags\"\n    }\n  },\n  {\n    \"$sort\": {\n      \"orderId\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, unwind_1.value AS tag FROM sales base LEFT OUTER JOIN JSON_TABLE(base.data, '$.tags[*]' COLUMNS (value JSON PATH '$')) unwind_1 ON 1=1 WHERE CAST(base.data.orderId AS NUMBER) IN (1001, 1007) ORDER BY base.data.orderId","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n       unwind_1.value AS tag\nFROM sales base\nLEFT OUTER JOIN JSON_TABLE(base.data, '$.tags[*]' COLUMNS (value JSON PATH '$')) unwind_1 ON 1=1\nWHERE CAST(base.data.orderId AS NUMBER) IN (1001,\n                                            1007)\nORDER BY base.data.orderId","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":3,"comparisonResult":"","sortBy":"orderId","mongodbResults":null,"oracleResults":null},{"id":"ADDFIELDS001","name":"Add computed field","description":"Tests $addFields stage to add computed column","category":"addFields","categoryName":"AddFields/Set Operations","operator":"$addFields","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$addFields":{"totalCompensation":{"$add":["$salary","$bonus"]}}},{"$project":{"_id":1,"name":1,"totalCompensation":1}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$addFields\": {\n      \"totalCompensation\": {\n        \"$add\": [\n          \"$salary\",\n          \"$bonus\"\n        ]\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"totalCompensation\": 1\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, (base.data.salary + base.data.bonus) AS totalCompensation FROM employees base ORDER BY base.data.\"_id\"","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       (base.data.salary + base.data.bonus) AS totalCompensation\nFROM employees base\nORDER BY base.data.\"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"ADDFIELDS002","name":"$set as alias for $addFields","description":"Tests $set stage (alias for $addFields)","category":"addFields","categoryName":"AddFields/Set Operations","operator":"$set","collection":"products","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"active":true}},{"$set":{"profitMargin":{"$subtract":["$price","$cost"]}}},{"$project":{"_id":1,"name":1,"profitMargin":1}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"active\": true\n    }\n  },\n  {\n    \"$set\": {\n      \"profitMargin\": {\n        \"$subtract\": [\n          \"$price\",\n          \"$cost\"\n        ]\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"profitMargin\": 1\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, (base.data.price - base.data.cost) AS profitMargin FROM products base WHERE base.data.active = true ORDER BY base.data.\"_id\"","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       (base.data.price - base.data.cost) AS profitMargin\nFROM products base\nWHERE base.data.active = TRUE\nORDER BY base.data.\"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":7,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"AGG007","name":"Group with $push","description":"Tests $group with $push to collect values into array","category":"accumulator","categoryName":"Accumulator Operators","operator":"$push","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$group":{"_id":"$department","employees":{"$push":"$name"}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$group\": {\n      \"_id\": \"$department\",\n      \"employees\": {\n        \"$push\": \"$name\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.department AS \"_id\", JSON_ARRAYAGG(base.data.name) AS employees FROM employees base GROUP BY base.data.department ORDER BY \"_id\"","sqlFormatted":"SELECT base.data.department AS \"_id\",\n       JSON_ARRAYAGG(base.data.name) AS employees\nFROM employees base\nGROUP BY base.data.department\nORDER BY \"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":4,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"AGG008","name":"Group with $addToSet","description":"Tests $group with $addToSet to collect unique values","category":"accumulator","categoryName":"Accumulator Operators","operator":"$addToSet","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$group":{"_id":"$region","statuses":{"$addToSet":"$status"}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$group\": {\n      \"_id\": \"$region\",\n      \"statuses\": {\n        \"$addToSet\": \"$status\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.region AS \"_id\", JSON_QUERY('[' || LISTAGG(DISTINCT '\"' || base.data.status || '\"', ',') WITHIN GROUP (ORDER BY base.data.status) || ']', '$' RETURNING CLOB) AS statuses FROM sales base GROUP BY base.data.region ORDER BY \"_id\"","sqlFormatted":"SELECT base.data.region AS \"_id\",\n       JSON_QUERY('[' || LISTAGG(DISTINCT '\"' || base.data.status || '\"', ',') WITHIN GROUP (\n                                                                                             ORDER BY base.data.status) || ']', '$' RETURNING CLOB) AS statuses\nFROM sales base\nGROUP BY base.data.region\nORDER BY \"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":4,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"COND003","name":"Nested $cond expressions","description":"Tests nested $cond for multi-branch logic","category":"conditional","categoryName":"Conditional Operators","operator":"$cond","collection":"products","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"name":1,"priceRange":{"$cond":{"if":{"$gte":["$price",200]},"then":"high","else":{"$cond":{"if":{"$gte":["$price",50]},"then":"medium","else":"low"}}}}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"priceRange\": {\n        \"$cond\": {\n          \"if\": {\n            \"$gte\": [\n              \"$price\",\n              200\n            ]\n          },\n          \"then\": \"high\",\n          \"else\": {\n            \"$cond\": {\n              \"if\": {\n                \"$gte\": [\n                  \"$price\",\n                  50\n                ]\n              },\n              \"then\": \"medium\",\n              \"else\": \"low\"\n            }\n          }\n        }\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, CASE WHEN base.data.price >= 200 THEN 'high' ELSE CASE WHEN base.data.price >= 50 THEN 'medium' ELSE 'low' END END AS priceRange FROM products base ORDER BY base.data.\"_id\"","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       CASE\n           WHEN base.data.price >= 200 THEN 'high'\n           ELSE CASE\n                    WHEN base.data.price >= 50 THEN 'medium'\n                    ELSE 'low'\n                END\n       END AS priceRange\nFROM products base\nORDER BY base.data.\"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":8,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"COMPLEX004","name":"Complex pipeline - lookup with group","description":"Tests complex pipeline combining $lookup and $group","category":"complex","categoryName":"Complex Pipelines","operator":"multiple","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"status":"completed"}},{"$lookup":{"from":"customers","localField":"customerId","foreignField":"_id","as":"customer"}},{"$unwind":"$customer"},{"$group":{"_id":"$customer.tier","totalAmount":{"$sum":"$amount"},"orderCount":{"$sum":1}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"status\": \"completed\"\n    }\n  },\n  {\n    \"$lookup\": {\n      \"from\": \"customers\",\n      \"localField\": \"customerId\",\n      \"foreignField\": \"_id\",\n      \"as\": \"customer\"\n    }\n  },\n  {\n    \"$unwind\": \"$customer\"\n  },\n  {\n    \"$group\": {\n      \"_id\": \"$customer.tier\",\n      \"totalAmount\": {\n        \"$sum\": \"$amount\"\n      },\n      \"orderCount\": {\n        \"$sum\": 1\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT customers_1.data.tier AS \"_id\", SUM(base.data.amount) AS totalAmount, SUM(1) AS orderCount FROM sales base LEFT OUTER JOIN customers customers_1 ON JSON_VALUE(base.data, '$.customerId') = JSON_VALUE(customers_1.data, '$._id') WHERE base.data.status = 'completed' GROUP BY customers_1.data.tier ORDER BY \"_id\"","sqlFormatted":"SELECT customers_1.data.tier AS \"_id\",\n       SUM(base.data.amount) AS totalAmount,\n       SUM(1) AS orderCount\nFROM sales base\nLEFT OUTER JOIN customers customers_1 ON JSON_VALUE(base.data, '$.customerId') = JSON_VALUE(customers_1.data, '$._id')\nWHERE base.data.status = 'completed'\nGROUP BY customers_1.data.tier\nORDER BY \"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":3,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"COMPLEX005","name":"Complex pipeline - string operations with grouping","description":"Tests complex pipeline with string operations and grouping","category":"complex","categoryName":"Complex Pipelines","operator":"multiple","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$addFields":{"deptUpper":{"$toUpper":"$department"}}},{"$group":{"_id":"$deptUpper","avgSalary":{"$avg":"$salary"},"headcount":{"$sum":1}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$addFields\": {\n      \"deptUpper\": {\n        \"$toUpper\": \"$department\"\n      }\n    }\n  },\n  {\n    \"$group\": {\n      \"_id\": \"$deptUpper\",\n      \"avgSalary\": {\n        \"$avg\": \"$salary\"\n      },\n      \"headcount\": {\n        \"$sum\": 1\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT UPPER(base.data.department) AS \"_id\", AVG(base.data.salary) AS avgSalary, SUM(1) AS headcount, UPPER(base.data.department) AS deptUpper FROM employees base GROUP BY UPPER(base.data.department) ORDER BY \"_id\"","sqlFormatted":"SELECT UPPER(base.data.department) AS \"_id\",\n       AVG(base.data.salary) AS avgSalary,\n       SUM(1) AS headcount,\n       UPPER(base.data.department) AS deptUpper\nFROM employees base\nGROUP BY UPPER(base.data.department)\nORDER BY \"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":4,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"UNION001","name":"Basic $unionWith - two collections","description":"Tests $unionWith to combine employees and customers (names from both)","category":"unionWith","categoryName":"Union Operations","operator":"$unionWith","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"name":1,"source":{"$literal":"employee"}}},{"$unionWith":{"coll":"customers","pipeline":[{"$project":{"_id":1,"name":1,"source":{"$literal":"customer"}}}]}},{"$sort":{"source":1,"name":1}},{"$limit":10}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"source\": {\n        \"$literal\": \"employee\"\n      }\n    }\n  },\n  {\n    \"$unionWith\": {\n      \"coll\": \"customers\",\n      \"pipeline\": [\n        {\n          \"$project\": {\n            \"_id\": 1,\n            \"name\": 1,\n            \"source\": {\n              \"$literal\": \"customer\"\n            }\n          }\n        }\n      ]\n    }\n  },\n  {\n    \"$sort\": {\n      \"source\": 1,\n      \"name\": 1\n    }\n  },\n  {\n    \"$limit\": 10\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, 'employee' AS source FROM employees base UNION ALL SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, 'customer' AS source FROM customers base ORDER BY source ASC, name ASC FETCH FIRST 10 ROWS ONLY","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       'employee' AS SOURCE\nFROM employees base\nUNION ALL\nSELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       'customer' AS SOURCE\nFROM customers base\nORDER BY SOURCE ASC, name ASC FETCH FIRST 10 ROWS ONLY","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"UNION002","name":"$unionWith with match filter","description":"Tests $unionWith with $match in sub-pipeline","category":"unionWith","categoryName":"Union Operations","operator":"$unionWith","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"status":"completed"}},{"$project":{"_id":1,"amount":1,"category":1}},{"$unionWith":{"coll":"sales","pipeline":[{"$match":{"status":"pending"}},{"$project":{"_id":1,"amount":1,"category":1}}]}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"status\": \"completed\"\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"amount\": 1,\n      \"category\": 1\n    }\n  },\n  {\n    \"$unionWith\": {\n      \"coll\": \"sales\",\n      \"pipeline\": [\n        {\n          \"$match\": {\n            \"status\": \"pending\"\n          }\n        },\n        {\n          \"$project\": {\n            \"_id\": 1,\n            \"amount\": 1,\n            \"category\": 1\n          }\n        }\n      ]\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.amount AS amount, base.data.category AS category FROM sales base WHERE base.data.status = 'completed' UNION ALL SELECT base.data.\"_id\" AS \"_id\", base.data.amount AS amount, base.data.category AS category FROM sales base WHERE base.data.status = 'pending' ORDER BY \"_id\" ASC","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.amount AS amount,\n       base.data.category AS category\nFROM sales base\nWHERE base.data.status = 'completed'\nUNION ALL\nSELECT base.data.\"_id\" AS \"_id\",\n       base.data.amount AS amount,\n       base.data.category AS category\nFROM sales base\nWHERE base.data.status = 'pending'\nORDER BY \"_id\" ASC","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":7,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"UNION003","name":"$unionWith with aggregation","description":"Tests $unionWith followed by group aggregation","category":"unionWith","categoryName":"Union Operations","operator":"$unionWith","collection":"products","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"category":"electronics"}},{"$project":{"_id":1,"price":1}},{"$unionWith":{"coll":"products","pipeline":[{"$match":{"category":"tools"}},{"$project":{"_id":1,"price":1}}]}},{"$group":{"_id":null,"totalProducts":{"$sum":1},"avgPrice":{"$avg":"$price"}}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"category\": \"electronics\"\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"price\": 1\n    }\n  },\n  {\n    \"$unionWith\": {\n      \"coll\": \"products\",\n      \"pipeline\": [\n        {\n          \"$match\": {\n            \"category\": \"tools\"\n          }\n        },\n        {\n          \"$project\": {\n            \"_id\": 1,\n            \"price\": 1\n          }\n        }\n      ]\n    }\n  },\n  {\n    \"$group\": {\n      \"_id\": null,\n      \"totalProducts\": {\n        \"$sum\": 1\n      },\n      \"avgPrice\": {\n        \"$avg\": \"$price\"\n      }\n    }\n  }\n]","sql":"SELECT COUNT(*) AS totalProducts, AVG(price) AS avgPrice FROM (SELECT base.data.\"_id\" AS \"_id\", base.data.price AS price FROM products base WHERE base.data.category = 'electronics' UNION ALL SELECT base.data.\"_id\" AS \"_id\", base.data.price AS price FROM products base WHERE base.data.category = 'tools')","sqlFormatted":"SELECT COUNT(*) AS totalProducts,\n       AVG(price) AS avgPrice\nFROM\n  (SELECT base.data.\"_id\" AS \"_id\",\n          base.data.price AS price\n   FROM products base\n   WHERE base.data.category = 'electronics'\n   UNION ALL SELECT base.data.\"_id\" AS \"_id\",\n                    base.data.price AS price\n   FROM products base\n   WHERE base.data.category = 'tools')","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":1,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"BUCKET001","name":"Basic $bucket - price ranges","description":"Tests $bucket to group products by price ranges (no default needed - all values covered)","category":"bucket","categoryName":"Bucket Operations","operator":"$bucket","collection":"products","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$bucket":{"groupBy":"$price","boundaries":[0,25,100,1000],"output":{"count":{"$sum":1},"products":{"$push":"$name"}}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$bucket\": {\n      \"groupBy\": \"$price\",\n      \"boundaries\": [\n        0,\n        25,\n        100,\n        1000\n      ],\n      \"output\": {\n        \"count\": {\n          \"$sum\": 1\n        },\n        \"products\": {\n          \"$push\": \"$name\"\n        }\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT CASE WHEN base.data.price >= 0 AND base.data.price < 25 THEN 0 WHEN base.data.price >= 25 AND base.data.price < 100 THEN 25 WHEN base.data.price >= 100 AND base.data.price < 1000 THEN 100 END AS \"_id\", SUM(1) AS count, JSON_ARRAYAGG(base.data.name) AS products FROM products base GROUP BY CASE WHEN base.data.price >= 0 AND base.data.price < 25 THEN 0 WHEN base.data.price >= 25 AND base.data.price < 100 THEN 25 WHEN base.data.price >= 100 AND base.data.price < 1000 THEN 100 END ORDER BY \"_id\"","sqlFormatted":"SELECT CASE\n           WHEN base.data.price >= 0\n                AND base.data.price < 25 THEN 0\n           WHEN base.data.price >= 25\n                AND base.data.price < 100 THEN 25\n           WHEN base.data.price >= 100\n                AND base.data.price < 1000 THEN 100\n       END AS \"_id\",\n       SUM(1) AS COUNT,\n       JSON_ARRAYAGG(base.data.name) AS products\nFROM products base\nGROUP BY CASE\n             WHEN base.data.price >= 0\n                  AND base.data.price < 25 THEN 0\n             WHEN base.data.price >= 25\n                  AND base.data.price < 100 THEN 25\n             WHEN base.data.price >= 100\n                  AND base.data.price < 1000 THEN 100\n         END\nORDER BY \"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":3,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"BUCKET002","name":"$bucket - salary bands","description":"Tests $bucket to group employees by salary bands (all values covered)","category":"bucket","categoryName":"Bucket Operations","operator":"$bucket","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$bucket":{"groupBy":"$salary","boundaries":[60000,75000,90000,110000],"output":{"count":{"$sum":1},"avgBonus":{"$avg":"$bonus"}}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$bucket\": {\n      \"groupBy\": \"$salary\",\n      \"boundaries\": [\n        60000,\n        75000,\n        90000,\n        110000\n      ],\n      \"output\": {\n        \"count\": {\n          \"$sum\": 1\n        },\n        \"avgBonus\": {\n          \"$avg\": \"$bonus\"\n        }\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT CASE WHEN base.data.salary >= 60000 AND base.data.salary < 75000 THEN 60000 WHEN base.data.salary >= 75000 AND base.data.salary < 90000 THEN 75000 WHEN base.data.salary >= 90000 AND base.data.salary < 110000 THEN 90000 END AS \"_id\", SUM(1) AS count, AVG(base.data.bonus) AS avgBonus FROM employees base GROUP BY CASE WHEN base.data.salary >= 60000 AND base.data.salary < 75000 THEN 60000 WHEN base.data.salary >= 75000 AND base.data.salary < 90000 THEN 75000 WHEN base.data.salary >= 90000 AND base.data.salary < 110000 THEN 90000 END ORDER BY \"_id\"","sqlFormatted":"SELECT CASE\n           WHEN base.data.salary >= 60000\n                AND base.data.salary < 75000 THEN 60000\n           WHEN base.data.salary >= 75000\n                AND base.data.salary < 90000 THEN 75000\n           WHEN base.data.salary >= 90000\n                AND base.data.salary < 110000 THEN 90000\n       END AS \"_id\",\n       SUM(1) AS COUNT,\n       AVG(base.data.bonus) AS avgBonus\nFROM employees base\nGROUP BY CASE\n             WHEN base.data.salary >= 60000\n                  AND base.data.salary < 75000 THEN 60000\n             WHEN base.data.salary >= 75000\n                  AND base.data.salary < 90000 THEN 75000\n             WHEN base.data.salary >= 90000\n                  AND base.data.salary < 110000 THEN 90000\n         END\nORDER BY \"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":3,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"BUCKETAUTO001","name":"Basic $bucketAuto - auto price groups","description":"Tests $bucketAuto to automatically group products by price","category":"bucketAuto","categoryName":"BucketAuto Operations","operator":"$bucketAuto","collection":"products","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"active":true}},{"$bucketAuto":{"groupBy":"$price","buckets":3,"output":{"count":{"$sum":1},"avgPrice":{"$avg":"$price"}}}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"active\": true\n    }\n  },\n  {\n    \"$bucketAuto\": {\n      \"groupBy\": \"$price\",\n      \"buckets\": 3,\n      \"output\": {\n        \"count\": {\n          \"$sum\": 1\n        },\n        \"avgPrice\": {\n          \"$avg\": \"$price\"\n        }\n      }\n    }\n  }\n]","sql":"SELECT bucket_id, COUNT(*) AS count, AVG(groupby_value) AS avgPrice FROM (SELECT base.data.price AS groupby_value, NTILE(3) OVER (ORDER BY base.data.price) AS bucket_id FROM products base WHERE base.data.active = true) GROUP BY bucket_id ORDER BY bucket_id","sqlFormatted":"SELECT bucket_id,\n       COUNT(*) AS COUNT,\n       AVG(groupby_value) AS avgPrice\nFROM\n  (SELECT base.data.price AS groupby_value,\n          NTILE(3) OVER (\n                         ORDER BY base.data.price) AS bucket_id\n   FROM products base\n   WHERE base.data.active = TRUE)\nGROUP BY bucket_id\nORDER BY bucket_id","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":3,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"BUCKETAUTO002","name":"$bucketAuto - employee salary distribution","description":"Tests $bucketAuto to distribute employees into salary quartiles","category":"bucketAuto","categoryName":"BucketAuto Operations","operator":"$bucketAuto","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$bucketAuto":{"groupBy":"$salary","buckets":4,"output":{"count":{"$sum":1},"minSalary":{"$min":"$salary"},"maxSalary":{"$max":"$salary"}}}}],"pipelineFormatted":"[\n  {\n    \"$bucketAuto\": {\n      \"groupBy\": \"$salary\",\n      \"buckets\": 4,\n      \"output\": {\n        \"count\": {\n          \"$sum\": 1\n        },\n        \"minSalary\": {\n          \"$min\": \"$salary\"\n        },\n        \"maxSalary\": {\n          \"$max\": \"$salary\"\n        }\n      }\n    }\n  }\n]","sql":"SELECT bucket_id, COUNT(*) AS count, MIN(groupby_value) AS minSalary, MAX(groupby_value) AS maxSalary FROM (SELECT base.data.salary AS groupby_value, NTILE(4) OVER (ORDER BY base.data.salary) AS bucket_id FROM employees base) GROUP BY bucket_id ORDER BY bucket_id","sqlFormatted":"SELECT bucket_id,\n       COUNT(*) AS COUNT,\n       MIN(groupby_value) AS minSalary,\n       MAX(groupby_value) AS maxSalary\nFROM\n  (SELECT base.data.salary AS groupby_value,\n          NTILE(4) OVER (\n                         ORDER BY base.data.salary) AS bucket_id\n   FROM employees base)\nGROUP BY bucket_id\nORDER BY bucket_id","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":4,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"FACET001","name":"Basic $facet - multiple aggregations","description":"Tests $facet for parallel aggregation pipelines","category":"facet","categoryName":"Facet Operations","operator":"$facet","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$facet":{"byStatus":[{"$group":{"_id":"$status","count":{"$sum":1}}},{"$sort":{"_id":1}}],"byRegion":[{"$group":{"_id":"$region","totalAmount":{"$sum":"$amount"}}},{"$sort":{"_id":1}}]}}],"pipelineFormatted":"[\n  {\n    \"$facet\": {\n      \"byStatus\": [\n        {\n          \"$group\": {\n            \"_id\": \"$status\",\n            \"count\": {\n              \"$sum\": 1\n            }\n          }\n        },\n        {\n          \"$sort\": {\n            \"_id\": 1\n          }\n        }\n      ],\n      \"byRegion\": [\n        {\n          \"$group\": {\n            \"_id\": \"$region\",\n            \"totalAmount\": {\n              \"$sum\": \"$amount\"\n            }\n          }\n        },\n        {\n          \"$sort\": {\n            \"_id\": 1\n          }\n        }\n      ]\n    }\n  }\n]","sql":"SELECT JSON_OBJECT('byStatus' VALUE (SELECT JSON_ARRAYAGG(JSON_OBJECT('_id' VALUE \"_id\", 'count' VALUE count) ORDER BY \"_id\") FROM (SELECT base.data.status AS \"_id\", SUM(1) AS count FROM sales base GROUP BY base.data.status)), 'byRegion' VALUE (SELECT JSON_ARRAYAGG(JSON_OBJECT('_id' VALUE \"_id\", 'totalAmount' VALUE totalAmount) ORDER BY \"_id\") FROM (SELECT base.data.region AS \"_id\", SUM(base.data.amount) AS totalAmount FROM sales base GROUP BY base.data.region))) AS data FROM DUAL","sqlFormatted":"SELECT JSON_OBJECT('byStatus' VALUE\n                     (SELECT JSON_ARRAYAGG(JSON_OBJECT('_id' VALUE \"_id\", 'count' VALUE COUNT)\n                                           ORDER BY \"_id\")\n                      FROM\n                        (SELECT base.data.status AS \"_id\", SUM(1) AS COUNT\n                         FROM sales base\n                         GROUP BY base.data.status)), 'byRegion' VALUE\n                     (SELECT JSON_ARRAYAGG(JSON_OBJECT('_id' VALUE \"_id\", 'totalAmount' VALUE totalAmount)\n                                           ORDER BY \"_id\")\n                      FROM\n                        (SELECT base.data.region AS \"_id\", SUM(base.data.amount) AS totalAmount\n                         FROM sales base\n                         GROUP BY base.data.region))) AS DATA\nFROM DUAL","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":1,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"FACET002","name":"$facet - product analysis","description":"Tests $facet for multi-faceted product analysis","category":"facet","categoryName":"Facet Operations","operator":"$facet","collection":"products","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"active":true}},{"$facet":{"categorySummary":[{"$group":{"_id":"$category","count":{"$sum":1},"avgPrice":{"$avg":"$price"}}},{"$sort":{"_id":1}}],"priceStats":[{"$group":{"_id":null,"minPrice":{"$min":"$price"},"maxPrice":{"$max":"$price"},"avgPrice":{"$avg":"$price"}}}]}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"active\": true\n    }\n  },\n  {\n    \"$facet\": {\n      \"categorySummary\": [\n        {\n          \"$group\": {\n            \"_id\": \"$category\",\n            \"count\": {\n              \"$sum\": 1\n            },\n            \"avgPrice\": {\n              \"$avg\": \"$price\"\n            }\n          }\n        },\n        {\n          \"$sort\": {\n            \"_id\": 1\n          }\n        }\n      ],\n      \"priceStats\": [\n        {\n          \"$group\": {\n            \"_id\": null,\n            \"minPrice\": {\n              \"$min\": \"$price\"\n            },\n            \"maxPrice\": {\n              \"$max\": \"$price\"\n            },\n            \"avgPrice\": {\n              \"$avg\": \"$price\"\n            }\n          }\n        }\n      ]\n    }\n  }\n]","sql":"SELECT JSON_OBJECT('categorySummary' VALUE (SELECT JSON_ARRAYAGG(JSON_OBJECT('_id' VALUE \"_id\", 'count' VALUE count, 'avgPrice' VALUE avgPrice) ORDER BY \"_id\") FROM (SELECT base.data.category AS \"_id\", SUM(1) AS count, AVG(base.data.price) AS avgPrice FROM products base WHERE base.data.active = true GROUP BY base.data.category)), 'priceStats' VALUE (SELECT JSON_ARRAYAGG(JSON_OBJECT('_id' VALUE NULL, 'minPrice' VALUE minPrice, 'maxPrice' VALUE maxPrice, 'avgPrice' VALUE avgPrice)) FROM (SELECT MIN(base.data.price) AS minPrice, MAX(base.data.price) AS maxPrice, AVG(base.data.price) AS avgPrice FROM products base WHERE base.data.active = true))) AS data FROM DUAL","sqlFormatted":"SELECT JSON_OBJECT('categorySummary' VALUE\n                     (SELECT JSON_ARRAYAGG(JSON_OBJECT('_id' VALUE \"_id\", 'count' VALUE COUNT, 'avgPrice' VALUE avgPrice)\n                                           ORDER BY \"_id\")\n                      FROM\n                        (SELECT base.data.category AS \"_id\", SUM(1) AS COUNT, AVG(base.data.price) AS avgPrice\n                         FROM products base\n                         WHERE base.data.active = TRUE\n                         GROUP BY base.data.category)), 'priceStats' VALUE\n                     (SELECT JSON_ARRAYAGG(JSON_OBJECT('_id' VALUE NULL, 'minPrice' VALUE minPrice, 'maxPrice' VALUE maxPrice, 'avgPrice' VALUE avgPrice))\n                      FROM\n                        (SELECT MIN(base.data.price) AS minPrice, MAX(base.data.price) AS maxPrice, AVG(base.data.price) AS avgPrice\n                         FROM products base\n                         WHERE base.data.active = TRUE))) AS DATA\nFROM DUAL","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":1,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"FACET003","name":"$facet - employee dashboard","description":"Tests $facet for employee dashboard with multiple views","category":"facet","categoryName":"Facet Operations","operator":"$facet","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$facet":{"departmentCounts":[{"$group":{"_id":"$department","count":{"$sum":1}}},{"$sort":{"count":-1}}],"topEarners":[{"$sort":{"salary":-1}},{"$limit":3},{"$project":{"_id":1,"name":1,"salary":1}}],"totalStats":[{"$group":{"_id":null,"totalEmployees":{"$sum":1},"avgSalary":{"$avg":"$salary"},"totalPayroll":{"$sum":"$salary"}}}]}}],"pipelineFormatted":"[\n  {\n    \"$facet\": {\n      \"departmentCounts\": [\n        {\n          \"$group\": {\n            \"_id\": \"$department\",\n            \"count\": {\n              \"$sum\": 1\n            }\n          }\n        },\n        {\n          \"$sort\": {\n            \"count\": -1\n          }\n        }\n      ],\n      \"topEarners\": [\n        {\n          \"$sort\": {\n            \"salary\": -1\n          }\n        },\n        {\n          \"$limit\": 3\n        },\n        {\n          \"$project\": {\n            \"_id\": 1,\n            \"name\": 1,\n            \"salary\": 1\n          }\n        }\n      ],\n      \"totalStats\": [\n        {\n          \"$group\": {\n            \"_id\": null,\n            \"totalEmployees\": {\n              \"$sum\": 1\n            },\n            \"avgSalary\": {\n              \"$avg\": \"$salary\"\n            },\n            \"totalPayroll\": {\n              \"$sum\": \"$salary\"\n            }\n          }\n        }\n      ]\n    }\n  }\n]","sql":"SELECT JSON_OBJECT('departmentCounts' VALUE (SELECT JSON_ARRAYAGG(JSON_OBJECT('_id' VALUE \"_id\", 'count' VALUE count) ORDER BY count DESC) FROM (SELECT base.data.department AS \"_id\", SUM(1) AS count FROM employees base GROUP BY base.data.department)), 'topEarners' VALUE (SELECT JSON_ARRAYAGG(JSON_OBJECT('_id' VALUE \"_id\", 'name' VALUE name, 'salary' VALUE salary) ORDER BY salary DESC) FROM (SELECT id AS \"_id\", base.data.name AS name, base.data.salary AS salary FROM employees base ORDER BY base.data.salary DESC FETCH FIRST 3 ROWS ONLY)), 'totalStats' VALUE (SELECT JSON_ARRAYAGG(JSON_OBJECT('_id' VALUE NULL, 'totalEmployees' VALUE totalEmployees, 'avgSalary' VALUE avgSalary, 'totalPayroll' VALUE totalPayroll)) FROM (SELECT SUM(1) AS totalEmployees, AVG(base.data.salary) AS avgSalary, SUM(base.data.salary) AS totalPayroll FROM employees base))) AS data FROM DUAL","sqlFormatted":"SELECT JSON_OBJECT('departmentCounts' VALUE\n                     (SELECT JSON_ARRAYAGG(JSON_OBJECT('_id' VALUE \"_id\", 'count' VALUE COUNT)\n                                           ORDER BY COUNT DESC)\n                      FROM\n                        (SELECT base.data.department AS \"_id\", SUM(1) AS COUNT\n                         FROM employees base\n                         GROUP BY base.data.department)), 'topEarners' VALUE\n                     (SELECT JSON_ARRAYAGG(JSON_OBJECT('_id' VALUE \"_id\", 'name' VALUE name, 'salary' VALUE salary)\n                                           ORDER BY salary DESC)\n                      FROM\n                        (SELECT id AS \"_id\", base.data.name AS name, base.data.salary AS salary\n                         FROM employees base\n                         ORDER BY base.data.salary DESC FETCH FIRST 3 ROWS ONLY)), 'totalStats' VALUE\n                     (SELECT JSON_ARRAYAGG(JSON_OBJECT('_id' VALUE NULL, 'totalEmployees' VALUE totalEmployees, 'avgSalary' VALUE avgSalary, 'totalPayroll' VALUE totalPayroll))\n                      FROM\n                        (SELECT SUM(1) AS totalEmployees, AVG(base.data.salary) AS avgSalary, SUM(base.data.salary) AS totalPayroll\n                         FROM employees base))) AS DATA\nFROM DUAL","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":1,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"WINDOW001","name":"$setWindowFields - rank by salary","description":"Tests $setWindowFields with $rank partitioned by department","category":"setWindowFields","categoryName":"Window Functions","operator":"$setWindowFields","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$setWindowFields":{"partitionBy":"$department","sortBy":{"salary":-1},"output":{"salaryRank":{"$rank":{}}}}},{"$match":{"salaryRank":1}},{"$project":{"_id":1,"name":1,"department":1,"salary":1,"salaryRank":1}},{"$sort":{"department":1}}],"pipelineFormatted":"[\n  {\n    \"$setWindowFields\": {\n      \"partitionBy\": \"$department\",\n      \"sortBy\": {\n        \"salary\": -1\n      },\n      \"output\": {\n        \"salaryRank\": {\n          \"$rank\": {}\n        }\n      }\n    }\n  },\n  {\n    \"$match\": {\n      \"salaryRank\": 1\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"department\": 1,\n      \"salary\": 1,\n      \"salaryRank\": 1\n    }\n  },\n  {\n    \"$sort\": {\n      \"department\": 1\n    }\n  }\n]","sql":"SELECT id AS \"_id\", w.data.name AS name, w.data.department AS department, w.data.salary AS salary, salaryRank AS salaryRank FROM (SELECT id, data, RANK() OVER (PARTITION BY base.data.department ORDER BY base.data.salary DESC) AS salaryRank FROM employees base) w WHERE salaryRank = 1 ORDER BY w.data.department","sqlFormatted":"SELECT id AS \"_id\",\n       w.data.name AS name,\n       w.data.department AS department,\n       w.data.salary AS salary,\n       salaryRank AS salaryRank\nFROM\n  (SELECT id,\n          DATA,\n          RANK() OVER (PARTITION BY base.data.department\n                       ORDER BY base.data.salary DESC) AS salaryRank\n   FROM employees base) w\nWHERE salaryRank = 1\nORDER BY w.data.department","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":4,"comparisonResult":"","sortBy":"department","mongodbResults":null,"oracleResults":null},{"id":"WINDOW002","name":"$setWindowFields - cumulative sum","description":"Tests $setWindowFields with cumulative $sum","category":"setWindowFields","categoryName":"Window Functions","operator":"$setWindowFields","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"status":"completed"}},{"$setWindowFields":{"sortBy":{"orderDate":1},"output":{"runningTotal":{"$sum":"$amount","window":{"documents":["unbounded","current"]}}}}},{"$project":{"_id":1,"orderId":1,"amount":1,"runningTotal":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"status\": \"completed\"\n    }\n  },\n  {\n    \"$setWindowFields\": {\n      \"sortBy\": {\n        \"orderDate\": 1\n      },\n      \"output\": {\n        \"runningTotal\": {\n          \"$sum\": \"$amount\",\n          \"window\": {\n            \"documents\": [\n              \"unbounded\",\n              \"current\"\n            ]\n          }\n        }\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"amount\": 1,\n      \"runningTotal\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, base.data.amount AS amount, SUM(base.data.amount) OVER (ORDER BY base.data.orderDate ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS runningTotal FROM sales base WHERE base.data.status = 'completed'","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n       base.data.amount AS amount,\n       SUM(base.data.amount) OVER (\n                                   ORDER BY base.data.orderDate ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS runningTotal\nFROM sales base\nWHERE base.data.status = 'completed'","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"WINDOW003","name":"$setWindowFields - document number","description":"Tests $setWindowFields with $documentNumber","category":"setWindowFields","categoryName":"Window Functions","operator":"$setWindowFields","collection":"products","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"active":true}},{"$setWindowFields":{"partitionBy":"$category","sortBy":{"price":-1},"output":{"priceRankInCategory":{"$documentNumber":{}}}}},{"$match":{"priceRankInCategory":1}},{"$project":{"_id":1,"name":1,"category":1,"price":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"active\": true\n    }\n  },\n  {\n    \"$setWindowFields\": {\n      \"partitionBy\": \"$category\",\n      \"sortBy\": {\n        \"price\": -1\n      },\n      \"output\": {\n        \"priceRankInCategory\": {\n          \"$documentNumber\": {}\n        }\n      }\n    }\n  },\n  {\n    \"$match\": {\n      \"priceRankInCategory\": 1\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"category\": 1,\n      \"price\": 1\n    }\n  }\n]","sql":"SELECT id AS \"_id\", w.data.name AS name, w.data.category AS category, w.data.price AS price FROM (SELECT id, data, ROW_NUMBER() OVER (PARTITION BY base.data.category ORDER BY base.data.price DESC) AS priceRankInCategory FROM products base WHERE base.data.active = true) w WHERE priceRankInCategory = 1","sqlFormatted":"SELECT id AS \"_id\",\n       w.data.name AS name,\n       w.data.category AS category,\n       w.data.price AS price\nFROM\n  (SELECT id,\n          DATA,\n          ROW_NUMBER() OVER (PARTITION BY base.data.category\n                             ORDER BY base.data.price DESC) AS priceRankInCategory\n   FROM products base\n   WHERE base.data.active = TRUE) w\nWHERE priceRankInCategory = 1","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":3,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"WINDOW004","name":"$setWindowFields - dense rank","description":"Tests $setWindowFields with $denseRank","category":"setWindowFields","categoryName":"Window Functions","operator":"$setWindowFields","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$setWindowFields":{"sortBy":{"salary":-1},"output":{"denseRank":{"$denseRank":{}}}}},{"$match":{"denseRank":{"$lte":3}}},{"$project":{"_id":1,"name":1,"salary":1,"denseRank":1}},{"$sort":{"denseRank":1}}],"pipelineFormatted":"[\n  {\n    \"$setWindowFields\": {\n      \"sortBy\": {\n        \"salary\": -1\n      },\n      \"output\": {\n        \"denseRank\": {\n          \"$denseRank\": {}\n        }\n      }\n    }\n  },\n  {\n    \"$match\": {\n      \"denseRank\": {\n        \"$lte\": 3\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"salary\": 1,\n      \"denseRank\": 1\n    }\n  },\n  {\n    \"$sort\": {\n      \"denseRank\": 1\n    }\n  }\n]","sql":"SELECT id AS \"_id\", w.data.name AS name, w.data.salary AS salary, denseRank AS denseRank FROM (SELECT id, data, DENSE_RANK() OVER (ORDER BY base.data.salary DESC) AS denseRank FROM employees base) w WHERE denseRank <= 3 ORDER BY denseRank","sqlFormatted":"SELECT id AS \"_id\",\n       w.data.name AS name,\n       w.data.salary AS salary,\n       denseRank AS denseRank\nFROM\n  (SELECT id,\n          DATA,\n          DENSE_RANK() OVER (\n                             ORDER BY base.data.salary DESC) AS denseRank\n   FROM employees base) w\nWHERE denseRank <= 3\nORDER BY denseRank","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":3,"comparisonResult":"","sortBy":"denseRank","mongodbResults":null,"oracleResults":null},{"id":"TYPE001","name":"$type - get field type","description":"Tests $type operator to get BSON type of a field","category":"typeConversion","categoryName":"Type Conversion","operator":"$type","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"statusType":{"$type":"$status"},"amountType":{"$type":"$amount"}}},{"$limit":3},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"statusType\": {\n        \"$type\": \"$status\"\n      },\n      \"amountType\": {\n        \"$type\": \"$amount\"\n      }\n    }\n  },\n  {\n    \"$limit\": 3\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", CASE WHEN base.data.status IS NULL THEN 'null' WHEN base.data.status IN ('true', 'false') THEN 'bool' WHEN REGEXP_LIKE(base.data.status, '^-?[0-9]+$') THEN 'int' WHEN REGEXP_LIKE(base.data.status, '^-?[0-9]+\\.[0-9]+$') THEN 'double' ELSE 'string' END AS statusType, CASE WHEN base.data.amount IS NULL THEN 'null' WHEN base.data.amount IN ('true', 'false') THEN 'bool' WHEN REGEXP_LIKE(base.data.amount, '^-?[0-9]+$') THEN 'int' WHEN REGEXP_LIKE(base.data.amount, '^-?[0-9]+\\.[0-9]+$') THEN 'double' ELSE 'string' END AS amountType FROM sales base ORDER BY base.data.\"_id\" FETCH FIRST 3 ROWS ONLY","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       CASE\n           WHEN base.data.status IS NULL THEN 'null'\n           WHEN base.data.status IN ('true',\n                                     'false') THEN 'bool'\n           WHEN REGEXP_LIKE(base.data.status, '^-?[0-9]+$') THEN 'int'\n           WHEN REGEXP_LIKE(base.data.status, '^-?[0-9]+\\.[0-9]+$') THEN 'double'\n           ELSE 'string'\n       END AS statusType,\n       CASE\n           WHEN base.data.amount IS NULL THEN 'null'\n           WHEN base.data.amount IN ('true',\n                                     'false') THEN 'bool'\n           WHEN REGEXP_LIKE(base.data.amount, '^-?[0-9]+$') THEN 'int'\n           WHEN REGEXP_LIKE(base.data.amount, '^-?[0-9]+\\.[0-9]+$') THEN 'double'\n           ELSE 'string'\n       END AS amountType\nFROM sales base\nORDER BY base.data.\"_id\" FETCH FIRST 3 ROWS ONLY","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":3,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"TYPE002","name":"$toInt - convert string to integer","description":"Tests $toInt operator to convert values to integers","category":"typeConversion","categoryName":"Type Conversion","operator":"$toInt","collection":"products","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"name":1,"priceInt":{"$toInt":"$price"}}},{"$sort":{"_id":1}},{"$limit":5}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"priceInt\": {\n        \"$toInt\": \"$price\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  },\n  {\n    \"$limit\": 5\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, TRUNC(TO_NUMBER(base.data.price)) AS priceInt FROM products base ORDER BY base.data.\"_id\" FETCH FIRST 5 ROWS ONLY","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       TRUNC(TO_NUMBER(base.data.price)) AS priceInt\nFROM products base\nORDER BY base.data.\"_id\" FETCH FIRST 5 ROWS ONLY","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"TYPE003","name":"$toString - convert number to string","description":"Tests $toString operator to convert values to strings","category":"typeConversion","categoryName":"Type Conversion","operator":"$toString","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"name":1,"salaryStr":{"$toString":"$salary"}}},{"$sort":{"_id":1}},{"$limit":5}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"salaryStr\": {\n        \"$toString\": \"$salary\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  },\n  {\n    \"$limit\": 5\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, TO_CHAR(base.data.salary) AS salaryStr FROM employees base ORDER BY base.data.\"_id\" FETCH FIRST 5 ROWS ONLY","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       TO_CHAR(base.data.salary) AS salaryStr\nFROM employees base\nORDER BY base.data.\"_id\" FETCH FIRST 5 ROWS ONLY","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"TYPE004","name":"$toDouble - convert to double","description":"Tests $toDouble operator to convert values to doubles","category":"typeConversion","categoryName":"Type Conversion","operator":"$toDouble","collection":"products","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"name":1,"priceDouble":{"$toDouble":"$price"}}},{"$sort":{"_id":1}},{"$limit":5}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"priceDouble\": {\n        \"$toDouble\": \"$price\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  },\n  {\n    \"$limit\": 5\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, TO_BINARY_DOUBLE(base.data.price) AS priceDouble FROM products base ORDER BY base.data.\"_id\" FETCH FIRST 5 ROWS ONLY","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       TO_BINARY_DOUBLE(base.data.price) AS priceDouble\nFROM products base\nORDER BY base.data.\"_id\" FETCH FIRST 5 ROWS ONLY","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"TYPE005","name":"$toBool - convert to boolean","description":"Tests $toBool operator to convert values to booleans","category":"typeConversion","categoryName":"Type Conversion","operator":"$toBool","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"name":1,"isActive":{"$toBool":"$active"}}},{"$sort":{"_id":1}},{"$limit":5}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"isActive\": {\n        \"$toBool\": \"$active\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  },\n  {\n    \"$limit\": 5\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, CASE WHEN base.data.active IS NULL OR TO_CHAR(base.data.active) IN ('0', 'false') THEN 'false' ELSE 'true' END AS isActive FROM employees base ORDER BY base.data.\"_id\" FETCH FIRST 5 ROWS ONLY","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       CASE\n           WHEN base.data.active IS NULL\n                OR TO_CHAR(base.data.active) IN ('0',\n                                                 'false') THEN 'false'\n           ELSE 'true'\n       END AS isActive\nFROM employees base\nORDER BY base.data.\"_id\" FETCH FIRST 5 ROWS ONLY","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"STR007","name":"$split - split string into array","description":"Tests $split operator to split strings by delimiter","category":"string","categoryName":"String Operators","operator":"$split","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$addFields":{"nameParts":{"$split":["$name"," "]}}},{"$project":{"_id":1,"name":1,"firstName":{"$arrayElemAt":[{"$split":["$name"," "]},0]}}},{"$sort":{"_id":1}},{"$limit":5}],"pipelineFormatted":"[\n  {\n    \"$addFields\": {\n      \"nameParts\": {\n        \"$split\": [\n          \"$name\",\n          \" \"\n        ]\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"firstName\": {\n        \"$arrayElemAt\": [\n          {\n            \"$split\": [\n              \"$name\",\n              \" \"\n            ]\n          },\n          0\n        ]\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  },\n  {\n    \"$limit\": 5\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, REGEXP_SUBSTR(base.data.name, '[^'||' '||']+', 1, 1) AS firstName, (SELECT JSON_ARRAYAGG(REGEXP_SUBSTR(base.data.name, '[^' || ' ' || ']+', 1, LEVEL)) FROM DUAL CONNECT BY REGEXP_SUBSTR(base.data.name, '[^' || ' ' || ']+', 1, LEVEL) IS NOT NULL) AS nameParts FROM employees base ORDER BY base.data.\"_id\" FETCH FIRST 5 ROWS ONLY","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       REGEXP_SUBSTR(base.data.name, '[^'||' '||']+', 1, 1) AS firstName,\n\n  (SELECT JSON_ARRAYAGG(REGEXP_SUBSTR(base.data.name, '[^' || ' ' || ']+', 1, LEVEL))\n   FROM DUAL CONNECT BY REGEXP_SUBSTR(base.data.name, '[^' || ' ' || ']+', 1, LEVEL) IS NOT NULL) AS nameParts\nFROM employees base\nORDER BY base.data.\"_id\" FETCH FIRST 5 ROWS ONLY","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"STR008","name":"$indexOfCP - find substring position","description":"Tests $indexOfCP operator to find position of substring","category":"string","categoryName":"String Operators","operator":"$indexOfCP","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"name":1,"aPosition":{"$indexOfCP":["$name","a"]}}},{"$sort":{"_id":1}},{"$limit":5}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"aPosition\": {\n        \"$indexOfCP\": [\n          \"$name\",\n          \"a\"\n        ]\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  },\n  {\n    \"$limit\": 5\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, CASE WHEN INSTR(base.data.name, 'a') = 0 THEN -1 ELSE INSTR(base.data.name, 'a') - 1 END AS aPosition FROM employees base ORDER BY base.data.\"_id\" FETCH FIRST 5 ROWS ONLY","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       CASE\n           WHEN INSTR(base.data.name, 'a') = 0 THEN -1\n           ELSE INSTR(base.data.name, 'a') - 1\n       END AS aPosition\nFROM employees base\nORDER BY base.data.\"_id\" FETCH FIRST 5 ROWS ONLY","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"STR009","name":"$regexMatch - regex pattern matching","description":"Tests $regexMatch operator for pattern matching","category":"string","categoryName":"String Operators","operator":"$regexMatch","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"name":1,"hasVowelStart":{"$regexMatch":{"input":"$name","regex":"^[AEIOUaeiou]"}}}},{"$sort":{"_id":1}},{"$limit":5}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"hasVowelStart\": {\n        \"$regexMatch\": {\n          \"input\": \"$name\",\n          \"regex\": \"^[AEIOUaeiou]\"\n        }\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  },\n  {\n    \"$limit\": 5\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, CASE WHEN REGEXP_LIKE(base.data.name, '^[AEIOUaeiou]') THEN 1 ELSE 0 END AS hasVowelStart FROM employees base ORDER BY base.data.\"_id\" FETCH FIRST 5 ROWS ONLY","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       CASE\n           WHEN REGEXP_LIKE(base.data.name, '^[AEIOUaeiou]') THEN 1\n           ELSE 0\n       END AS hasVowelStart\nFROM employees base\nORDER BY base.data.\"_id\" FETCH FIRST 5 ROWS ONLY","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"STR010","name":"$replaceOne - replace first occurrence","description":"Tests $replaceOne operator to replace first match","category":"string","categoryName":"String Operators","operator":"$replaceOne","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"name":1,"modifiedDept":{"$replaceOne":{"input":"$department","find":"Engineering","replacement":"Tech"}}}},{"$sort":{"_id":1}},{"$limit":5}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"modifiedDept\": {\n        \"$replaceOne\": {\n          \"input\": \"$department\",\n          \"find\": \"Engineering\",\n          \"replacement\": \"Tech\"\n        }\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  },\n  {\n    \"$limit\": 5\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, REGEXP_REPLACE(base.data.department, 'Engineering', 'Tech', 1, 1) AS modifiedDept FROM employees base ORDER BY base.data.\"_id\" FETCH FIRST 5 ROWS ONLY","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       REGEXP_REPLACE(base.data.department, 'Engineering', 'Tech', 1, 1) AS modifiedDept\nFROM employees base\nORDER BY base.data.\"_id\" FETCH FIRST 5 ROWS ONLY","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"STR011","name":"$replaceAll - replace all occurrences","description":"Tests $replaceAll operator to replace all matches","category":"string","categoryName":"String Operators","operator":"$replaceAll","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"name":1,"nameNoSpaces":{"$replaceAll":{"input":"$name","find":" ","replacement":"_"}}}},{"$sort":{"_id":1}},{"$limit":5}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"nameNoSpaces\": {\n        \"$replaceAll\": {\n          \"input\": \"$name\",\n          \"find\": \" \",\n          \"replacement\": \"_\"\n        }\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  },\n  {\n    \"$limit\": 5\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, REGEXP_REPLACE(base.data.name, ' ', '_') AS nameNoSpaces FROM employees base ORDER BY base.data.\"_id\" FETCH FIRST 5 ROWS ONLY","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       REGEXP_REPLACE(base.data.name, ' ', '_') AS nameNoSpaces\nFROM employees base\nORDER BY base.data.\"_id\" FETCH FIRST 5 ROWS ONLY","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"ARR005","name":"$filter - filter array elements","description":"Tests $filter operator to filter array elements by condition","category":"array","categoryName":"Array Operators","operator":"$filter","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"orderId":1,"highValueItems":{"$filter":{"input":"$items","as":"item","cond":{"$gt":["$$item.qty",1]}}}}},{"$sort":{"orderId":1}},{"$limit":5}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"highValueItems\": {\n        \"$filter\": {\n          \"input\": \"$items\",\n          \"as\": \"item\",\n          \"cond\": {\n            \"$gt\": [\n              \"$$item.qty\",\n              1\n            ]\n          }\n        }\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"orderId\": 1\n    }\n  },\n  {\n    \"$limit\": 5\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, (SELECT COALESCE(JSON_ARRAYAGG(val FORMAT JSON), JSON_ARRAY()) FROM JSON_TABLE(base.data, '$.items[*]' COLUMNS (val VARCHAR2(4000) FORMAT JSON PATH '$', qty NUMBER PATH '$.qty')) WHERE qty > 1) AS highValueItems FROM sales base ORDER BY base.data.orderId FETCH FIRST 5 ROWS ONLY","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n\n  (SELECT COALESCE(JSON_ARRAYAGG(val FORMAT JSON), JSON_ARRAY())\n   FROM JSON_TABLE(base.data, '$.items[*]' COLUMNS (val VARCHAR2(4000) FORMAT JSON PATH '$', qty NUMBER PATH '$.qty'))\n   WHERE qty > 1) AS highValueItems\nFROM sales base\nORDER BY base.data.orderId FETCH FIRST 5 ROWS ONLY","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"orderId","mongodbResults":null,"oracleResults":null},{"id":"ARR006","name":"$map - transform array elements","description":"Tests $map operator to transform array elements","category":"array","categoryName":"Array Operators","operator":"$map","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"orderId":1,"itemProducts":{"$map":{"input":"$items","as":"item","in":"$$item.product"}}}},{"$sort":{"orderId":1}},{"$limit":5}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"itemProducts\": {\n        \"$map\": {\n          \"input\": \"$items\",\n          \"as\": \"item\",\n          \"in\": \"$$item.product\"\n        }\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"orderId\": 1\n    }\n  },\n  {\n    \"$limit\": 5\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, (SELECT COALESCE(JSON_ARRAYAGG(product), JSON_ARRAY()) FROM JSON_TABLE(base.data, '$.items[*]' COLUMNS (product VARCHAR2(4000) PATH '$.product'))) AS itemProducts FROM sales base ORDER BY base.data.orderId FETCH FIRST 5 ROWS ONLY","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n\n  (SELECT COALESCE(JSON_ARRAYAGG(product), JSON_ARRAY())\n   FROM JSON_TABLE(base.data, '$.items[*]' COLUMNS (product VARCHAR2(4000) PATH '$.product'))) AS itemProducts\nFROM sales base\nORDER BY base.data.orderId FETCH FIRST 5 ROWS ONLY","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"orderId","mongodbResults":null,"oracleResults":null},{"id":"ARR007","name":"$reduce - reduce array to single value","description":"Tests $reduce operator to reduce array to single value","category":"array","categoryName":"Array Operators","operator":"$reduce","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"orderId":1,"totalQty":{"$reduce":{"input":"$items","initialValue":0,"in":{"$add":["$$value","$$this.qty"]}}}}},{"$sort":{"orderId":1}},{"$limit":5}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"totalQty\": {\n        \"$reduce\": {\n          \"input\": \"$items\",\n          \"initialValue\": 0,\n          \"in\": {\n            \"$add\": [\n              \"$$value\",\n              \"$$this.qty\"\n            ]\n          }\n        }\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"orderId\": 1\n    }\n  },\n  {\n    \"$limit\": 5\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, (SELECT NVL(SUM(TO_NUMBER(val)), 0) FROM JSON_TABLE(base.data, '$.items[*]' COLUMNS (val VARCHAR2(4000) PATH '$.qty'))) AS totalQty FROM sales base ORDER BY base.data.orderId FETCH FIRST 5 ROWS ONLY","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n\n  (SELECT NVL(SUM(TO_NUMBER(val)), 0)\n   FROM JSON_TABLE(base.data, '$.items[*]' COLUMNS (val VARCHAR2(4000) PATH '$.qty'))) AS totalQty\nFROM sales base\nORDER BY base.data.orderId FETCH FIRST 5 ROWS ONLY","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"orderId","mongodbResults":null,"oracleResults":null},{"id":"ARR008","name":"$concatArrays - concatenate arrays","description":"Tests $concatArrays operator to concatenate multiple arrays","category":"array","categoryName":"Array Operators","operator":"$concatArrays","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"tags":{"$exists":true}}},{"$project":{"_id":1,"orderId":1,"allLabels":{"$concatArrays":["$tags",["extra"]]}}},{"$sort":{"orderId":1}},{"$limit":5}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"tags\": {\n        \"$exists\": true\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"allLabels\": {\n        \"$concatArrays\": [\n          \"$tags\",\n          [\n            \"extra\"\n          ]\n        ]\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"orderId\": 1\n    }\n  },\n  {\n    \"$limit\": 5\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, (SELECT JSON_ARRAYAGG(val ORDER BY rn) FROM (SELECT val, ROWNUM + 0 AS rn FROM JSON_TABLE(base.data, '$.tags[*]' COLUMNS (val VARCHAR2(4000) PATH '$')) UNION ALL SELECT val, ROWNUM + 1000 AS rn FROM JSON_TABLE('[\"extra\"]', '$[*]' COLUMNS (val VARCHAR2(4000) PATH '$')))) AS allLabels FROM sales base WHERE JSON_EXISTS(base.data, '$.tags') ORDER BY base.data.orderId FETCH FIRST 5 ROWS ONLY","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n\n  (SELECT JSON_ARRAYAGG(val\n                        ORDER BY rn)\n   FROM\n     (SELECT val, ROWNUM + 0 AS rn\n      FROM JSON_TABLE(base.data, '$.tags[*]' COLUMNS (val VARCHAR2(4000) PATH '$'))\n      UNION ALL SELECT val, ROWNUM + 1000 AS rn\n      FROM JSON_TABLE('[\"extra\"]', '$[*]' COLUMNS (val VARCHAR2(4000) PATH '$')))) AS allLabels\nFROM sales base\nWHERE JSON_EXISTS(base.data, '$.tags')\nORDER BY base.data.orderId FETCH FIRST 5 ROWS ONLY","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"orderId","mongodbResults":null,"oracleResults":null},{"id":"ARR009","name":"$slice - get subset of array","description":"Tests $slice operator to get array subset","category":"array","categoryName":"Array Operators","operator":"$slice","collection":"products","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"tags":{"$exists":true}}},{"$project":{"_id":1,"name":1,"firstTwoTags":{"$slice":["$tags",2]}}},{"$sort":{"_id":1}},{"$limit":5}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"tags\": {\n        \"$exists\": true\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"firstTwoTags\": {\n        \"$slice\": [\n          \"$tags\",\n          2\n        ]\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  },\n  {\n    \"$limit\": 5\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, JSON_QUERY(base.data, '$.tags[0 to 1]') AS firstTwoTags FROM products base WHERE JSON_EXISTS(base.data, '$.tags') ORDER BY base.data.\"_id\" FETCH FIRST 5 ROWS ONLY","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       JSON_QUERY(base.data, '$.tags[0 to 1]') AS firstTwoTags\nFROM products base\nWHERE JSON_EXISTS(base.data, '$.tags')\nORDER BY base.data.\"_id\" FETCH FIRST 5 ROWS ONLY","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"ARR010","name":"$slice - get last elements","description":"Tests $slice operator to get last N elements","category":"array","categoryName":"Array Operators","operator":"$slice","collection":"products","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"tags":{"$exists":true}}},{"$project":{"_id":1,"name":1,"lastTwoTags":{"$slice":["$tags",-2]}}},{"$sort":{"_id":1}},{"$limit":5}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"tags\": {\n        \"$exists\": true\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"lastTwoTags\": {\n        \"$slice\": [\n          \"$tags\",\n          -2\n        ]\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  },\n  {\n    \"$limit\": 5\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, JSON_QUERY(base.data, '$.tags[last-1 to last]') AS lastTwoTags FROM products base WHERE JSON_EXISTS(base.data, '$.tags') ORDER BY base.data.\"_id\" FETCH FIRST 5 ROWS ONLY","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       JSON_QUERY(base.data, '$.tags[last-1 to last]') AS lastTwoTags\nFROM products base\nWHERE JSON_EXISTS(base.data, '$.tags')\nORDER BY base.data.\"_id\" FETCH FIRST 5 ROWS ONLY","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"REDACT001","name":"$redact - document level filtering with PRUNE","description":"Tests $redact stage to filter documents based on condition","category":"redact","categoryName":"Redact Operations","operator":"$redact","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$redact":{"$cond":{"if":{"$gte":["$salary",80000]},"then":"$$KEEP","else":"$$PRUNE"}}},{"$project":{"_id":1,"name":1,"salary":1}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$redact\": {\n      \"$cond\": {\n        \"if\": {\n          \"$gte\": [\n            \"$salary\",\n            80000\n          ]\n        },\n        \"then\": \"$$KEEP\",\n        \"else\": \"$$PRUNE\"\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"salary\": 1\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, base.data.salary AS salary FROM employees base WHERE CASE WHEN base.data.salary >= 80000 THEN '$$KEEP' ELSE '$$PRUNE' END <> '$$PRUNE' ORDER BY base.data.\"_id\"","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       base.data.salary AS salary\nFROM employees base\nWHERE CASE\n          WHEN base.data.salary >= 80000 THEN '$$KEEP'\n          ELSE '$$PRUNE'\n      END <> '$$PRUNE'\nORDER BY base.data.\"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":6,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"REDACT002","name":"$redact - with DESCEND for nested documents","description":"Tests $redact stage with DESCEND option","category":"redact","categoryName":"Redact Operations","operator":"$redact","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$redact":{"$cond":{"if":{"$eq":["$status","completed"]},"then":"$$DESCEND","else":"$$PRUNE"}}},{"$project":{"_id":1,"orderId":1,"status":1}},{"$sort":{"orderId":1}}],"pipelineFormatted":"[\n  {\n    \"$redact\": {\n      \"$cond\": {\n        \"if\": {\n          \"$eq\": [\n            \"$status\",\n            \"completed\"\n          ]\n        },\n        \"then\": \"$$DESCEND\",\n        \"else\": \"$$PRUNE\"\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"status\": 1\n    }\n  },\n  {\n    \"$sort\": {\n      \"orderId\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, base.data.status AS status FROM sales base WHERE CASE WHEN base.data.status = 'completed' THEN '$$DESCEND' ELSE '$$PRUNE' END <> '$$PRUNE' ORDER BY base.data.orderId","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n       base.data.status AS status\nFROM sales base\nWHERE CASE\n          WHEN base.data.status = 'completed' THEN '$$DESCEND'\n          ELSE '$$PRUNE'\n      END <> '$$PRUNE'\nORDER BY base.data.orderId","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"orderId","mongodbResults":null,"oracleResults":null},{"id":"SAMPLE001","name":"$sample - random document selection","description":"Tests $sample stage to randomly select documents","category":"sample","categoryName":"Sample Operations","operator":"$sample","collection":"products","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$sample":{"size":3}},{"$project":{"_id":1,"name":1}}],"pipelineFormatted":"[\n  {\n    \"$sample\": {\n      \"size\": 3\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name FROM products base ORDER BY DBMS_RANDOM.VALUE FETCH FIRST 3 ROWS ONLY","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name\nFROM products base\nORDER BY DBMS_RANDOM.VALUE FETCH FIRST 3 ROWS ONLY","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":3,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"SAMPLE002","name":"$sample - with subsequent processing","description":"Tests $sample stage followed by other stages","category":"sample","categoryName":"Sample Operations","operator":"$sample","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$sample":{"size":5}},{"$project":{"_id":1,"name":1,"department":1}}],"pipelineFormatted":"[\n  {\n    \"$sample\": {\n      \"size\": 5\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"department\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, base.data.department AS department FROM employees base ORDER BY DBMS_RANDOM.VALUE FETCH FIRST 5 ROWS ONLY","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       base.data.department AS department\nFROM employees base\nORDER BY DBMS_RANDOM.VALUE FETCH FIRST 5 ROWS ONLY","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"COUNT001","name":"$count - count all documents","description":"Tests $count stage to count documents","category":"count","categoryName":"Count Operations","operator":"$count","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$count":"totalEmployees"}],"pipelineFormatted":"[\n  {\n    \"$count\": \"totalEmployees\"\n  }\n]","sql":"SELECT JSON_OBJECT('totalEmployees' VALUE COUNT(*)) AS data FROM employees base","sqlFormatted":"SELECT JSON_OBJECT('totalEmployees' VALUE COUNT(*)) AS DATA\nFROM employees base","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":1,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"COUNT002","name":"$count - count after filter","description":"Tests $count stage after $match filter","category":"count","categoryName":"Count Operations","operator":"$count","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"status":"completed"}},{"$count":"completedOrders"}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"status\": \"completed\"\n    }\n  },\n  {\n    \"$count\": \"completedOrders\"\n  }\n]","sql":"SELECT JSON_OBJECT('completedOrders' VALUE COUNT(*)) AS data FROM sales base WHERE base.data.status = 'completed'","sqlFormatted":"SELECT JSON_OBJECT('completedOrders' VALUE COUNT(*)) AS DATA\nFROM sales base\nWHERE base.data.status = 'completed'","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":1,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"COUNT003","name":"$count - count with complex filter","description":"Tests $count stage with complex $match conditions","category":"count","categoryName":"Count Operations","operator":"$count","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"$and":[{"active":true},{"salary":{"$gte":80000}}]}},{"$count":"highEarningActiveEmployees"}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"$and\": [\n        {\n          \"active\": true\n        },\n        {\n          \"salary\": {\n            \"$gte\": 80000\n          }\n        }\n      ]\n    }\n  },\n  {\n    \"$count\": \"highEarningActiveEmployees\"\n  }\n]","sql":"SELECT JSON_OBJECT('highEarningActiveEmployees' VALUE COUNT(*)) AS data FROM employees base WHERE (base.data.active = true) AND (CAST(base.data.salary AS NUMBER) >= 80000)","sqlFormatted":"SELECT JSON_OBJECT('highEarningActiveEmployees' VALUE COUNT(*)) AS DATA\nFROM employees base\nWHERE (base.data.active = TRUE)\n  AND (CAST(base.data.salary AS NUMBER) >= 80000)","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":1,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"GRAPHLOOKUP001","name":"$graphLookup - with restrictSearchWithMatch","description":"Tests $graphLookup with restrictSearchWithMatch filter","category":"graphLookup","categoryName":"Graph Lookup","operator":"$graphLookup","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"_id":"E001"}},{"$graphLookup":{"from":"employees","startWith":"$department","connectFromField":"department","connectToField":"department","as":"colleagues","maxDepth":0,"restrictSearchWithMatch":{"active":true}}},{"$project":{"_id":1,"name":1,"colleagueCount":{"$size":"$colleagues"}}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"_id\": \"E001\"\n    }\n  },\n  {\n    \"$graphLookup\": {\n      \"from\": \"employees\",\n      \"startWith\": \"$department\",\n      \"connectFromField\": \"department\",\n      \"connectToField\": \"department\",\n      \"as\": \"colleagues\",\n      \"maxDepth\": 0,\n      \"restrictSearchWithMatch\": {\n        \"active\": true\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"colleagueCount\": {\n        \"$size\": \"$colleagues\"\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, JSON_VALUE(base.data, '$.colleagues.size()' RETURNING NUMBER) AS colleagueCount, colleagues_cte.colleagues AS colleagues FROM employees base LEFT OUTER JOIN LATERAL (SELECT JSON_ARRAYAGG(g.data) AS colleagues FROM employees g WHERE g.data.department = base.data.department AND g.data.active = true) colleagues_cte ON 1=1 WHERE base.data.\"_id\" = 'E001'","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       JSON_VALUE(base.data, '$.colleagues.size()' RETURNING NUMBER) AS colleagueCount,\n       colleagues_cte.colleagues AS colleagues\nFROM employees base\nLEFT OUTER JOIN LATERAL\n  (SELECT JSON_ARRAYAGG(g.data) AS colleagues\n   FROM employees g\n   WHERE g.data.department = base.data.department\n     AND g.data.active = TRUE) colleagues_cte ON 1=1\nWHERE base.data.\"_id\" = 'E001'","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":1,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"NULL001","name":"Null equality comparison","description":"Tests matching documents where field equals null explicitly","category":"null_handling","categoryName":"Null Handling","operator":"$eq","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"discount":null}},{"$project":{"_id":1,"orderId":1,"discount":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"discount\": null\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"discount\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, base.data.discount AS discount FROM sales base WHERE base.data.discount IS NULL","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n       base.data.discount AS discount\nFROM sales base\nWHERE base.data.discount IS NULL","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":1,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"NULL002","name":"IfNull default value","description":"Tests $ifNull operator to replace null with default value","category":"null_handling","categoryName":"Null Handling","operator":"$ifNull","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"orderId":1,"discountApplied":{"$ifNull":["$discount",0]}}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"discountApplied\": {\n        \"$ifNull\": [\n          \"$discount\",\n          0\n        ]\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, NVL(CAST(base.data.discount AS NUMBER), 0) AS discountApplied FROM sales base","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n       NVL(CAST(base.data.discount AS NUMBER), 0) AS discountApplied\nFROM sales base","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"NULL003","name":"Null campaign field handling","description":"Tests matching nested field with null value in metadata.campaign","category":"null_handling","categoryName":"Null Handling","operator":"$eq","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"metadata.campaign":null}},{"$project":{"_id":1,"orderId":1,"campaign":"$metadata.campaign"}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"metadata.campaign\": null\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"campaign\": \"$metadata.campaign\"\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, base.data.metadata.campaign AS campaign FROM sales base WHERE base.data.metadata.campaign IS NULL","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n       base.data.metadata.campaign AS campaign\nFROM sales base\nWHERE base.data.metadata.campaign IS NULL","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":4,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"NULL004","name":"Null in accumulator - sum","description":"Tests $sum accumulator behavior with null values in group","category":"null_handling","categoryName":"Null Handling","operator":"$sum","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$group":{"_id":"$region","totalDiscount":{"$sum":"$discount"}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$group\": {\n      \"_id\": \"$region\",\n      \"totalDiscount\": {\n        \"$sum\": \"$discount\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.region AS \"_id\", SUM(base.data.discount) AS totalDiscount FROM sales base GROUP BY base.data.region ORDER BY \"_id\"","sqlFormatted":"SELECT base.data.region AS \"_id\",\n       SUM(base.data.discount) AS totalDiscount\nFROM sales base\nGROUP BY base.data.region\nORDER BY \"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":4,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"NULL005","name":"Null in accumulator - avg","description":"Tests $avg accumulator behavior with null values - nulls are ignored","category":"null_handling","categoryName":"Null Handling","operator":"$avg","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$group":{"_id":"$category","avgDiscount":{"$avg":"$discount"}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$group\": {\n      \"_id\": \"$category\",\n      \"avgDiscount\": {\n        \"$avg\": \"$discount\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.category AS \"_id\", AVG(base.data.discount) AS avgDiscount FROM sales base GROUP BY base.data.category ORDER BY \"_id\"","sqlFormatted":"SELECT base.data.category AS \"_id\",\n       AVG(base.data.discount) AS avgDiscount\nFROM sales base\nGROUP BY base.data.category\nORDER BY \"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"DATE006","name":"Extract minute from date","description":"Tests $minute operator to extract minute component from date","category":"date","categoryName":"Date Operators","operator":"$minute","collection":"events","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"eventName":1,"minute":{"$minute":"$eventDate"}}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"eventName\": 1,\n      \"minute\": {\n        \"$minute\": \"$eventDate\"\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.eventName AS eventName, EXTRACT(MINUTE FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.eventDate'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"')) AS minute FROM events base","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.eventName AS eventName,\n       EXTRACT(MINUTE\n               FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.eventDate'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"')) AS MINUTE\nFROM EVENTS base","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":8,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"DATE007","name":"Extract second from date","description":"Tests $second operator to extract second component from date","category":"date","categoryName":"Date Operators","operator":"$second","collection":"events","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"eventName":1,"second":{"$second":"$eventDate"}}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"eventName\": 1,\n      \"second\": {\n        \"$second\": \"$eventDate\"\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.eventName AS eventName, EXTRACT(SECOND FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.eventDate'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"')) AS second FROM events base","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.eventName AS eventName,\n       EXTRACT(SECOND\n               FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.eventDate'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"')) AS SECOND\nFROM EVENTS base","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":8,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"DATE008","name":"Day of week","description":"Tests $dayOfWeek operator - returns 1 (Sunday) to 7 (Saturday)","category":"date","categoryName":"Date Operators","operator":"$dayOfWeek","collection":"events","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"eventName":1,"dayOfWeek":{"$dayOfWeek":"$eventDate"}}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"eventName\": 1,\n      \"dayOfWeek\": {\n        \"$dayOfWeek\": \"$eventDate\"\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.eventName AS eventName, TO_NUMBER(TO_CHAR(TO_TIMESTAMP(JSON_VALUE(base.data, '$.eventDate'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"'), 'D')) AS dayOfWeek FROM events base","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.eventName AS eventName,\n       TO_NUMBER(TO_CHAR(TO_TIMESTAMP(JSON_VALUE(base.data, '$.eventDate'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"'), 'D')) AS dayOfWeek\nFROM EVENTS base","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":8,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"DATE009","name":"Day of year","description":"Tests $dayOfYear operator - returns day of year (1-366)","category":"date","categoryName":"Date Operators","operator":"$dayOfYear","collection":"events","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"eventName":1,"dayOfYear":{"$dayOfYear":"$eventDate"}}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"eventName\": 1,\n      \"dayOfYear\": {\n        \"$dayOfYear\": \"$eventDate\"\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.eventName AS eventName, TO_NUMBER(TO_CHAR(TO_TIMESTAMP(JSON_VALUE(base.data, '$.eventDate'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"'), 'DDD')) AS dayOfYear FROM events base","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.eventName AS eventName,\n       TO_NUMBER(TO_CHAR(TO_TIMESTAMP(JSON_VALUE(base.data, '$.eventDate'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"'), 'DDD')) AS dayOfYear\nFROM EVENTS base","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":8,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"DATE010","name":"Week of year","description":"Tests $week operator - returns ISO week number","category":"date","categoryName":"Date Operators","operator":"$week","collection":"events","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"eventName":1,"week":{"$week":"$eventDate"}}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"eventName\": 1,\n      \"week\": {\n        \"$week\": \"$eventDate\"\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.eventName AS eventName, TO_NUMBER(TO_CHAR(TO_TIMESTAMP(JSON_VALUE(base.data, '$.eventDate'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"'), 'IW')) AS week FROM events base","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.eventName AS eventName,\n       TO_NUMBER(TO_CHAR(TO_TIMESTAMP(JSON_VALUE(base.data, '$.eventDate'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"'), 'IW')) AS WEEK\nFROM EVENTS base","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":8,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"DATE012","name":"Group by month from date","description":"Tests grouping by month extracted from date field","category":"date","categoryName":"Date Operators","operator":"$month","collection":"events","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$group":{"_id":{"$month":"$eventDate"},"eventCount":{"$sum":1}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$group\": {\n      \"_id\": {\n        \"$month\": \"$eventDate\"\n      },\n      \"eventCount\": {\n        \"$sum\": 1\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT EXTRACT(MONTH FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.eventDate'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"')) AS \"_id\", SUM(1) AS eventCount FROM events base GROUP BY EXTRACT(MONTH FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.eventDate'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"')) ORDER BY \"_id\"","sqlFormatted":"SELECT EXTRACT(MONTH\n               FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.eventDate'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"')) AS \"_id\",\n       SUM(1) AS eventCount\nFROM EVENTS base\nGROUP BY EXTRACT(MONTH\n                 FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.eventDate'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"'))\nORDER BY \"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":3,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"ARITH006","name":"Absolute value","description":"Tests $abs operator to get absolute value of negative numbers","category":"arithmetic","categoryName":"Arithmetic Operators","operator":"$abs","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"orderId":1,"amount":1,"absoluteAmount":{"$abs":"$amount"}}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"amount\": 1,\n      \"absoluteAmount\": {\n        \"$abs\": \"$amount\"\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, base.data.amount AS amount, ABS(base.data.amount) AS absoluteAmount FROM sales base","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n       base.data.amount AS amount,\n       ABS(base.data.amount) AS absoluteAmount\nFROM sales base","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"ARITH007","name":"Ceiling function","description":"Tests $ceil operator to round up to nearest integer","category":"arithmetic","categoryName":"Arithmetic Operators","operator":"$ceil","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"orderId":1,"tax":1,"taxCeiled":{"$ceil":"$tax"}}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"tax\": 1,\n      \"taxCeiled\": {\n        \"$ceil\": \"$tax\"\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, base.data.tax AS tax, CEIL(base.data.tax) AS taxCeiled FROM sales base","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n       base.data.tax AS tax,\n       CEIL(base.data.tax) AS taxCeiled\nFROM sales base","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"ARITH008","name":"Floor function","description":"Tests $floor operator to round down to nearest integer","category":"arithmetic","categoryName":"Arithmetic Operators","operator":"$floor","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"orderId":1,"amount":1,"amountFloored":{"$floor":"$amount"}}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"amount\": 1,\n      \"amountFloored\": {\n        \"$floor\": \"$amount\"\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, base.data.amount AS amount, FLOOR(base.data.amount) AS amountFloored FROM sales base","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n       base.data.amount AS amount,\n       FLOOR(base.data.amount) AS amountFloored\nFROM sales base","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"ARITH009","name":"Round function","description":"Tests $round operator to round to specified decimal places","category":"arithmetic","categoryName":"Arithmetic Operators","operator":"$round","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"orderId":1,"amount":1,"amountRounded":{"$round":["$amount",0]}}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"amount\": 1,\n      \"amountRounded\": {\n        \"$round\": [\n          \"$amount\",\n          0\n        ]\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, base.data.amount AS amount, ROUND(base.data.amount, 0) AS amountRounded FROM sales base","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n       base.data.amount AS amount,\n       ROUND(base.data.amount, 0) AS amountRounded\nFROM sales base","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"ARITH010","name":"Truncate function","description":"Tests $trunc operator to truncate decimal places","category":"arithmetic","categoryName":"Arithmetic Operators","operator":"$trunc","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"orderId":1,"amount":1,"amountTruncated":{"$trunc":["$amount",1]}}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"amount\": 1,\n      \"amountTruncated\": {\n        \"$trunc\": [\n          \"$amount\",\n          1\n        ]\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, base.data.amount AS amount, TRUNC(base.data.amount, 1) AS amountTruncated FROM sales base","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n       base.data.amount AS amount,\n       TRUNC(base.data.amount, 1) AS amountTruncated\nFROM sales base","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"STR012","name":"Left trim","description":"Tests $ltrim operator to remove leading whitespace","category":"string","categoryName":"String Operators","operator":"$ltrim","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"name":1,"trimmedName":{"$ltrim":{"input":"$name"}}}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"trimmedName\": {\n        \"$ltrim\": {\n          \"input\": \"$name\"\n        }\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, TRIM(base.data.name) AS trimmedName FROM employees base","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       TRIM(base.data.name) AS trimmedName\nFROM employees base","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"STR013","name":"Right trim","description":"Tests $rtrim operator to remove trailing whitespace","category":"string","categoryName":"String Operators","operator":"$rtrim","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"name":1,"trimmedName":{"$rtrim":{"input":"$name"}}}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"trimmedName\": {\n        \"$rtrim\": {\n          \"input\": \"$name\"\n        }\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, TRIM(base.data.name) AS trimmedName FROM employees base","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       TRIM(base.data.name) AS trimmedName\nFROM employees base","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"STR014","name":"String case comparison","description":"Tests $strcasecmp operator for case-insensitive string comparison","category":"string","categoryName":"String Operators","operator":"$strcasecmp","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"name":1,"department":1,"compareResult":{"$strcasecmp":["$department","ENGINEERING"]}}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"department\": 1,\n      \"compareResult\": {\n        \"$strcasecmp\": [\n          \"$department\",\n          \"ENGINEERING\"\n        ]\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, base.data.department AS department, CASE WHEN UPPER(base.data.department) < UPPER('ENGINEERING') THEN -1 WHEN UPPER(base.data.department) > UPPER('ENGINEERING') THEN 1 ELSE 0 END AS compareResult FROM employees base","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       base.data.department AS department,\n       CASE\n           WHEN UPPER(base.data.department) < UPPER('ENGINEERING') THEN -1\n           WHEN UPPER(base.data.department) > UPPER('ENGINEERING') THEN 1\n           ELSE 0\n       END AS compareResult\nFROM employees base","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"ARR011","name":"Reverse array","description":"Tests $reverseArray operator to reverse array element order","category":"array","categoryName":"Array Operators","operator":"$reverseArray","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"_id":"S001"}},{"$project":{"_id":1,"tags":1,"reversedTags":{"$reverseArray":"$tags"}}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"_id\": \"S001\"\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"tags\": 1,\n      \"reversedTags\": {\n        \"$reverseArray\": \"$tags\"\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.tags AS tags, (SELECT JSON_ARRAYAGG(val ORDER BY rn DESC) FROM JSON_TABLE(base.data, '$.tags[*]' COLUMNS (val VARCHAR2(4000) PATH '$', rn FOR ORDINALITY))) AS reversedTags FROM sales base WHERE base.data.\"_id\" = 'S001'","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.tags AS tags,\n\n  (SELECT JSON_ARRAYAGG(val\n                        ORDER BY rn DESC)\n   FROM JSON_TABLE(base.data, '$.tags[*]' COLUMNS (val VARCHAR2(4000) PATH '$', rn\n                                                   FOR\n                                                   ORDINALITY))) AS reversedTags\nFROM sales base\nWHERE base.data.\"_id\" = 'S001'","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":1,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"ARR012","name":"Is array check","description":"Tests $isArray operator to check if field is an array","category":"array","categoryName":"Array Operators","operator":"$isArray","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"orderId":1,"isTagsArray":{"$isArray":"$tags"},"isAmountArray":{"$isArray":"$amount"}}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"isTagsArray\": {\n        \"$isArray\": \"$tags\"\n      },\n      \"isAmountArray\": {\n        \"$isArray\": \"$amount\"\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, CASE WHEN JSON_EXISTS(base.data, '$.tags[0]') THEN 1 ELSE 0 END AS isTagsArray, CASE WHEN JSON_EXISTS(base.data, '$.amount[0]') THEN 1 ELSE 0 END AS isAmountArray FROM sales base","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n       CASE\n           WHEN JSON_EXISTS(base.data, '$.tags[0]') THEN 1\n           ELSE 0\n       END AS isTagsArray,\n       CASE\n           WHEN JSON_EXISTS(base.data, '$.amount[0]') THEN 1\n           ELSE 0\n       END AS isAmountArray\nFROM sales base","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"ARR013","name":"Set union","description":"Tests $setUnion operator for union of two arrays","category":"array","categoryName":"Array Operators","operator":"$setUnion","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"_id":"S001"}},{"$project":{"_id":1,"tags":1,"unionResult":{"$setUnion":["$tags",["new-tag","premium"]]}}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"_id\": \"S001\"\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"tags\": 1,\n      \"unionResult\": {\n        \"$setUnion\": [\n          \"$tags\",\n          [\n            \"new-tag\",\n            \"premium\"\n          ]\n        ]\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.tags AS tags, (SELECT JSON_ARRAYAGG(val) FROM (SELECT DISTINCT val FROM (SELECT val FROM JSON_TABLE(JSON_QUERY(base.data, '$.tags'), '$[*]' COLUMNS (val VARCHAR2(4000) PATH '$')) UNION SELECT val FROM JSON_TABLE('[\"new-tag\",\"premium\"]', '$[*]' COLUMNS (val VARCHAR2(4000) PATH '$'))))) AS unionResult FROM sales base WHERE base.data.\"_id\" = 'S001'","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.tags AS tags,\n\n  (SELECT JSON_ARRAYAGG(val)\n   FROM\n     (SELECT DISTINCT val\n      FROM\n        (SELECT val\n         FROM JSON_TABLE(JSON_QUERY(base.data, '$.tags'), '$[*]' COLUMNS (val VARCHAR2(4000) PATH '$'))\n         UNION SELECT val\n         FROM JSON_TABLE('[\"new-tag\",\"premium\"]', '$[*]' COLUMNS (val VARCHAR2(4000) PATH '$'))))) AS unionResult\nFROM sales base\nWHERE base.data.\"_id\" = 'S001'","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":1,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"ARR014","name":"Set intersection","description":"Tests $setIntersection operator for intersection of arrays","category":"array","categoryName":"Array Operators","operator":"$setIntersection","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"_id":"S001"}},{"$project":{"_id":1,"tags":1,"intersectResult":{"$setIntersection":["$tags",["premium","discount"]]}}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"_id\": \"S001\"\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"tags\": 1,\n      \"intersectResult\": {\n        \"$setIntersection\": [\n          \"$tags\",\n          [\n            \"premium\",\n            \"discount\"\n          ]\n        ]\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.tags AS tags, (SELECT JSON_ARRAYAGG(val) FROM (SELECT DISTINCT val FROM JSON_TABLE(base.data, '$.tags[*]' COLUMNS (val VARCHAR2(4000) PATH '$')) INTERSECT SELECT DISTINCT val FROM JSON_TABLE('[\"premium\",\"discount\"]', '$[*]' COLUMNS (val VARCHAR2(4000) PATH '$')))) AS intersectResult FROM sales base WHERE base.data.\"_id\" = 'S001'","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.tags AS tags,\n\n  (SELECT JSON_ARRAYAGG(val)\n   FROM\n     (SELECT DISTINCT val\n      FROM JSON_TABLE(base.data, '$.tags[*]' COLUMNS (val VARCHAR2(4000) PATH '$')) INTERSECT SELECT DISTINCT val\n      FROM JSON_TABLE('[\"premium\",\"discount\"]', '$[*]' COLUMNS (val VARCHAR2(4000) PATH '$')))) AS intersectResult\nFROM sales base\nWHERE base.data.\"_id\" = 'S001'","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":1,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"CMP009","name":"Field exists - true","description":"Tests $exists operator to match documents where field exists","category":"comparison","categoryName":"Comparison Operators","operator":"$exists","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"metadata":{"$exists":true}}},{"$project":{"_id":1,"orderId":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"metadata\": {\n        \"$exists\": true\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId FROM sales base WHERE JSON_EXISTS(base.data, '$.metadata')","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId\nFROM sales base\nWHERE JSON_EXISTS(base.data, '$.metadata')","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":9,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"CMP010","name":"Field exists - false","description":"Tests $exists operator to match documents where field does not exist","category":"comparison","categoryName":"Comparison Operators","operator":"$exists","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"metadata":{"$exists":false}}},{"$project":{"_id":1,"orderId":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"metadata\": {\n        \"$exists\": false\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId FROM sales base WHERE NOT JSON_EXISTS(base.data, '$.metadata')","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId\nFROM sales base\nWHERE NOT JSON_EXISTS(base.data, '$.metadata')","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":1,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"LOG006","name":"Nor condition","description":"Tests $nor operator - none of the conditions match","category":"logical","categoryName":"Logical Operators","operator":"$nor","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"$nor":[{"status":"completed"},{"status":"pending"}]}},{"$project":{"_id":1,"orderId":1,"status":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"$nor\": [\n        {\n          \"status\": \"completed\"\n        },\n        {\n          \"status\": \"pending\"\n        }\n      ]\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"status\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, base.data.status AS status FROM sales base WHERE NOT ((base.data.status = 'completed') OR (base.data.status = 'pending'))","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n       base.data.status AS status\nFROM sales base\nWHERE NOT ((base.data.status = 'completed')\n           OR (base.data.status = 'pending'))","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":4,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"AGG009","name":"First in group","description":"Tests $first accumulator to get first value in each group","category":"accumulator","categoryName":"Accumulator Operators","operator":"$first","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$sort":{"salary":-1}},{"$group":{"_id":"$department","highestPaidEmployee":{"$first":"$name"}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$sort\": {\n      \"salary\": -1\n    }\n  },\n  {\n    \"$group\": {\n      \"_id\": \"$department\",\n      \"highestPaidEmployee\": {\n        \"$first\": \"$name\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.department AS \"_id\", MIN(base.data.name) AS highestPaidEmployee FROM employees base GROUP BY base.data.department ORDER BY \"_id\"","sqlFormatted":"SELECT base.data.department AS \"_id\",\n       MIN(base.data.name) AS highestPaidEmployee\nFROM employees base\nGROUP BY base.data.department\nORDER BY \"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":4,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"AGG010","name":"Last in group","description":"Tests $last accumulator to get last value in each group","category":"accumulator","categoryName":"Accumulator Operators","operator":"$last","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$sort":{"salary":-1}},{"$group":{"_id":"$department","lowestPaidEmployee":{"$last":"$name"}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$sort\": {\n      \"salary\": -1\n    }\n  },\n  {\n    \"$group\": {\n      \"_id\": \"$department\",\n      \"lowestPaidEmployee\": {\n        \"$last\": \"$name\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT base.data.department AS \"_id\", MAX(base.data.name) AS lowestPaidEmployee FROM employees base GROUP BY base.data.department ORDER BY \"_id\"","sqlFormatted":"SELECT base.data.department AS \"_id\",\n       MAX(base.data.name) AS lowestPaidEmployee\nFROM employees base\nGROUP BY base.data.department\nORDER BY \"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":4,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"COMPLEX006","name":"Unwind then group","description":"Tests flattening array with $unwind then aggregating with $group","category":"complex","categoryName":"Complex Pipelines","operator":"$unwind+$group","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$unwind":"$items"},{"$group":{"_id":"$items.product","totalQuantity":{"$sum":"$items.qty"},"totalRevenue":{"$sum":{"$multiply":["$items.qty","$items.price"]}}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$unwind\": \"$items\"\n  },\n  {\n    \"$group\": {\n      \"_id\": \"$items.product\",\n      \"totalQuantity\": {\n        \"$sum\": \"$items.qty\"\n      },\n      \"totalRevenue\": {\n        \"$sum\": {\n          \"$multiply\": [\n            \"$items.qty\",\n            \"$items.price\"\n          ]\n        }\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT unwind_1.value.product AS \"_id\", SUM(unwind_1.value.qty) AS totalQuantity, SUM((unwind_1.value.qty * unwind_1.value.price)) AS totalRevenue FROM sales base, JSON_TABLE(base.data, '$.items[*]' COLUMNS (value JSON PATH '$')) unwind_1 GROUP BY unwind_1.value.product ORDER BY \"_id\"","sqlFormatted":"SELECT unwind_1.value.product AS \"_id\",\n       SUM(unwind_1.value.qty) AS totalQuantity,\n       SUM((unwind_1.value.qty * unwind_1.value.price)) AS totalRevenue\nFROM sales base,\n     JSON_TABLE(base.data, '$.items[*]' COLUMNS (value JSON PATH '$')) unwind_1\nGROUP BY unwind_1.value.product\nORDER BY \"_id\"","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"COMPLEX007","name":"Group sort limit - Top N","description":"Tests Top N pattern - aggregate, sort, and limit","category":"complex","categoryName":"Complex Pipelines","operator":"$group+$sort+$limit","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$group":{"_id":"$category","totalAmount":{"$sum":"$amount"},"orderCount":{"$sum":1}}},{"$sort":{"totalAmount":-1}},{"$limit":3}],"pipelineFormatted":"[\n  {\n    \"$group\": {\n      \"_id\": \"$category\",\n      \"totalAmount\": {\n        \"$sum\": \"$amount\"\n      },\n      \"orderCount\": {\n        \"$sum\": 1\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"totalAmount\": -1\n    }\n  },\n  {\n    \"$limit\": 3\n  }\n]","sql":"SELECT base.data.category AS \"_id\", SUM(base.data.amount) AS totalAmount, SUM(1) AS orderCount FROM sales base GROUP BY base.data.category ORDER BY totalAmount DESC FETCH FIRST 3 ROWS ONLY","sqlFormatted":"SELECT base.data.category AS \"_id\",\n       SUM(base.data.amount) AS totalAmount,\n       SUM(1) AS orderCount\nFROM sales base\nGROUP BY base.data.category\nORDER BY totalAmount DESC FETCH FIRST 3 ROWS ONLY","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":3,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"COMPLEX008","name":"Union then aggregate","description":"Tests combining collections with $unionWith then aggregating","category":"complex","categoryName":"Complex Pipelines","operator":"$unionWith+$group","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"source":"sales","amount":1}},{"$unionWith":{"coll":"products","pipeline":[{"$project":{"source":"products","amount":"$price"}}]}},{"$group":{"_id":"$source","totalAmount":{"$sum":"$amount"}}},{"$sort":{"_id":1}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"source\": \"sales\",\n      \"amount\": 1\n    }\n  },\n  {\n    \"$unionWith\": {\n      \"coll\": \"products\",\n      \"pipeline\": [\n        {\n          \"$project\": {\n            \"source\": \"products\",\n            \"amount\": \"$price\"\n          }\n        }\n      ]\n    }\n  },\n  {\n    \"$group\": {\n      \"_id\": \"$source\",\n      \"totalAmount\": {\n        \"$sum\": \"$amount\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  }\n]","sql":"SELECT source AS \"_id\", SUM(amount) AS totalAmount FROM (SELECT 'sales' AS source, base.data.amount AS amount FROM sales base UNION ALL SELECT 'products' AS source, base.data.price AS amount FROM products base) GROUP BY source","sqlFormatted":"SELECT SOURCE AS \"_id\",\n                 SUM(amount) AS totalAmount\nFROM\n  (SELECT 'sales' AS SOURCE,\n          base.data.amount AS amount\n   FROM sales base\n   UNION ALL SELECT 'products' AS SOURCE,\n                    base.data.price AS amount\n   FROM products base)\nGROUP BY SOURCE","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":2,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"EXPR001","name":"Switch expression","description":"Tests $switch operator for multi-branch conditional logic","category":"expression","categoryName":"Expression Operators","operator":"$switch","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"name":1,"salary":1,"salaryBand":{"$switch":{"branches":[{"case":{"$lt":["$salary",60000]},"then":"Junior"},{"case":{"$lt":["$salary",90000]},"then":"Mid"},{"case":{"$gte":["$salary",90000]},"then":"Senior"}],"default":"Unknown"}}}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"salary\": 1,\n      \"salaryBand\": {\n        \"$switch\": {\n          \"branches\": [\n            {\n              \"case\": {\n                \"$lt\": [\n                  \"$salary\",\n                  60000\n                ]\n              },\n              \"then\": \"Junior\"\n            },\n            {\n              \"case\": {\n                \"$lt\": [\n                  \"$salary\",\n                  90000\n                ]\n              },\n              \"then\": \"Mid\"\n            },\n            {\n              \"case\": {\n                \"$gte\": [\n                  \"$salary\",\n                  90000\n                ]\n              },\n              \"then\": \"Senior\"\n            }\n          ],\n          \"default\": \"Unknown\"\n        }\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, base.data.salary AS salary, CASE WHEN base.data.salary < 60000 THEN 'Junior' WHEN base.data.salary < 90000 THEN 'Mid' WHEN base.data.salary >= 90000 THEN 'Senior' ELSE 'Unknown' END AS salaryBand FROM employees base","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       base.data.salary AS salary,\n       CASE\n           WHEN base.data.salary < 60000 THEN 'Junior'\n           WHEN base.data.salary < 90000 THEN 'Mid'\n           WHEN base.data.salary >= 90000 THEN 'Senior'\n           ELSE 'Unknown'\n       END AS salaryBand\nFROM employees base","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"EXPR002","name":"Nested conditional","description":"Tests deeply nested $cond expressions","category":"expression","categoryName":"Expression Operators","operator":"$cond","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"orderId":1,"status":1,"priority":{"$cond":{"if":{"$eq":["$status","completed"]},"then":"low","else":{"$cond":{"if":{"$eq":["$status","pending"]},"then":"high","else":"medium"}}}}}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"status\": 1,\n      \"priority\": {\n        \"$cond\": {\n          \"if\": {\n            \"$eq\": [\n              \"$status\",\n              \"completed\"\n            ]\n          },\n          \"then\": \"low\",\n          \"else\": {\n            \"$cond\": {\n              \"if\": {\n                \"$eq\": [\n                  \"$status\",\n                  \"pending\"\n                ]\n              },\n              \"then\": \"high\",\n              \"else\": \"medium\"\n            }\n          }\n        }\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, base.data.status AS status, CASE WHEN base.data.status = 'completed' THEN 'low' ELSE CASE WHEN base.data.status = 'pending' THEN 'high' ELSE 'medium' END END AS priority FROM sales base","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n       base.data.status AS status,\n       CASE\n           WHEN base.data.status = 'completed' THEN 'low'\n           ELSE CASE\n                    WHEN base.data.status = 'pending' THEN 'high'\n                    ELSE 'medium'\n                END\n       END AS priority\nFROM sales base","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"REPLACEROOT001","name":"Replace root with nested object","description":"Tests $replaceRoot to promote nested object to root","category":"replaceRoot","categoryName":"Replace Root","operator":"$replaceRoot","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"metadata":{"$ne":null}}},{"$replaceRoot":{"newRoot":{"orderId":"$orderId","source":"$metadata.source","campaign":"$metadata.campaign"}}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"metadata\": {\n        \"$ne\": null\n      }\n    }\n  },\n  {\n    \"$replaceRoot\": {\n      \"newRoot\": {\n        \"orderId\": \"$orderId\",\n        \"source\": \"$metadata.source\",\n        \"campaign\": \"$metadata.campaign\"\n      }\n    }\n  }\n]","sql":"SELECT base.data.orderId AS orderId, base.data.metadata.source AS source, base.data.metadata.campaign AS campaign FROM sales base WHERE base.data.metadata IS NOT NULL","sqlFormatted":"SELECT base.data.orderId AS orderId,\n       base.data.metadata.source AS SOURCE,\n       base.data.metadata.campaign AS campaign\nFROM sales base\nWHERE base.data.metadata IS NOT NULL","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":9,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"OBJ001","name":"Merge objects in projection","description":"Tests $mergeObjects operator to combine objects in projection","category":"object","categoryName":"Object Operations","operator":"$mergeObjects","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"_id":"S001"}},{"$project":{"_id":1,"merged":{"$mergeObjects":[{"orderId":"$orderId"},"$metadata"]}}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"_id\": \"S001\"\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"merged\": {\n        \"$mergeObjects\": [\n          {\n            \"orderId\": \"$orderId\"\n          },\n          \"$metadata\"\n        ]\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", JSON_MERGEPATCH(JSON_OBJECT('orderId' VALUE base.data.orderId), JSON_QUERY(base.data, '$.metadata')) AS merged FROM sales base WHERE base.data.\"_id\" = 'S001'","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       JSON_MERGEPATCH(JSON_OBJECT('orderId' VALUE base.data.orderId), JSON_QUERY(base.data, '$.metadata')) AS merged\nFROM sales base\nWHERE base.data.\"_id\" = 'S001'","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":1,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"LOOKUP003","name":"Self join lookup","description":"Tests $lookup self-join on same collection","category":"lookup","categoryName":"Lookup Operations","operator":"$lookup","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"_id":"E001"}},{"$lookup":{"from":"employees","localField":"department","foreignField":"department","as":"colleagues"}},{"$project":{"_id":1,"name":1,"department":1,"colleagueCount":{"$size":"$colleagues"}}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"_id\": \"E001\"\n    }\n  },\n  {\n    \"$lookup\": {\n      \"from\": \"employees\",\n      \"localField\": \"department\",\n      \"foreignField\": \"department\",\n      \"as\": \"colleagues\"\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"department\": 1,\n      \"colleagueCount\": {\n        \"$size\": \"$colleagues\"\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, base.data.department AS department, (SELECT COUNT(*) FROM employees sz_emp WHERE sz_emp.data.\"department\" = base.data.\"department\") AS colleagueCount FROM employees base WHERE base.data.\"_id\" = 'E001'","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       base.data.department AS department,\n\n  (SELECT COUNT(*)\n   FROM employees sz_emp\n   WHERE sz_emp.data.\"department\" = base.data.\"department\") AS colleagueCount\nFROM employees base\nWHERE base.data.\"_id\" = 'E001'","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":1,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"LOOKUP004","name":"Multiple lookups in pipeline","description":"Tests chain of multiple $lookup stages","category":"lookup","categoryName":"Lookup Operations","operator":"$lookup","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"_id":"S001"}},{"$lookup":{"from":"customers","localField":"customerId","foreignField":"customerId","as":"customer"}},{"$lookup":{"from":"inventory","localField":"orderId","foreignField":"productId","as":"inventoryItems"}},{"$project":{"_id":1,"orderId":1,"hasCustomer":{"$gt":[{"$size":"$customer"},0]},"inventoryCount":{"$size":"$inventoryItems"}}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"_id\": \"S001\"\n    }\n  },\n  {\n    \"$lookup\": {\n      \"from\": \"customers\",\n      \"localField\": \"customerId\",\n      \"foreignField\": \"customerId\",\n      \"as\": \"customer\"\n    }\n  },\n  {\n    \"$lookup\": {\n      \"from\": \"inventory\",\n      \"localField\": \"orderId\",\n      \"foreignField\": \"productId\",\n      \"as\": \"inventoryItems\"\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"hasCustomer\": {\n        \"$gt\": [\n          {\n            \"$size\": \"$customer\"\n          },\n          0\n        ]\n      },\n      \"inventoryCount\": {\n        \"$size\": \"$inventoryItems\"\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, (SELECT COUNT(*) FROM customers sz_cus WHERE sz_cus.data.\"customerId\" = base.data.\"customerId\") > 0 AS hasCustomer, (SELECT COUNT(*) FROM inventory sz_inv WHERE sz_inv.data.\"productId\" = base.data.\"orderId\") AS inventoryCount FROM sales base WHERE base.data.\"_id\" = 'S001'","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n\n  (SELECT COUNT(*)\n   FROM customers sz_cus\n   WHERE sz_cus.data.\"customerId\" = base.data.\"customerId\") > 0 AS hasCustomer,\n\n  (SELECT COUNT(*)\n   FROM inventory sz_inv\n   WHERE sz_inv.data.\"productId\" = base.data.\"orderId\") AS inventoryCount\nFROM sales base\nWHERE base.data.\"_id\" = 'S001'","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":1,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"LOOKUP_PIPELINE001","name":"$lookup with pipeline - basic let/match","description":"Tests $lookup with pipeline form using let variables and $match","category":"lookup","categoryName":"Lookup Operations","operator":"$lookup","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"status":"completed"}},{"$lookup":{"from":"customers","let":{"custId":"$customerId"},"pipeline":[{"$match":{"$expr":{"$eq":["$_id","$$custId"]}}}],"as":"customerData"}},{"$project":{"_id":1,"orderId":1,"customerData":1}},{"$sort":{"orderId":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"status\": \"completed\"\n    }\n  },\n  {\n    \"$lookup\": {\n      \"from\": \"customers\",\n      \"let\": {\n        \"custId\": \"$customerId\"\n      },\n      \"pipeline\": [\n        {\n          \"$match\": {\n            \"$expr\": {\n              \"$eq\": [\n                \"$_id\",\n                \"$$custId\"\n              ]\n            }\n          }\n        }\n      ],\n      \"as\": \"customerData\"\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"customerData\": 1\n    }\n  },\n  {\n    \"$sort\": {\n      \"orderId\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, base.data.customerData AS customerData FROM sales base , LATERAL (SELECT JSON_ARRAYAGG(customers_1_inner.data) AS customerData FROM customers customers_1_inner WHERE JSON_VALUE(customers_1_inner.data, '$._id') = JSON_VALUE(base.data, '$.customerId')) customers_1 WHERE base.data.status = 'completed' ORDER BY base.data.orderId","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n       base.data.customerData AS customerData\nFROM sales base,\n     LATERAL\n  (SELECT JSON_ARRAYAGG(customers_1_inner.data) AS customerData\n   FROM customers customers_1_inner\n   WHERE JSON_VALUE(customers_1_inner.data, '$._id') = JSON_VALUE(base.data, '$.customerId')) customers_1\nWHERE base.data.status = 'completed'\nORDER BY base.data.orderId","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"LOOKUP_PIPELINE002","name":"$lookup with pipeline - filter by status","description":"Tests $lookup pipeline filtering related documents by status","category":"lookup","categoryName":"Lookup Operations","operator":"$lookup","collection":"customers","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"tier":"gold"}},{"$lookup":{"from":"sales","let":{"custId":"$_id"},"pipeline":[{"$match":{"$expr":{"$and":[{"$eq":["$customerId","$$custId"]},{"$eq":["$status","completed"]}]}}}],"as":"completedOrders"}},{"$project":{"_id":1,"name":1,"orderCount":{"$size":"$completedOrders"}}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"tier\": \"gold\"\n    }\n  },\n  {\n    \"$lookup\": {\n      \"from\": \"sales\",\n      \"let\": {\n        \"custId\": \"$_id\"\n      },\n      \"pipeline\": [\n        {\n          \"$match\": {\n            \"$expr\": {\n              \"$and\": [\n                {\n                  \"$eq\": [\n                    \"$customerId\",\n                    \"$$custId\"\n                  ]\n                },\n                {\n                  \"$eq\": [\n                    \"$status\",\n                    \"completed\"\n                  ]\n                }\n              ]\n            }\n          }\n        }\n      ],\n      \"as\": \"completedOrders\"\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"orderCount\": {\n        \"$size\": \"$completedOrders\"\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, JSON_VALUE(base.data, '$.completedOrders.size()' RETURNING NUMBER) AS orderCount FROM customers base , LATERAL (SELECT JSON_ARRAYAGG(sales_1_inner.data) AS completedOrders FROM sales sales_1_inner WHERE (JSON_VALUE(sales_1_inner.data, '$.customerId') = JSON_VALUE(base.data, '$._id') AND JSON_VALUE(sales_1_inner.data, '$.status') = 'completed')) sales_1 WHERE base.data.tier = 'gold'","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       JSON_VALUE(base.data, '$.completedOrders.size()' RETURNING NUMBER) AS orderCount\nFROM customers base,\n     LATERAL\n  (SELECT JSON_ARRAYAGG(sales_1_inner.data) AS completedOrders\n   FROM sales sales_1_inner\n   WHERE (JSON_VALUE(sales_1_inner.data, '$.customerId') = JSON_VALUE(base.data, '$._id')\n          AND JSON_VALUE(sales_1_inner.data, '$.status') = 'completed')) sales_1\nWHERE base.data.tier = 'gold'","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":2,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"LOOKUP_PIPELINE003","name":"$lookup with pipeline - with $sort inside","description":"Tests $lookup pipeline with $sort stage to order results","category":"lookup","categoryName":"Lookup Operations","operator":"$lookup","collection":"customers","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"_id":"C001"}},{"$lookup":{"from":"sales","let":{"custId":"$_id"},"pipeline":[{"$match":{"$expr":{"$eq":["$customerId","$$custId"]}}},{"$sort":{"amount":-1}}],"as":"ordersByAmount"}},{"$project":{"_id":1,"name":1,"ordersByAmount":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"_id\": \"C001\"\n    }\n  },\n  {\n    \"$lookup\": {\n      \"from\": \"sales\",\n      \"let\": {\n        \"custId\": \"$_id\"\n      },\n      \"pipeline\": [\n        {\n          \"$match\": {\n            \"$expr\": {\n              \"$eq\": [\n                \"$customerId\",\n                \"$$custId\"\n              ]\n            }\n          }\n        },\n        {\n          \"$sort\": {\n            \"amount\": -1\n          }\n        }\n      ],\n      \"as\": \"ordersByAmount\"\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"ordersByAmount\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, base.data.ordersByAmount AS ordersByAmount FROM customers base , LATERAL (SELECT JSON_ARRAYAGG(sales_1_inner.data ORDER BY JSON_VALUE(sales_1_inner.data, '$.amount') DESC) AS ordersByAmount FROM sales sales_1_inner WHERE JSON_VALUE(sales_1_inner.data, '$.customerId') = JSON_VALUE(base.data, '$._id')) sales_1 WHERE base.data.\"_id\" = 'C001'","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       base.data.ordersByAmount AS ordersByAmount\nFROM customers base,\n     LATERAL\n  (SELECT JSON_ARRAYAGG(sales_1_inner.data\n                        ORDER BY JSON_VALUE(sales_1_inner.data, '$.amount') DESC) AS ordersByAmount\n   FROM sales sales_1_inner\n   WHERE JSON_VALUE(sales_1_inner.data, '$.customerId') = JSON_VALUE(base.data, '$._id')) sales_1\nWHERE base.data.\"_id\" = 'C001'","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":1,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"LOOKUP_PIPELINE004","name":"$lookup with pipeline - with $limit inside","description":"Tests $lookup pipeline with $limit to restrict results","category":"lookup","categoryName":"Lookup Operations","operator":"$lookup","collection":"customers","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"tier":"gold"}},{"$lookup":{"from":"sales","let":{"custId":"$_id"},"pipeline":[{"$match":{"$expr":{"$eq":["$customerId","$$custId"]}}},{"$sort":{"orderDate":-1}},{"$limit":3}],"as":"recentOrders"}},{"$project":{"_id":1,"name":1,"recentOrders":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"tier\": \"gold\"\n    }\n  },\n  {\n    \"$lookup\": {\n      \"from\": \"sales\",\n      \"let\": {\n        \"custId\": \"$_id\"\n      },\n      \"pipeline\": [\n        {\n          \"$match\": {\n            \"$expr\": {\n              \"$eq\": [\n                \"$customerId\",\n                \"$$custId\"\n              ]\n            }\n          }\n        },\n        {\n          \"$sort\": {\n            \"orderDate\": -1\n          }\n        },\n        {\n          \"$limit\": 3\n        }\n      ],\n      \"as\": \"recentOrders\"\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"recentOrders\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, base.data.recentOrders AS recentOrders FROM customers base , LATERAL (SELECT JSON_ARRAYAGG(sales_1_inner.data ORDER BY JSON_VALUE(sales_1_inner.data, '$.orderDate') DESC) AS recentOrders FROM sales sales_1_inner WHERE JSON_VALUE(sales_1_inner.data, '$.customerId') = JSON_VALUE(base.data, '$._id') FETCH FIRST 3 ROWS ONLY) sales_1 WHERE base.data.tier = 'gold'","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       base.data.recentOrders AS recentOrders\nFROM customers base,\n     LATERAL\n  (SELECT JSON_ARRAYAGG(sales_1_inner.data\n                        ORDER BY JSON_VALUE(sales_1_inner.data, '$.orderDate') DESC) AS recentOrders\n   FROM sales sales_1_inner\n   WHERE JSON_VALUE(sales_1_inner.data, '$.customerId') = JSON_VALUE(base.data, '$._id') FETCH FIRST 3 ROWS ONLY) sales_1\nWHERE base.data.tier = 'gold'","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":2,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"LOOKUP_PIPELINE005","name":"$lookup with empty pipeline","description":"Tests $lookup pipeline form with empty pipeline (selects all)","category":"lookup","categoryName":"Lookup Operations","operator":"$lookup","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"_id":"S001"}},{"$lookup":{"from":"inventory","let":{},"pipeline":[],"as":"allInventory"}},{"$project":{"_id":1,"orderId":1,"inventoryCount":{"$size":"$allInventory"}}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"_id\": \"S001\"\n    }\n  },\n  {\n    \"$lookup\": {\n      \"from\": \"inventory\",\n      \"let\": {},\n      \"pipeline\": [],\n      \"as\": \"allInventory\"\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"inventoryCount\": {\n        \"$size\": \"$allInventory\"\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, JSON_VALUE(base.data, '$.allInventory.size()' RETURNING NUMBER) AS inventoryCount FROM sales base , LATERAL (SELECT JSON_ARRAYAGG(inventory_1_inner.data) AS allInventory FROM inventory inventory_1_inner) inventory_1 WHERE base.data.\"_id\" = 'S001'","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n       JSON_VALUE(base.data, '$.allInventory.size()' RETURNING NUMBER) AS inventoryCount\nFROM sales base,\n     LATERAL\n  (SELECT JSON_ARRAYAGG(inventory_1_inner.data) AS allInventory\n   FROM inventory inventory_1_inner) inventory_1\nWHERE base.data.\"_id\" = 'S001'","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":1,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"WINDOW005","name":"Window running total","description":"Tests running total with window function","category":"window","categoryName":"Window Operations","operator":"$setWindowFields","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$match":{"status":"completed"}},{"$setWindowFields":{"sortBy":{"orderDate":1},"output":{"runningTotal":{"$sum":"$amount","window":{"documents":["unbounded","current"]}}}}},{"$project":{"_id":1,"orderId":1,"amount":1,"runningTotal":1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"status\": \"completed\"\n    }\n  },\n  {\n    \"$setWindowFields\": {\n      \"sortBy\": {\n        \"orderDate\": 1\n      },\n      \"output\": {\n        \"runningTotal\": {\n          \"$sum\": \"$amount\",\n          \"window\": {\n            \"documents\": [\n              \"unbounded\",\n              \"current\"\n            ]\n          }\n        }\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"amount\": 1,\n      \"runningTotal\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, base.data.amount AS amount, SUM(base.data.amount) OVER (ORDER BY base.data.orderDate ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS runningTotal FROM sales base WHERE base.data.status = 'completed'","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n       base.data.amount AS amount,\n       SUM(base.data.amount) OVER (\n                                   ORDER BY base.data.orderDate ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS runningTotal\nFROM sales base\nWHERE base.data.status = 'completed'","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":5,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"WINDOW006","name":"Window moving average","description":"Tests moving average with 3-row window","category":"window","categoryName":"Window Operations","operator":"$setWindowFields","collection":"employees","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$setWindowFields":{"sortBy":{"salary":1},"output":{"movingAvgSalary":{"$avg":"$salary","window":{"documents":[-1,1]}}}}},{"$project":{"_id":1,"name":1,"salary":1,"movingAvgSalary":1}}],"pipelineFormatted":"[\n  {\n    \"$setWindowFields\": {\n      \"sortBy\": {\n        \"salary\": 1\n      },\n      \"output\": {\n        \"movingAvgSalary\": {\n          \"$avg\": \"$salary\",\n          \"window\": {\n            \"documents\": [\n              -1,\n              1\n            ]\n          }\n        }\n      }\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"salary\": 1,\n      \"movingAvgSalary\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, base.data.salary AS salary, AVG(base.data.salary) OVER (ORDER BY base.data.salary ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS movingAvgSalary FROM employees base","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       base.data.salary AS salary,\n       AVG(base.data.salary) OVER (\n                                   ORDER BY base.data.salary ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS movingAvgSalary\nFROM employees base","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":null,"mongodbResults":null,"oracleResults":null},{"id":"REDUCE001","name":"$reduce - sum array elements","description":"Tests $reduce operator with sum pattern to total item prices","category":"array","categoryName":"Array Operators","operator":"$reduce","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"orderId":1,"itemTotal":{"$reduce":{"input":"$items","initialValue":0,"in":{"$add":["$$value","$$this.price"]}}}}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"itemTotal\": {\n        \"$reduce\": {\n          \"input\": \"$items\",\n          \"initialValue\": 0,\n          \"in\": {\n            \"$add\": [\n              \"$$value\",\n              \"$$this.price\"\n            ]\n          }\n        }\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, (SELECT NVL(SUM(TO_NUMBER(val)), 0) FROM JSON_TABLE(base.data, '$.items[*]' COLUMNS (val VARCHAR2(4000) PATH '$.price'))) AS itemTotal FROM sales base","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n\n  (SELECT NVL(SUM(TO_NUMBER(val)), 0)\n   FROM JSON_TABLE(base.data, '$.items[*]' COLUMNS (val VARCHAR2(4000) PATH '$.price'))) AS itemTotal\nFROM sales base","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"REDUCE002","name":"$reduce - concatenate tags","description":"Tests $reduce operator with concat pattern to join tags","category":"array","categoryName":"Array Operators","operator":"$reduce","collection":"products","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"name":1,"allTags":{"$reduce":{"input":"$tags","initialValue":"","in":{"$concat":["$$value","$$this"]}}}}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"allTags\": {\n        \"$reduce\": {\n          \"input\": \"$tags\",\n          \"initialValue\": \"\",\n          \"in\": {\n            \"$concat\": [\n              \"$$value\",\n              \"$$this\"\n            ]\n          }\n        }\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, (SELECT LISTAGG(val, '') WITHIN GROUP (ORDER BY ROWNUM) FROM JSON_TABLE(base.data, '$.tags[*]' COLUMNS (val VARCHAR2(4000) PATH '$'))) AS allTags FROM products base","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n\n  (SELECT LISTAGG(val, '') WITHIN GROUP (\n                                         ORDER BY ROWNUM)\n   FROM JSON_TABLE(base.data, '$.tags[*]' COLUMNS (val VARCHAR2(4000) PATH '$'))) AS allTags\nFROM products base","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":"name","mongodbResults":null,"oracleResults":null},{"id":"GRAPHLOOKUP002","name":"$graphLookup - recursive hierarchy","description":"Tests $graphLookup with recursive depth for hierarchical data traversal","category":"graphLookup","categoryName":"Graph Lookup","operator":"$graphLookup","collection":"employees","skip":true,"skipReason":"","testSuite":"query","pipeline":[{"$graphLookup":{"from":"employees","startWith":"$_id","connectFromField":"reportsTo","connectToField":"_id","as":"reportingChain","maxDepth":3,"depthField":"depth"}},{"$project":{"_id":1,"name":1,"reportingChain":1}}],"pipelineFormatted":"[\n  {\n    \"$graphLookup\": {\n      \"from\": \"employees\",\n      \"startWith\": \"$_id\",\n      \"connectFromField\": \"reportsTo\",\n      \"connectToField\": \"_id\",\n      \"as\": \"reportingChain\",\n      \"maxDepth\": 3,\n      \"depthField\": \"depth\"\n    }\n  },\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"name\": 1,\n      \"reportingChain\": 1\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.name AS name, base.data.reportingChain AS reportingChain, reportingChain_cte.reportingChain AS reportingChain, reportingChain_cte.depth AS depth FROM employees base LEFT OUTER JOIN LATERAL (SELECT CAST(NULL AS JSON) AS reportingChain, NULL AS depth FROM DUAL WHERE 1=0) reportingChain_cte ON 1=1","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.name AS name,\n       base.data.reportingChain AS reportingChain,\n       reportingChain_cte.reportingChain AS reportingChain,\n       reportingChain_cte.depth AS depth\nFROM employees base\nLEFT OUTER JOIN LATERAL\n  (SELECT CAST(NULL AS JSON) AS reportingChain,\n          NULL AS depth\n   FROM DUAL\n   WHERE 1=0) reportingChain_cte ON 1=1","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":0,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"ARR015","name":"$filter on field path array","description":"Tests $filter operator with field path array input - supported case","category":"array","categoryName":"Array Operators","operator":"$filter","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"orderId":1,"expensiveItems":{"$filter":{"input":"$items","as":"item","cond":{"$gte":["$$item.price",100]}}}}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"expensiveItems\": {\n        \"$filter\": {\n          \"input\": \"$items\",\n          \"as\": \"item\",\n          \"cond\": {\n            \"$gte\": [\n              \"$$item.price\",\n              100\n            ]\n          }\n        }\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, (SELECT COALESCE(JSON_ARRAYAGG(val FORMAT JSON), JSON_ARRAY()) FROM JSON_TABLE(base.data, '$.items[*]' COLUMNS (val VARCHAR2(4000) FORMAT JSON PATH '$', price NUMBER PATH '$.price')) WHERE price >= 100) AS expensiveItems FROM sales base","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n\n  (SELECT COALESCE(JSON_ARRAYAGG(val FORMAT JSON), JSON_ARRAY())\n   FROM JSON_TABLE(base.data, '$.items[*]' COLUMNS (val VARCHAR2(4000) FORMAT JSON PATH '$', price NUMBER PATH '$.price'))\n   WHERE price >= 100) AS expensiveItems\nFROM sales base","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null},{"id":"ARR016","name":"$map on field path array","description":"Tests $map operator with field path array input - supported case","category":"array","categoryName":"Array Operators","operator":"$map","collection":"sales","skip":false,"skipReason":"","testSuite":"query","pipeline":[{"$project":{"_id":1,"orderId":1,"productNames":{"$map":{"input":"$items","as":"item","in":"$$item.product"}}}}],"pipelineFormatted":"[\n  {\n    \"$project\": {\n      \"_id\": 1,\n      \"orderId\": 1,\n      \"productNames\": {\n        \"$map\": {\n          \"input\": \"$items\",\n          \"as\": \"item\",\n          \"in\": \"$$item.product\"\n        }\n      }\n    }\n  }\n]","sql":"SELECT base.data.\"_id\" AS \"_id\", base.data.orderId AS orderId, (SELECT COALESCE(JSON_ARRAYAGG(product), JSON_ARRAY()) FROM JSON_TABLE(base.data, '$.items[*]' COLUMNS (product VARCHAR2(4000) PATH '$.product'))) AS productNames FROM sales base","sqlFormatted":"SELECT base.data.\"_id\" AS \"_id\",\n       base.data.orderId AS orderId,\n\n  (SELECT COALESCE(JSON_ARRAYAGG(product), JSON_ARRAY())\n   FROM JSON_TABLE(base.data, '$.items[*]' COLUMNS (product VARCHAR2(4000) PATH '$.product'))) AS productNames\nFROM sales base","sqlError":null,"status":"N/A","matchType":"","mongodbCount":"N/A","oracleCount":"N/A","expectedCount":10,"comparisonResult":"","sortBy":"_id","mongodbResults":null,"oracleResults":null}]},"large_scale":{"name":"Large-Scale Pipeline Tests","description":"Complex aggregations on large datasets (~4GB)","tests":[{"id":"PIPE001","name":"E-commerce Order Revenue Analysis","description":"Order-level revenue analysis by status and time period (without array unwinding)","category":"large_scale","categoryName":"Large-Scale Pipelines","operator":"complex","collection":"ecommerce_orders","skip":false,"testSuite":"large_scale","pipeline":[{"$match":{"status":{"$in":["delivered","shipped"]}}},{"$group":{"_id":{"status":"$status","month":{"$month":"$timestamps.createdAt"},"year":{"$year":"$timestamps.createdAt"}},"totalRevenue":{"$sum":"$pricing.subtotal"},"orderCount":{"$sum":1},"avgShipping":{"$avg":"$pricing.shipping"},"avgTax":{"$avg":"$pricing.tax"}}},{"$addFields":{"avgRevenuePerOrder":{"$round":[{"$divide":["$totalRevenue","$orderCount"]},2]}}},{"$sort":{"totalRevenue":-1}},{"$limit":50}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"status\": {\n        \"$in\": [\n          \"delivered\",\n          \"shipped\"\n        ]\n      }\n    }\n  },\n  {\n    \"$group\": {\n      \"_id\": {\n        \"status\": \"$status\",\n        \"month\": {\n          \"$month\": \"$timestamps.createdAt\"\n        },\n        \"year\": {\n          \"$year\": \"$timestamps.createdAt\"\n        }\n      },\n      \"totalRevenue\": {\n        \"$sum\": \"$pricing.subtotal\"\n      },\n      \"orderCount\": {\n        \"$sum\": 1\n      },\n      \"avgShipping\": {\n        \"$avg\": \"$pricing.shipping\"\n      },\n      \"avgTax\": {\n        \"$avg\": \"$pricing.tax\"\n      }\n    }\n  },\n  {\n    \"$addFields\": {\n      \"avgRevenuePerOrder\": {\n        \"$round\": [\n          {\n            \"$divide\": [\n              \"$totalRevenue\",\n              \"$orderCount\"\n            ]\n          },\n          2\n        ]\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"totalRevenue\": -1\n    }\n  },\n  {\n    \"$limit\": 50\n  }\n]","sql":"SELECT inner_query.*, ROUND((totalRevenue / orderCount), 2) AS avgRevenuePerOrder FROM (SELECT base.data.status AS status, EXTRACT(MONTH FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.timestamps.createdAt'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"')) AS month, EXTRACT(YEAR FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.timestamps.createdAt'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"')) AS year, SUM(base.data.pricing.subtotal) AS totalRevenue, SUM(1) AS orderCount, AVG(base.data.pricing.shipping) AS avgShipping, AVG(base.data.pricing.tax) AS avgTax FROM ecommerce_orders base WHERE base.data.status IN ('delivered', 'shipped') GROUP BY base.data.status, EXTRACT(MONTH FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.timestamps.createdAt'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"')), EXTRACT(YEAR FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.timestamps.createdAt'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"'))) inner_query ORDER BY totalRevenue DESC FETCH FIRST 50 ROWS ONLY","sqlFormatted":"SELECT inner_query.*,\n       ROUND((totalRevenue / orderCount), 2) AS avgRevenuePerOrder\nFROM\n  (SELECT base.data.status AS status,\n          EXTRACT(MONTH\n                  FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.timestamps.createdAt'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"')) AS MONTH,\n          EXTRACT(YEAR\n                  FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.timestamps.createdAt'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"')) AS YEAR,\n          SUM(base.data.pricing.subtotal) AS totalRevenue,\n          SUM(1) AS orderCount,\n          AVG(base.data.pricing.shipping) AS avgShipping,\n          AVG(base.data.pricing.tax) AS avgTax\n   FROM ecommerce_orders base\n   WHERE base.data.status IN ('delivered',\n                              'shipped')\n   GROUP BY base.data.status,\n            EXTRACT(MONTH\n                    FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.timestamps.createdAt'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"')),\n            EXTRACT(YEAR\n                    FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.timestamps.createdAt'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"'))) inner_query\nORDER BY totalRevenue DESC FETCH FIRST 50 ROWS ONLY","sqlError":null,"status":"PASS","mongodbCount":"50","oracleCount":"50","expectedCount":0,"comparisonResult":"","mongodbResults":[{"_id":{"status":"shipped","month":11,"year":2023},"totalRevenue":222924.42,"orderCount":50,"avgShipping":12.8856,"avgTax":274.71543465999997,"avgRevenuePerOrder":4458.49},{"_id":{"status":"delivered","month":10,"year":2022},"totalRevenue":215678.83,"orderCount":45,"avgShipping":11.752666666666666,"avgTax":288.30467508888887,"avgRevenuePerOrder":4792.86},{"_id":{"status":"shipped","month":2,"year":2024},"totalRevenue":215055.02000000002,"orderCount":45,"avgShipping":14.584444444444443,"avgTax":308.7146384888889,"avgRevenuePerOrder":4779},{"_id":{"status":"delivered","month":2,"year":2024},"totalRevenue":213027.99,"orderCount":46,"avgShipping":14.143478260869566,"avgTax":279.73724030434784,"avgRevenuePerOrder":4631.04},{"_id":{"status":"delivered","month":8,"year":2023},"totalRevenue":212723.3,"orderCount":49,"avgShipping":12.959795918367346,"avgTax":263.08887500000003,"avgRevenuePerOrder":4341.29}],"oracleResults":[{"_id":{"status":"shipped","month":11,"year":2023},"totalRevenue":222924.42,"orderCount":50,"avgShipping":12.8856,"avgTax":274.71543465999997,"avgRevenuePerOrder":4458.49},{"_id":{"status":"delivered","month":10,"year":2022},"totalRevenue":215678.83,"orderCount":45,"avgShipping":11.752666666666666,"avgTax":288.30467508888887,"avgRevenuePerOrder":4792.86},{"_id":{"status":"shipped","month":2,"year":2024},"totalRevenue":215055.02000000002,"orderCount":45,"avgShipping":14.584444444444443,"avgTax":308.7146384888889,"avgRevenuePerOrder":4779},{"_id":{"status":"delivered","month":2,"year":2024},"totalRevenue":213027.99,"orderCount":46,"avgShipping":14.143478260869566,"avgTax":279.73724030434784,"avgRevenuePerOrder":4631.04},{"_id":{"status":"delivered","month":8,"year":2023},"totalRevenue":212723.3,"orderCount":49,"avgShipping":12.959795918367346,"avgTax":263.08887500000003,"avgRevenuePerOrder":4341.29}],"mongodbTime":0,"oracleTime":0},{"id":"PIPE002","name":"Product Performance Analysis","description":"Analyze all products by category and brand with rating metrics (without array unwinding)","category":"large_scale","categoryName":"Large-Scale Pipelines","operator":"complex","collection":"ecommerce_products","skip":false,"testSuite":"large_scale","pipeline":[{"$group":{"_id":{"category":"$category.primary","brand":"$brand.name"},"productCount":{"$sum":1},"avgRating":{"$avg":"$ratings.average"},"totalReviews":{"$sum":"$ratings.count"},"avgPrice":{"$avg":"$pricing.basePrice"},"minPrice":{"$min":"$pricing.basePrice"},"maxPrice":{"$max":"$pricing.basePrice"}}},{"$addFields":{"priceRange":{"$round":[{"$subtract":["$maxPrice","$minPrice"]},2]}}},{"$sort":{"totalReviews":-1}},{"$limit":30}],"pipelineFormatted":"[\n  {\n    \"$group\": {\n      \"_id\": {\n        \"category\": \"$category.primary\",\n        \"brand\": \"$brand.name\"\n      },\n      \"productCount\": {\n        \"$sum\": 1\n      },\n      \"avgRating\": {\n        \"$avg\": \"$ratings.average\"\n      },\n      \"totalReviews\": {\n        \"$sum\": \"$ratings.count\"\n      },\n      \"avgPrice\": {\n        \"$avg\": \"$pricing.basePrice\"\n      },\n      \"minPrice\": {\n        \"$min\": \"$pricing.basePrice\"\n      },\n      \"maxPrice\": {\n        \"$max\": \"$pricing.basePrice\"\n      }\n    }\n  },\n  {\n    \"$addFields\": {\n      \"priceRange\": {\n        \"$round\": [\n          {\n            \"$subtract\": [\n              \"$maxPrice\",\n              \"$minPrice\"\n            ]\n          },\n          2\n        ]\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"totalReviews\": -1\n    }\n  },\n  {\n    \"$limit\": 30\n  }\n]","sql":"SELECT inner_query.*, ROUND((maxPrice - minPrice), 2) AS priceRange FROM (SELECT base.data.category.primary AS category, base.data.brand.name AS brand, SUM(1) AS productCount, AVG(base.data.ratings.average) AS avgRating, SUM(base.data.ratings.count) AS totalReviews, AVG(base.data.pricing.basePrice) AS avgPrice, MIN(base.data.pricing.basePrice) AS minPrice, MAX(base.data.pricing.basePrice) AS maxPrice FROM ecommerce_products base GROUP BY base.data.category.primary, base.data.brand.name) inner_query ORDER BY totalReviews DESC FETCH FIRST 30 ROWS ONLY","sqlFormatted":"SELECT inner_query.*,\n       ROUND((maxPrice - minPrice), 2) AS priceRange\nFROM\n  (SELECT base.data.category.primary AS category,\n          base.data.brand.name AS brand,\n          SUM(1) AS productCount,\n          AVG(base.data.ratings.average) AS avgRating,\n          SUM(base.data.ratings.count) AS totalReviews,\n          AVG(base.data.pricing.basePrice) AS avgPrice,\n          MIN(base.data.pricing.basePrice) AS minPrice,\n          MAX(base.data.pricing.basePrice) AS maxPrice\n   FROM ecommerce_products base\n   GROUP BY base.data.category.primary,\n            base.data.brand.name) inner_query\nORDER BY totalReviews DESC FETCH FIRST 30 ROWS ONLY","sqlError":null,"status":"PASS","mongodbCount":"30","oracleCount":"30","expectedCount":0,"comparisonResult":"","mongodbResults":[{"_id":{"category":"Sports","brand":"PremiumLine"},"productCount":17,"avgRating":2.9176470588235297,"totalReviews":97326,"avgPrice":504.3729411764706,"minPrice":40.58,"maxPrice":924.11,"priceRange":883.53},{"_id":{"category":"Home & Garden","brand":"StyleMax"},"productCount":15,"avgRating":2.5866666666666664,"totalReviews":80228,"avgPrice":555.634,"minPrice":217.84,"maxPrice":939.94,"priceRange":722.1},{"_id":{"category":"Clothing","brand":"ValueBrand"},"productCount":12,"avgRating":2.983333333333333,"totalReviews":77001,"avgPrice":479.24499999999995,"minPrice":182.33,"maxPrice":846.26,"priceRange":663.93},{"_id":{"category":"Toys","brand":"StyleMax"},"productCount":15,"avgRating":3.06,"totalReviews":76857,"avgPrice":665.5893333333333,"minPrice":362.37,"maxPrice":975.84,"priceRange":613.47},{"_id":{"category":"Home & Garden","brand":"SmartBuy"},"productCount":14,"avgRating":3.2285714285714286,"totalReviews":75443,"avgPrice":477.4035714285714,"minPrice":50.09,"maxPrice":907.2,"priceRange":857.11}],"oracleResults":[{"_id":{"category":"Sports","brand":"PremiumLine"},"productCount":17,"avgRating":2.9176470588235297,"totalReviews":97326,"avgPrice":504.3729411764706,"minPrice":40.58,"maxPrice":924.11,"priceRange":883.53},{"_id":{"category":"Home & Garden","brand":"StyleMax"},"productCount":15,"avgRating":2.5866666666666664,"totalReviews":80228,"avgPrice":555.634,"minPrice":217.84,"maxPrice":939.94,"priceRange":722.1},{"_id":{"category":"Clothing","brand":"ValueBrand"},"productCount":12,"avgRating":2.983333333333333,"totalReviews":77001,"avgPrice":479.24499999999995,"minPrice":182.33,"maxPrice":846.26,"priceRange":663.93},{"_id":{"category":"Toys","brand":"StyleMax"},"productCount":15,"avgRating":3.06,"totalReviews":76857,"avgPrice":665.5893333333333,"minPrice":362.37,"maxPrice":975.84,"priceRange":613.47},{"_id":{"category":"Home & Garden","brand":"SmartBuy"},"productCount":14,"avgRating":3.2285714285714286,"totalReviews":75443,"avgPrice":477.4035714285714,"minPrice":50.09,"maxPrice":907.2,"priceRange":857.11}],"mongodbTime":0,"oracleTime":0},{"id":"PIPE003","name":"Customer Lifetime Value Analysis","description":"Calculate customer value with loyalty tier analysis and purchase patterns","category":"large_scale","categoryName":"Large-Scale Pipelines","operator":"complex","collection":"ecommerce_customers","skip":false,"testSuite":"large_scale","pipeline":[{"$match":{"metadata.status":"active","orderHistory.totalOrders":{"$gte":1}}},{"$group":{"_id":"$loyalty.tier","customerCount":{"$sum":1},"avgTotalSpent":{"$avg":"$orderHistory.totalSpent"},"avgTotalOrders":{"$avg":"$orderHistory.totalOrders"},"avgOrderValue":{"$avg":"$orderHistory.averageOrderValue"},"avgReturnRate":{"$avg":"$orderHistory.returnRate"}}},{"$addFields":{"avgReturnRatePercent":{"$round":[{"$multiply":["$avgReturnRate",100]},1]}}},{"$sort":{"avgTotalSpent":-1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"metadata.status\": \"active\",\n      \"orderHistory.totalOrders\": {\n        \"$gte\": 1\n      }\n    }\n  },\n  {\n    \"$group\": {\n      \"_id\": \"$loyalty.tier\",\n      \"customerCount\": {\n        \"$sum\": 1\n      },\n      \"avgTotalSpent\": {\n        \"$avg\": \"$orderHistory.totalSpent\"\n      },\n      \"avgTotalOrders\": {\n        \"$avg\": \"$orderHistory.totalOrders\"\n      },\n      \"avgOrderValue\": {\n        \"$avg\": \"$orderHistory.averageOrderValue\"\n      },\n      \"avgReturnRate\": {\n        \"$avg\": \"$orderHistory.returnRate\"\n      }\n    }\n  },\n  {\n    \"$addFields\": {\n      \"avgReturnRatePercent\": {\n        \"$round\": [\n          {\n            \"$multiply\": [\n              \"$avgReturnRate\",\n              100\n            ]\n          },\n          1\n        ]\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"avgTotalSpent\": -1\n    }\n  }\n]","sql":"SELECT inner_query.*, ROUND((avgReturnRate * 100), 1) AS avgReturnRatePercent FROM (SELECT base.data.loyalty.tier AS \"_id\", SUM(1) AS customerCount, AVG(base.data.orderHistory.totalSpent) AS avgTotalSpent, AVG(base.data.orderHistory.totalOrders) AS avgTotalOrders, AVG(base.data.orderHistory.averageOrderValue) AS avgOrderValue, AVG(base.data.orderHistory.returnRate) AS avgReturnRate FROM ecommerce_customers base WHERE (base.data.metadata.status = 'active') AND (CAST(base.data.orderHistory.totalOrders AS NUMBER) >= 1) GROUP BY base.data.loyalty.tier) inner_query ORDER BY avgTotalSpent DESC","sqlFormatted":"SELECT inner_query.*,\n       ROUND((avgReturnRate * 100), 1) AS avgReturnRatePercent\nFROM\n  (SELECT base.data.loyalty.tier AS \"_id\",\n          SUM(1) AS customerCount,\n          AVG(base.data.orderHistory.totalSpent) AS avgTotalSpent,\n          AVG(base.data.orderHistory.totalOrders) AS avgTotalOrders,\n          AVG(base.data.orderHistory.averageOrderValue) AS avgOrderValue,\n          AVG(base.data.orderHistory.returnRate) AS avgReturnRate\n   FROM ecommerce_customers base\n   WHERE (base.data.metadata.status = 'active')\n     AND (CAST(base.data.orderHistory.totalOrders AS NUMBER) >= 1)\n   GROUP BY base.data.loyalty.tier) inner_query\nORDER BY avgTotalSpent DESC","sqlError":null,"status":"PASS","mongodbCount":"5","oracleCount":"5","expectedCount":0,"comparisonResult":"","mongodbResults":[{"_id":"platinum","customerCount":99,"avgTotalSpent":26872.258484848484,"avgTotalOrders":102.34343434343434,"avgOrderValue":245.95929292929293,"avgReturnRate":0.12723232323232322,"avgReturnRatePercent":12.7},{"_id":"silver","customerCount":91,"avgTotalSpent":26494.88626373626,"avgTotalOrders":93.91208791208791,"avgOrderValue":260.9679120879121,"avgReturnRate":0.15378021978021977,"avgReturnRatePercent":15.4},{"_id":"diamond","customerCount":90,"avgTotalSpent":25945.571222222225,"avgTotalOrders":87.73333333333333,"avgOrderValue":256.036,"avgReturnRate":0.14121111111111112,"avgReturnRatePercent":14.1},{"_id":"gold","customerCount":108,"avgTotalSpent":25372.45574074074,"avgTotalOrders":98.08333333333333,"avgOrderValue":284.2494444444444,"avgReturnRate":0.16980555555555554,"avgReturnRatePercent":17},{"_id":"bronze","customerCount":104,"avgTotalSpent":24983.591634615383,"avgTotalOrders":103.00961538461539,"avgOrderValue":272.50701923076923,"avgReturnRate":0.13884615384615384,"avgReturnRatePercent":13.9}],"oracleResults":[{"_id":"platinum","customerCount":99,"avgTotalSpent":26872.258484848484,"avgTotalOrders":102.34343434343434,"avgOrderValue":245.95929292929293,"avgReturnRate":0.12723232323232322,"avgReturnRatePercent":12.7},{"_id":"silver","customerCount":91,"avgTotalSpent":26494.88626373626,"avgTotalOrders":93.91208791208791,"avgOrderValue":260.9679120879121,"avgReturnRate":0.15378021978021977,"avgReturnRatePercent":15.4},{"_id":"diamond","customerCount":90,"avgTotalSpent":25945.571222222225,"avgTotalOrders":87.73333333333333,"avgOrderValue":256.036,"avgReturnRate":0.14121111111111112,"avgReturnRatePercent":14.1},{"_id":"gold","customerCount":108,"avgTotalSpent":25372.45574074074,"avgTotalOrders":98.08333333333333,"avgOrderValue":284.2494444444444,"avgReturnRate":0.16980555555555554,"avgReturnRatePercent":17},{"_id":"bronze","customerCount":104,"avgTotalSpent":24983.591634615383,"avgTotalOrders":103.00961538461539,"avgOrderValue":272.50701923076923,"avgReturnRate":0.13884615384615384,"avgReturnRatePercent":13.9}],"mongodbTime":0,"oracleTime":0},{"id":"PIPE004","name":"Review Sentiment and Quality Analysis","description":"Analyze review quality with aspect ratings and helpfulness metrics","category":"large_scale","categoryName":"Large-Scale Pipelines","operator":"complex","collection":"ecommerce_reviews","skip":false,"testSuite":"large_scale","pipeline":[{"$match":{"metadata.status":"published","verified":true}},{"$group":{"_id":{"sentiment":"$metadata.sentiment"},"reviewCount":{"$sum":1},"avgOverallRating":{"$avg":"$rating.overall"},"avgQualityRating":{"$avg":"$rating.aspects.quality"},"avgValueRating":{"$avg":"$rating.aspects.value"},"avgShippingRating":{"$avg":"$rating.aspects.shipping"},"avgPackagingRating":{"$avg":"$rating.aspects.packaging"},"totalUpvotes":{"$sum":"$helpful.upvotes"},"totalDownvotes":{"$sum":"$helpful.downvotes"}}},{"$addFields":{"helpfulnessRatio":{"$round":[{"$cond":[{"$gt":[{"$add":["$totalUpvotes","$totalDownvotes"]},0]},{"$divide":["$totalUpvotes",{"$add":["$totalUpvotes","$totalDownvotes"]}]},0]},2]}}},{"$sort":{"reviewCount":-1}},{"$limit":40}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"metadata.status\": \"published\",\n      \"verified\": true\n    }\n  },\n  {\n    \"$group\": {\n      \"_id\": {\n        \"sentiment\": \"$metadata.sentiment\"\n      },\n      \"reviewCount\": {\n        \"$sum\": 1\n      },\n      \"avgOverallRating\": {\n        \"$avg\": \"$rating.overall\"\n      },\n      \"avgQualityRating\": {\n        \"$avg\": \"$rating.aspects.quality\"\n      },\n      \"avgValueRating\": {\n        \"$avg\": \"$rating.aspects.value\"\n      },\n      \"avgShippingRating\": {\n        \"$avg\": \"$rating.aspects.shipping\"\n      },\n      \"avgPackagingRating\": {\n        \"$avg\": \"$rating.aspects.packaging\"\n      },\n      \"totalUpvotes\": {\n        \"$sum\": \"$helpful.upvotes\"\n      },\n      \"totalDownvotes\": {\n        \"$sum\": \"$helpful.downvotes\"\n      }\n    }\n  },\n  {\n    \"$addFields\": {\n      \"helpfulnessRatio\": {\n        \"$round\": [\n          {\n            \"$cond\": [\n              {\n                \"$gt\": [\n                  {\n                    \"$add\": [\n                      \"$totalUpvotes\",\n                      \"$totalDownvotes\"\n                    ]\n                  },\n                  0\n                ]\n              },\n              {\n                \"$divide\": [\n                  \"$totalUpvotes\",\n                  {\n                    \"$add\": [\n                      \"$totalUpvotes\",\n                      \"$totalDownvotes\"\n                    ]\n                  }\n                ]\n              },\n              0\n            ]\n          },\n          2\n        ]\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"reviewCount\": -1\n    }\n  },\n  {\n    \"$limit\": 40\n  }\n]","sql":"SELECT inner_query.*, ROUND(CASE WHEN (totalUpvotes + totalDownvotes) > 0 THEN (totalUpvotes / (totalUpvotes + totalDownvotes)) ELSE 0 END, 2) AS helpfulnessRatio FROM (SELECT base.data.metadata.sentiment AS sentiment, SUM(1) AS reviewCount, AVG(base.data.rating.overall) AS avgOverallRating, AVG(base.data.rating.aspects.quality) AS avgQualityRating, AVG(base.data.rating.aspects.value) AS avgValueRating, AVG(base.data.rating.aspects.shipping) AS avgShippingRating, AVG(base.data.rating.aspects.packaging) AS avgPackagingRating, SUM(base.data.helpful.upvotes) AS totalUpvotes, SUM(base.data.helpful.downvotes) AS totalDownvotes FROM ecommerce_reviews base WHERE (base.data.metadata.status = 'published') AND (base.data.verified = true) GROUP BY base.data.metadata.sentiment) inner_query ORDER BY reviewCount DESC FETCH FIRST 40 ROWS ONLY","sqlFormatted":"SELECT inner_query.*,\n       ROUND(CASE\n                 WHEN (totalUpvotes + totalDownvotes) > 0 THEN (totalUpvotes / (totalUpvotes + totalDownvotes))\n                 ELSE 0\n             END, 2) AS helpfulnessRatio\nFROM\n  (SELECT base.data.metadata.sentiment AS sentiment,\n          SUM(1) AS reviewCount,\n          AVG(base.data.rating.overall) AS avgOverallRating,\n          AVG(base.data.rating.aspects.quality) AS avgQualityRating,\n          AVG(base.data.rating.aspects.value) AS avgValueRating,\n          AVG(base.data.rating.aspects.shipping) AS avgShippingRating,\n          AVG(base.data.rating.aspects.packaging) AS avgPackagingRating,\n          SUM(base.data.helpful.upvotes) AS totalUpvotes,\n          SUM(base.data.helpful.downvotes) AS totalDownvotes\n   FROM ecommerce_reviews base\n   WHERE (base.data.metadata.status = 'published')\n     AND (base.data.verified = TRUE)\n   GROUP BY base.data.metadata.sentiment) inner_query\nORDER BY reviewCount DESC FETCH FIRST 40 ROWS ONLY","sqlError":null,"status":"PASS","mongodbCount":"4","oracleCount":"4","expectedCount":0,"comparisonResult":"","mongodbResults":[{"_id":{"sentiment":"neutral"},"reviewCount":908,"avgOverallRating":2.944933920704846,"avgQualityRating":2.9702643171806167,"avgValueRating":2.9790748898678414,"avgShippingRating":2.951541850220264,"avgPackagingRating":2.996696035242291,"totalUpvotes":240120,"totalDownvotes":22705,"helpfulnessRatio":0.91},{"_id":{"sentiment":"positive"},"reviewCount":888,"avgOverallRating":2.9966216216216215,"avgQualityRating":2.970720720720721,"avgValueRating":2.970720720720721,"avgShippingRating":3.0472972972972974,"avgPackagingRating":3.0281531531531534,"totalUpvotes":227867,"totalDownvotes":21864,"helpfulnessRatio":0.91},{"_id":{"sentiment":"mixed"},"reviewCount":841,"avgOverallRating":3.0784780023781213,"avgQualityRating":2.972651605231867,"avgValueRating":3.0023781212841856,"avgShippingRating":3.0249702734839476,"avgPackagingRating":3.023781212841855,"totalUpvotes":213180,"totalDownvotes":21231,"helpfulnessRatio":0.91},{"_id":{"sentiment":"negative"},"reviewCount":839,"avgOverallRating":3.091775923718713,"avgQualityRating":3.00476758045292,"avgValueRating":2.924910607866508,"avgShippingRating":3.0274135876042907,"avgPackagingRating":2.941597139451728,"totalUpvotes":206283,"totalDownvotes":21442,"helpfulnessRatio":0.91}],"oracleResults":[{"_id":{"sentiment":"neutral"},"reviewCount":908,"avgOverallRating":2.944933920704846,"avgQualityRating":2.9702643171806167,"avgValueRating":2.9790748898678414,"avgShippingRating":2.951541850220264,"avgPackagingRating":2.996696035242291,"totalUpvotes":240120,"totalDownvotes":22705,"helpfulnessRatio":0.91},{"_id":{"sentiment":"positive"},"reviewCount":888,"avgOverallRating":2.9966216216216215,"avgQualityRating":2.970720720720721,"avgValueRating":2.970720720720721,"avgShippingRating":3.0472972972972974,"avgPackagingRating":3.0281531531531534,"totalUpvotes":227867,"totalDownvotes":21864,"helpfulnessRatio":0.91},{"_id":{"sentiment":"mixed"},"reviewCount":841,"avgOverallRating":3.0784780023781213,"avgQualityRating":2.972651605231867,"avgValueRating":3.0023781212841856,"avgShippingRating":3.0249702734839476,"avgPackagingRating":3.023781212841855,"totalUpvotes":213180,"totalDownvotes":21231,"helpfulnessRatio":0.91},{"_id":{"sentiment":"negative"},"reviewCount":839,"avgOverallRating":3.091775923718713,"avgQualityRating":3.00476758045292,"avgValueRating":2.924910607866508,"avgShippingRating":3.0274135876042907,"avgPackagingRating":2.941597139451728,"totalUpvotes":206283,"totalDownvotes":21442,"helpfulnessRatio":0.91}],"mongodbTime":0,"oracleTime":0},{"id":"PIPE005","name":"Analytics Session Funnel Analysis","description":"Analyze conversion funnel with device and traffic source breakdown","category":"large_scale","categoryName":"Large-Scale Pipelines","operator":"complex","collection":"analytics_sessions","skip":false,"testSuite":"large_scale","pipeline":[{"$match":{"duration":{"$gte":10}}},{"$group":{"_id":{"deviceType":"$device.type","trafficSource":"$traffic.source"},"sessionCount":{"$sum":1},"avgPageViews":{"$avg":"$engagement.pageViews"},"avgUniquePages":{"$avg":"$engagement.uniquePages"},"avgEvents":{"$avg":"$engagement.events"},"avgScrollDepth":{"$avg":"$engagement.scrollDepth"},"avgDuration":{"$avg":"$duration"},"conversions":{"$sum":{"$cond":["$conversion.converted",1,0]}},"totalRevenue":{"$sum":"$conversion.revenue"},"totalTransactions":{"$sum":"$conversion.transactions"},"bounceCount":{"$sum":{"$cond":["$bounced",1,0]}},"newUserCount":{"$sum":{"$cond":["$isNewUser",1,0]}}}},{"$addFields":{"conversionRate":{"$round":[{"$multiply":[{"$divide":["$conversions","$sessionCount"]},100]},2]},"bounceRate":{"$round":[{"$multiply":[{"$divide":["$bounceCount","$sessionCount"]},100]},2]},"newUserRate":{"$round":[{"$multiply":[{"$divide":["$newUserCount","$sessionCount"]},100]},2]},"avgRevenuePerSession":{"$round":[{"$divide":["$totalRevenue","$sessionCount"]},2]}}},{"$sort":{"conversionRate":-1,"sessionCount":-1}},{"$limit":30}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"duration\": {\n        \"$gte\": 10\n      }\n    }\n  },\n  {\n    \"$group\": {\n      \"_id\": {\n        \"deviceType\": \"$device.type\",\n        \"trafficSource\": \"$traffic.source\"\n      },\n      \"sessionCount\": {\n        \"$sum\": 1\n      },\n      \"avgPageViews\": {\n        \"$avg\": \"$engagement.pageViews\"\n      },\n      \"avgUniquePages\": {\n        \"$avg\": \"$engagement.uniquePages\"\n      },\n      \"avgEvents\": {\n        \"$avg\": \"$engagement.events\"\n      },\n      \"avgScrollDepth\": {\n        \"$avg\": \"$engagement.scrollDepth\"\n      },\n      \"avgDuration\": {\n        \"$avg\": \"$duration\"\n      },\n      \"conversions\": {\n        \"$sum\": {\n          \"$cond\": [\n            \"$conversion.converted\",\n            1,\n            0\n          ]\n        }\n      },\n      \"totalRevenue\": {\n        \"$sum\": \"$conversion.revenue\"\n      },\n      \"totalTransactions\": {\n        \"$sum\": \"$conversion.transactions\"\n      },\n      \"bounceCount\": {\n        \"$sum\": {\n          \"$cond\": [\n            \"$bounced\",\n            1,\n            0\n          ]\n        }\n      },\n      \"newUserCount\": {\n        \"$sum\": {\n          \"$cond\": [\n            \"$isNewUser\",\n            1,\n            0\n          ]\n        }\n      }\n    }\n  },\n  {\n    \"$addFields\": {\n      \"conversionRate\": {\n        \"$round\": [\n          {\n            \"$multiply\": [\n              {\n                \"$divide\": [\n                  \"$conversions\",\n                  \"$sessionCount\"\n                ]\n              },\n              100\n            ]\n          },\n          2\n        ]\n      },\n      \"bounceRate\": {\n        \"$round\": [\n          {\n            \"$multiply\": [\n              {\n                \"$divide\": [\n                  \"$bounceCount\",\n                  \"$sessionCount\"\n                ]\n              },\n              100\n            ]\n          },\n          2\n        ]\n      },\n      \"newUserRate\": {\n        \"$round\": [\n          {\n            \"$multiply\": [\n              {\n                \"$divide\": [\n                  \"$newUserCount\",\n                  \"$sessionCount\"\n                ]\n              },\n              100\n            ]\n          },\n          2\n        ]\n      },\n      \"avgRevenuePerSession\": {\n        \"$round\": [\n          {\n            \"$divide\": [\n              \"$totalRevenue\",\n              \"$sessionCount\"\n            ]\n          },\n          2\n        ]\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"conversionRate\": -1,\n      \"sessionCount\": -1\n    }\n  },\n  {\n    \"$limit\": 30\n  }\n]","sql":"SELECT inner_query.*, ROUND(((conversions / sessionCount) * 100), 2) AS conversionRate, ROUND(((bounceCount / sessionCount) * 100), 2) AS bounceRate, ROUND(((newUserCount / sessionCount) * 100), 2) AS newUserRate, ROUND((totalRevenue / sessionCount), 2) AS avgRevenuePerSession FROM (SELECT base.data.device.type AS deviceType, base.data.traffic.source AS trafficSource, SUM(1) AS sessionCount, AVG(base.data.engagement.pageViews) AS avgPageViews, AVG(base.data.engagement.uniquePages) AS avgUniquePages, AVG(base.data.engagement.events) AS avgEvents, AVG(base.data.engagement.scrollDepth) AS avgScrollDepth, AVG(base.data.duration) AS avgDuration, SUM(CASE WHEN base.data.conversion.converted THEN 1 ELSE 0 END) AS conversions, SUM(base.data.conversion.revenue) AS totalRevenue, SUM(base.data.conversion.transactions) AS totalTransactions, SUM(CASE WHEN base.data.bounced THEN 1 ELSE 0 END) AS bounceCount, SUM(CASE WHEN base.data.isNewUser THEN 1 ELSE 0 END) AS newUserCount FROM analytics_sessions base WHERE CAST(base.data.duration AS NUMBER) >= 10 GROUP BY base.data.device.type, base.data.traffic.source) inner_query ORDER BY conversionRate DESC, sessionCount DESC FETCH FIRST 30 ROWS ONLY","sqlFormatted":"SELECT inner_query.*,\n       ROUND(((conversions / sessionCount) * 100), 2) AS conversionRate,\n       ROUND(((bounceCount / sessionCount) * 100), 2) AS bounceRate,\n       ROUND(((newUserCount / sessionCount) * 100), 2) AS newUserRate,\n       ROUND((totalRevenue / sessionCount), 2) AS avgRevenuePerSession\nFROM\n  (SELECT base.data.device.type AS deviceType,\n          base.data.traffic.source AS trafficSource,\n          SUM(1) AS sessionCount,\n          AVG(base.data.engagement.pageViews) AS avgPageViews,\n          AVG(base.data.engagement.uniquePages) AS avgUniquePages,\n          AVG(base.data.engagement.events) AS avgEvents,\n          AVG(base.data.engagement.scrollDepth) AS avgScrollDepth,\n          AVG(base.data.duration) AS avgDuration,\n          SUM(CASE\n                  WHEN base.data.conversion.converted THEN 1\n                  ELSE 0\n              END) AS conversions,\n          SUM(base.data.conversion.revenue) AS totalRevenue,\n          SUM(base.data.conversion.transactions) AS totalTransactions,\n          SUM(CASE\n                  WHEN base.data.bounced THEN 1\n                  ELSE 0\n              END) AS bounceCount,\n          SUM(CASE\n                  WHEN base.data.isNewUser THEN 1\n                  ELSE 0\n              END) AS newUserCount\n   FROM analytics_sessions base\n   WHERE CAST(base.data.duration AS NUMBER) >= 10\n   GROUP BY base.data.device.type,\n            base.data.traffic.source) inner_query\nORDER BY conversionRate DESC,\n         sessionCount DESC FETCH FIRST 30 ROWS ONLY","sqlError":null,"status":"PASS","mongodbCount":"30","oracleCount":"30","expectedCount":0,"comparisonResult":"","mongodbResults":[{"_id":{"deviceType":"smart_tv","trafficSource":"direct"},"sessionCount":330,"avgPageViews":25.912121212121214,"avgUniquePages":10.157575757575758,"avgEvents":49.912121212121214,"avgScrollDepth":48.36363636363637,"avgDuration":1760.590909090909,"conversions":52,"totalRevenue":8747.62,"totalTransactions":91,"bounceCount":121,"newUserCount":102,"conversionRate":15.76,"bounceRate":36.67,"newUserRate":30.91,"avgRevenuePerSession":26.51},{"_id":{"deviceType":"console","trafficSource":"social"},"sessionCount":358,"avgPageViews":25.324022346368714,"avgUniquePages":10.614525139664805,"avgEvents":51.02513966480447,"avgScrollDepth":48.745810055865924,"avgDuration":1789.5055865921788,"conversions":45,"totalRevenue":4636.6,"totalTransactions":72,"bounceCount":149,"newUserCount":99,"conversionRate":12.57,"bounceRate":41.62,"newUserRate":27.65,"avgRevenuePerSession":12.95},{"_id":{"deviceType":"smart_tv","trafficSource":"social"},"sessionCount":305,"avgPageViews":25.898360655737704,"avgUniquePages":10.036065573770491,"avgEvents":53.83934426229508,"avgScrollDepth":46.71475409836066,"avgDuration":1787.8524590163934,"conversions":38,"totalRevenue":7687.77,"totalTransactions":58,"bounceCount":114,"newUserCount":98,"conversionRate":12.46,"bounceRate":37.38,"newUserRate":32.13,"avgRevenuePerSession":25.21},{"_id":{"deviceType":"smart_tv","trafficSource":"referral"},"sessionCount":336,"avgPageViews":24.985119047619047,"avgUniquePages":10.241071428571429,"avgEvents":47.732142857142854,"avgScrollDepth":50.666666666666664,"avgDuration":1844.8333333333333,"conversions":38,"totalRevenue":9244.04,"totalTransactions":67,"bounceCount":134,"newUserCount":98,"conversionRate":11.31,"bounceRate":39.88,"newUserRate":29.17,"avgRevenuePerSession":27.51},{"_id":{"deviceType":"console","trafficSource":"email"},"sessionCount":355,"avgPageViews":26.185915492957747,"avgUniquePages":10.447887323943663,"avgEvents":53.59718309859155,"avgScrollDepth":50.96338028169014,"avgDuration":1776.3859154929578,"conversions":40,"totalRevenue":9587.619999999999,"totalTransactions":73,"bounceCount":159,"newUserCount":104,"conversionRate":11.27,"bounceRate":44.79,"newUserRate":29.3,"avgRevenuePerSession":27.01}],"oracleResults":[{"_id":{"deviceType":"smart_tv","trafficSource":"direct"},"sessionCount":330,"avgPageViews":25.912121212121214,"avgUniquePages":10.157575757575758,"avgEvents":49.912121212121214,"avgScrollDepth":48.36363636363637,"avgDuration":1760.590909090909,"conversions":52,"totalRevenue":8747.62,"totalTransactions":91,"bounceCount":121,"newUserCount":102,"conversionRate":15.76,"bounceRate":36.67,"newUserRate":30.91,"avgRevenuePerSession":26.51},{"_id":{"deviceType":"console","trafficSource":"social"},"sessionCount":358,"avgPageViews":25.324022346368714,"avgUniquePages":10.614525139664805,"avgEvents":51.02513966480447,"avgScrollDepth":48.745810055865924,"avgDuration":1789.5055865921788,"conversions":45,"totalRevenue":4636.6,"totalTransactions":72,"bounceCount":149,"newUserCount":99,"conversionRate":12.57,"bounceRate":41.62,"newUserRate":27.65,"avgRevenuePerSession":12.95},{"_id":{"deviceType":"smart_tv","trafficSource":"social"},"sessionCount":305,"avgPageViews":25.898360655737704,"avgUniquePages":10.036065573770491,"avgEvents":53.83934426229508,"avgScrollDepth":46.71475409836066,"avgDuration":1787.8524590163934,"conversions":38,"totalRevenue":7687.77,"totalTransactions":58,"bounceCount":114,"newUserCount":98,"conversionRate":12.46,"bounceRate":37.38,"newUserRate":32.13,"avgRevenuePerSession":25.21},{"_id":{"deviceType":"smart_tv","trafficSource":"referral"},"sessionCount":336,"avgPageViews":24.985119047619047,"avgUniquePages":10.241071428571429,"avgEvents":47.732142857142854,"avgScrollDepth":50.666666666666664,"avgDuration":1844.8333333333333,"conversions":38,"totalRevenue":9244.04,"totalTransactions":67,"bounceCount":134,"newUserCount":98,"conversionRate":11.31,"bounceRate":39.88,"newUserRate":29.17,"avgRevenuePerSession":27.51},{"_id":{"deviceType":"console","trafficSource":"email"},"sessionCount":355,"avgPageViews":26.185915492957747,"avgUniquePages":10.447887323943663,"avgEvents":53.59718309859155,"avgScrollDepth":50.96338028169014,"avgDuration":1776.3859154929578,"conversions":40,"totalRevenue":9587.619999999999,"totalTransactions":73,"bounceCount":159,"newUserCount":104,"conversionRate":11.27,"bounceRate":44.79,"newUserRate":29.3,"avgRevenuePerSession":27.01}],"mongodbTime":0,"oracleTime":0},{"id":"PIPE006","name":"Social Post Engagement Analysis","description":"Analyze post engagement including reaction and comment metrics","category":"large_scale","categoryName":"Large-Scale Pipelines","operator":"complex","collection":"social_posts","skip":false,"testSuite":"large_scale","pipeline":[{"$match":{"metadata.status":"published","visibility":{"$in":["public","followers"]}}},{"$group":{"_id":{"postType":"$type"},"postCount":{"$sum":1},"avgLikes":{"$avg":"$reactions.like"},"avgLoves":{"$avg":"$reactions.love"},"avgLaughs":{"$avg":"$reactions.laugh"},"avgWows":{"$avg":"$reactions.wow"},"avgViews":{"$avg":"$engagement.views"},"avgReach":{"$avg":"$engagement.reach"},"avgImpressions":{"$avg":"$engagement.impressions"},"avgSaves":{"$avg":"$engagement.saves"},"totalShares":{"$sum":"$shares.count"},"sponsoredCount":{"$sum":{"$cond":["$metadata.sponsored",1,0]}}}},{"$addFields":{"avgTotalReactions":{"$round":[{"$add":[{"$ifNull":["$avgLikes",0]},{"$ifNull":["$avgLoves",0]},{"$ifNull":["$avgLaughs",0]},{"$ifNull":["$avgWows",0]}]},0]},"sponsoredPercentage":{"$round":[{"$multiply":[{"$divide":["$sponsoredCount","$postCount"]},100]},1]}}},{"$sort":{"avgViews":-1}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"metadata.status\": \"published\",\n      \"visibility\": {\n        \"$in\": [\n          \"public\",\n          \"followers\"\n        ]\n      }\n    }\n  },\n  {\n    \"$group\": {\n      \"_id\": {\n        \"postType\": \"$type\"\n      },\n      \"postCount\": {\n        \"$sum\": 1\n      },\n      \"avgLikes\": {\n        \"$avg\": \"$reactions.like\"\n      },\n      \"avgLoves\": {\n        \"$avg\": \"$reactions.love\"\n      },\n      \"avgLaughs\": {\n        \"$avg\": \"$reactions.laugh\"\n      },\n      \"avgWows\": {\n        \"$avg\": \"$reactions.wow\"\n      },\n      \"avgViews\": {\n        \"$avg\": \"$engagement.views\"\n      },\n      \"avgReach\": {\n        \"$avg\": \"$engagement.reach\"\n      },\n      \"avgImpressions\": {\n        \"$avg\": \"$engagement.impressions\"\n      },\n      \"avgSaves\": {\n        \"$avg\": \"$engagement.saves\"\n      },\n      \"totalShares\": {\n        \"$sum\": \"$shares.count\"\n      },\n      \"sponsoredCount\": {\n        \"$sum\": {\n          \"$cond\": [\n            \"$metadata.sponsored\",\n            1,\n            0\n          ]\n        }\n      }\n    }\n  },\n  {\n    \"$addFields\": {\n      \"avgTotalReactions\": {\n        \"$round\": [\n          {\n            \"$add\": [\n              {\n                \"$ifNull\": [\n                  \"$avgLikes\",\n                  0\n                ]\n              },\n              {\n                \"$ifNull\": [\n                  \"$avgLoves\",\n                  0\n                ]\n              },\n              {\n                \"$ifNull\": [\n                  \"$avgLaughs\",\n                  0\n                ]\n              },\n              {\n                \"$ifNull\": [\n                  \"$avgWows\",\n                  0\n                ]\n              }\n            ]\n          },\n          0\n        ]\n      },\n      \"sponsoredPercentage\": {\n        \"$round\": [\n          {\n            \"$multiply\": [\n              {\n                \"$divide\": [\n                  \"$sponsoredCount\",\n                  \"$postCount\"\n                ]\n              },\n              100\n            ]\n          },\n          1\n        ]\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"avgViews\": -1\n    }\n  }\n]","sql":"SELECT inner_query.*, ROUND((NVL(avgLikes, 0) + NVL(avgLoves, 0) + NVL(avgLaughs, 0) + NVL(avgWows, 0)), 0) AS avgTotalReactions, ROUND(((sponsoredCount / postCount) * 100), 1) AS sponsoredPercentage FROM (SELECT base.data.type AS postType, SUM(1) AS postCount, AVG(base.data.reactions.like) AS avgLikes, AVG(base.data.reactions.love) AS avgLoves, AVG(base.data.reactions.laugh) AS avgLaughs, AVG(base.data.reactions.wow) AS avgWows, AVG(base.data.engagement.views) AS avgViews, AVG(base.data.engagement.reach) AS avgReach, AVG(base.data.engagement.impressions) AS avgImpressions, AVG(base.data.engagement.saves) AS avgSaves, SUM(base.data.shares.count) AS totalShares, SUM(CASE WHEN base.data.metadata.sponsored THEN 1 ELSE 0 END) AS sponsoredCount FROM social_posts base WHERE (base.data.metadata.status = 'published') AND (base.data.visibility IN ('public', 'followers')) GROUP BY base.data.type) inner_query ORDER BY avgViews DESC","sqlFormatted":"SELECT inner_query.*,\n       ROUND((NVL(avgLikes, 0) + NVL(avgLoves, 0) + NVL(avgLaughs, 0) + NVL(avgWows, 0)), 0) AS avgTotalReactions,\n       ROUND(((sponsoredCount / postCount) * 100), 1) AS sponsoredPercentage\nFROM\n  (SELECT base.data.type AS postType,\n          SUM(1) AS postCount,\n          AVG(base.data.reactions.like) AS avgLikes,\n          AVG(base.data.reactions.love) AS avgLoves,\n          AVG(base.data.reactions.laugh) AS avgLaughs,\n          AVG(base.data.reactions.wow) AS avgWows,\n          AVG(base.data.engagement.views) AS avgViews,\n          AVG(base.data.engagement.reach) AS avgReach,\n          AVG(base.data.engagement.impressions) AS avgImpressions,\n          AVG(base.data.engagement.saves) AS avgSaves,\n          SUM(base.data.shares.count) AS totalShares,\n          SUM(CASE\n                  WHEN base.data.metadata.sponsored THEN 1\n                  ELSE 0\n              END) AS sponsoredCount\n   FROM social_posts base\n   WHERE (base.data.metadata.status = 'published')\n     AND (base.data.visibility IN ('public',\n                                   'followers'))\n   GROUP BY base.data.type) inner_query\nORDER BY avgViews DESC","sqlError":null,"status":"PASS","mongodbCount":"6","oracleCount":"6","expectedCount":0,"comparisonResult":"","mongodbResults":[{"_id":{"postType":"text"},"postCount":411,"avgLikes":52636.574209245744,"avgLoves":25647.907542579076,"avgLaughs":10119.732360097323,"avgWows":4879.041362530414,"avgViews":520601.900243309,"avgReach":253601.00486618004,"avgImpressions":997444.00243309,"avgSaves":23654.396593673966,"totalShares":1959232,"sponsoredCount":6,"avgTotalReactions":93283,"sponsoredPercentage":1.5},{"_id":{"postType":"poll"},"postCount":397,"avgLikes":52601.3879093199,"avgLoves":24817.5919395466,"avgLaughs":10574.12846347607,"avgWows":5047.780856423174,"avgViews":516412.362720403,"avgReach":245776.11335012593,"avgImpressions":995325.5667506297,"avgSaves":24550.56675062972,"totalShares":1898517,"sponsoredCount":8,"avgTotalReactions":93041,"sponsoredPercentage":2},{"_id":{"postType":"image"},"postCount":380,"avgLikes":50062.31052631579,"avgLoves":24273.281578947368,"avgLaughs":9666.371052631579,"avgWows":5189.1736842105265,"avgViews":510431.31052631576,"avgReach":255663.04210526316,"avgImpressions":985610.7105263158,"avgSaves":24165.73947368421,"totalShares":1974631,"sponsoredCount":9,"avgTotalReactions":89191,"sponsoredPercentage":2.4},{"_id":{"postType":"video"},"postCount":434,"avgLikes":49671.00230414746,"avgLoves":25330.525345622118,"avgLaughs":9776.81797235023,"avgWows":5097.744239631336,"avgViews":504330.6728110599,"avgReach":251500.93778801843,"avgImpressions":952348.6958525346,"avgSaves":25241.771889400923,"totalShares":2215511,"sponsoredCount":10,"avgTotalReactions":89876,"sponsoredPercentage":2.3},{"_id":{"postType":"link"},"postCount":388,"avgLikes":48731.80670103093,"avgLoves":24069.03092783505,"avgLaughs":9901.306701030928,"avgWows":5094.530927835051,"avgViews":494903.17783505155,"avgReach":263900.48711340205,"avgImpressions":967729.6520618557,"avgSaves":26001.80154639175,"totalShares":1839796,"sponsoredCount":8,"avgTotalReactions":87797,"sponsoredPercentage":2.1}],"oracleResults":[{"_id":{"postType":"text"},"postCount":411,"avgLikes":52636.574209245744,"avgLoves":25647.907542579076,"avgLaughs":10119.732360097323,"avgWows":4879.041362530414,"avgViews":520601.900243309,"avgReach":253601.00486618004,"avgImpressions":997444.00243309,"avgSaves":23654.396593673966,"totalShares":1959232,"sponsoredCount":6,"avgTotalReactions":93283,"sponsoredPercentage":1.5},{"_id":{"postType":"poll"},"postCount":397,"avgLikes":52601.3879093199,"avgLoves":24817.5919395466,"avgLaughs":10574.12846347607,"avgWows":5047.780856423174,"avgViews":516412.362720403,"avgReach":245776.11335012593,"avgImpressions":995325.5667506297,"avgSaves":24550.56675062972,"totalShares":1898517,"sponsoredCount":8,"avgTotalReactions":93041,"sponsoredPercentage":2},{"_id":{"postType":"image"},"postCount":380,"avgLikes":50062.31052631579,"avgLoves":24273.281578947368,"avgLaughs":9666.371052631579,"avgWows":5189.1736842105265,"avgViews":510431.31052631576,"avgReach":255663.04210526316,"avgImpressions":985610.7105263158,"avgSaves":24165.73947368421,"totalShares":1974631,"sponsoredCount":9,"avgTotalReactions":89191,"sponsoredPercentage":2.4},{"_id":{"postType":"video"},"postCount":434,"avgLikes":49671.00230414746,"avgLoves":25330.525345622118,"avgLaughs":9776.81797235023,"avgWows":5097.744239631336,"avgViews":504330.6728110599,"avgReach":251500.93778801843,"avgImpressions":952348.6958525346,"avgSaves":25241.771889400923,"totalShares":2215511,"sponsoredCount":10,"avgTotalReactions":89876,"sponsoredPercentage":2.3},{"_id":{"postType":"link"},"postCount":388,"avgLikes":48731.80670103093,"avgLoves":24069.03092783505,"avgLaughs":9901.306701030928,"avgWows":5094.530927835051,"avgViews":494903.17783505155,"avgReach":263900.48711340205,"avgImpressions":967729.6520618557,"avgSaves":26001.80154639175,"totalShares":1839796,"sponsoredCount":8,"avgTotalReactions":87797,"sponsoredPercentage":2.1}],"mongodbTime":0,"oracleTime":0},{"id":"PIPE007","name":"IoT Device Health Analysis by Building","description":"Analyze device health status by building (without array unwinding)","category":"large_scale","categoryName":"Large-Scale Pipelines","operator":"complex","collection":"iot_devices","skip":false,"testSuite":"large_scale","pipeline":[{"$group":{"_id":{"building":"$location.building","floor":"$location.floor"},"deviceCount":{"$sum":1},"onlineCount":{"$sum":{"$cond":["$status.online",1,0]}},"healthyCount":{"$sum":{"$cond":[{"$eq":["$status.health","healthy"]},1,0]}},"avgBattery":{"$avg":"$status.battery"},"avgSignalStrength":{"$avg":"$status.signalStrength"},"avgSamplingRate":{"$avg":"$configuration.samplingRate"}}},{"$addFields":{"onlinePercentage":{"$round":[{"$multiply":[{"$divide":["$onlineCount","$deviceCount"]},100]},1]},"healthyPercentage":{"$round":[{"$multiply":[{"$divide":["$healthyCount","$deviceCount"]},100]},1]}}},{"$sort":{"healthyPercentage":1,"deviceCount":-1}},{"$limit":40}],"pipelineFormatted":"[\n  {\n    \"$group\": {\n      \"_id\": {\n        \"building\": \"$location.building\",\n        \"floor\": \"$location.floor\"\n      },\n      \"deviceCount\": {\n        \"$sum\": 1\n      },\n      \"onlineCount\": {\n        \"$sum\": {\n          \"$cond\": [\n            \"$status.online\",\n            1,\n            0\n          ]\n        }\n      },\n      \"healthyCount\": {\n        \"$sum\": {\n          \"$cond\": [\n            {\n              \"$eq\": [\n                \"$status.health\",\n                \"healthy\"\n              ]\n            },\n            1,\n            0\n          ]\n        }\n      },\n      \"avgBattery\": {\n        \"$avg\": \"$status.battery\"\n      },\n      \"avgSignalStrength\": {\n        \"$avg\": \"$status.signalStrength\"\n      },\n      \"avgSamplingRate\": {\n        \"$avg\": \"$configuration.samplingRate\"\n      }\n    }\n  },\n  {\n    \"$addFields\": {\n      \"onlinePercentage\": {\n        \"$round\": [\n          {\n            \"$multiply\": [\n              {\n                \"$divide\": [\n                  \"$onlineCount\",\n                  \"$deviceCount\"\n                ]\n              },\n              100\n            ]\n          },\n          1\n        ]\n      },\n      \"healthyPercentage\": {\n        \"$round\": [\n          {\n            \"$multiply\": [\n              {\n                \"$divide\": [\n                  \"$healthyCount\",\n                  \"$deviceCount\"\n                ]\n              },\n              100\n            ]\n          },\n          1\n        ]\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"healthyPercentage\": 1,\n      \"deviceCount\": -1\n    }\n  },\n  {\n    \"$limit\": 40\n  }\n]","sql":"SELECT inner_query.*, ROUND(((onlineCount / deviceCount) * 100), 1) AS onlinePercentage, ROUND(((healthyCount / deviceCount) * 100), 1) AS healthyPercentage FROM (SELECT base.data.location.building AS building, base.data.location.floor AS floor, SUM(1) AS deviceCount, SUM(CASE WHEN base.data.status.online THEN 1 ELSE 0 END) AS onlineCount, SUM(CASE WHEN base.data.status.health = 'healthy' THEN 1 ELSE 0 END) AS healthyCount, AVG(base.data.status.battery) AS avgBattery, AVG(base.data.status.signalStrength) AS avgSignalStrength, AVG(base.data.configuration.samplingRate) AS avgSamplingRate FROM iot_devices base GROUP BY base.data.location.building, base.data.location.floor) inner_query ORDER BY healthyPercentage, deviceCount DESC FETCH FIRST 40 ROWS ONLY","sqlFormatted":"SELECT inner_query.*,\n       ROUND(((onlineCount / deviceCount) * 100), 1) AS onlinePercentage,\n       ROUND(((healthyCount / deviceCount) * 100), 1) AS healthyPercentage\nFROM\n  (SELECT base.data.location.building AS building,\n          base.data.location.floor AS\n   FLOOR,\n          SUM(1) AS deviceCount,\n          SUM(CASE\n                  WHEN base.data.status.online THEN 1\n                  ELSE 0\n              END) AS onlineCount,\n          SUM(CASE\n                  WHEN base.data.status.health = 'healthy' THEN 1\n                  ELSE 0\n              END) AS healthyCount,\n          AVG(base.data.status.battery) AS avgBattery,\n          AVG(base.data.status.signalStrength) AS avgSignalStrength,\n          AVG(base.data.configuration.samplingRate) AS avgSamplingRate\n   FROM iot_devices base\n   GROUP BY base.data.location.building,\n            base.data.location.floor) inner_query\nORDER BY healthyPercentage,\n         deviceCount DESC FETCH FIRST 40 ROWS ONLY","sqlError":null,"status":"PASS","mongodbCount":"40","oracleCount":"40","expectedCount":0,"comparisonResult":"","mongodbResults":[{"_id":{"building":"Building A","floor":16},"deviceCount":10,"onlineCount":10,"healthyCount":0,"avgBattery":30,"avgSignalStrength":-64.7,"avgSamplingRate":38.9,"onlinePercentage":100,"healthyPercentage":0},{"_id":{"building":"Building B","floor":5},"deviceCount":10,"onlineCount":8,"healthyCount":0,"avgBattery":44.4,"avgSignalStrength":-72.2,"avgSamplingRate":28.3,"onlinePercentage":80,"healthyPercentage":0},{"_id":{"building":"Building A","floor":17},"deviceCount":10,"onlineCount":9,"healthyCount":0,"avgBattery":65.25,"avgSignalStrength":-74.3,"avgSamplingRate":36.8,"onlinePercentage":90,"healthyPercentage":0},{"_id":{"building":"Building A","floor":6},"deviceCount":9,"onlineCount":7,"healthyCount":0,"avgBattery":34.6,"avgSignalStrength":-59.44444444444444,"avgSamplingRate":18.11111111111111,"onlinePercentage":77.8,"healthyPercentage":0},{"_id":{"building":"Building E","floor":18},"deviceCount":8,"onlineCount":7,"healthyCount":0,"avgBattery":33.8,"avgSignalStrength":-47.625,"avgSamplingRate":36.5,"onlinePercentage":87.5,"healthyPercentage":0}],"oracleResults":[{"_id":{"building":"Building A","floor":16},"deviceCount":10,"onlineCount":10,"healthyCount":0,"avgBattery":30,"avgSignalStrength":-64.7,"avgSamplingRate":38.9,"onlinePercentage":100,"healthyPercentage":0},{"_id":{"building":"Building B","floor":5},"deviceCount":10,"onlineCount":8,"healthyCount":0,"avgBattery":44.4,"avgSignalStrength":-72.2,"avgSamplingRate":28.3,"onlinePercentage":80,"healthyPercentage":0},{"_id":{"building":"Building A","floor":17},"deviceCount":10,"onlineCount":9,"healthyCount":0,"avgBattery":65.25,"avgSignalStrength":-74.3,"avgSamplingRate":36.8,"onlinePercentage":90,"healthyPercentage":0},{"_id":{"building":"Building A","floor":6},"deviceCount":9,"onlineCount":7,"healthyCount":0,"avgBattery":34.6,"avgSignalStrength":-59.44444444444444,"avgSamplingRate":18.11111111111111,"onlinePercentage":77.8,"healthyPercentage":0},{"_id":{"building":"Building E","floor":18},"deviceCount":8,"onlineCount":7,"healthyCount":0,"avgBattery":33.8,"avgSignalStrength":-47.625,"avgSamplingRate":36.5,"onlinePercentage":87.5,"healthyPercentage":0}],"mongodbTime":0,"oracleTime":0},{"id":"PIPE008","name":"IoT Time-Series Aggregation","description":"Aggregate sensor readings by hour (single group stage)","category":"large_scale","categoryName":"Large-Scale Pipelines","operator":"complex","collection":"iot_readings","skip":false,"testSuite":"large_scale","pipeline":[{"$group":{"_id":{"hourOfDay":{"$hour":"$timestamp"}},"readingCount":{"$sum":1},"avgTemperature":{"$avg":"$readings.temperature.value"},"minTemperature":{"$min":"$readings.temperature.value"},"maxTemperature":{"$max":"$readings.temperature.value"},"avgHumidity":{"$avg":"$readings.humidity.value"},"avgPressure":{"$avg":"$readings.pressure.value"},"goodTempReadings":{"$sum":{"$cond":[{"$eq":["$readings.temperature.quality","good"]},1,0]}},"avgTransmissionDelay":{"$avg":"$metadata.transmissionDelay"}}},{"$addFields":{"temperatureRange":{"$subtract":["$maxTemperature","$minTemperature"]},"dataQualityRate":{"$round":[{"$multiply":[{"$divide":["$goodTempReadings","$readingCount"]},100]},1]}}},{"$sort":{"readingCount":-1}},{"$limit":24}],"pipelineFormatted":"[\n  {\n    \"$group\": {\n      \"_id\": {\n        \"hourOfDay\": {\n          \"$hour\": \"$timestamp\"\n        }\n      },\n      \"readingCount\": {\n        \"$sum\": 1\n      },\n      \"avgTemperature\": {\n        \"$avg\": \"$readings.temperature.value\"\n      },\n      \"minTemperature\": {\n        \"$min\": \"$readings.temperature.value\"\n      },\n      \"maxTemperature\": {\n        \"$max\": \"$readings.temperature.value\"\n      },\n      \"avgHumidity\": {\n        \"$avg\": \"$readings.humidity.value\"\n      },\n      \"avgPressure\": {\n        \"$avg\": \"$readings.pressure.value\"\n      },\n      \"goodTempReadings\": {\n        \"$sum\": {\n          \"$cond\": [\n            {\n              \"$eq\": [\n                \"$readings.temperature.quality\",\n                \"good\"\n              ]\n            },\n            1,\n            0\n          ]\n        }\n      },\n      \"avgTransmissionDelay\": {\n        \"$avg\": \"$metadata.transmissionDelay\"\n      }\n    }\n  },\n  {\n    \"$addFields\": {\n      \"temperatureRange\": {\n        \"$subtract\": [\n          \"$maxTemperature\",\n          \"$minTemperature\"\n        ]\n      },\n      \"dataQualityRate\": {\n        \"$round\": [\n          {\n            \"$multiply\": [\n              {\n                \"$divide\": [\n                  \"$goodTempReadings\",\n                  \"$readingCount\"\n                ]\n              },\n              100\n            ]\n          },\n          1\n        ]\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"readingCount\": -1\n    }\n  },\n  {\n    \"$limit\": 24\n  }\n]","sql":"SELECT inner_query.*, (maxTemperature - minTemperature) AS temperatureRange, ROUND(((goodTempReadings / readingCount) * 100), 1) AS dataQualityRate FROM (SELECT EXTRACT(HOUR FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.timestamp'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"')) AS hourOfDay, SUM(1) AS readingCount, AVG(base.data.readings.temperature.value) AS avgTemperature, MIN(base.data.readings.temperature.value) AS minTemperature, MAX(base.data.readings.temperature.value) AS maxTemperature, AVG(base.data.readings.humidity.value) AS avgHumidity, AVG(base.data.readings.pressure.value) AS avgPressure, SUM(CASE WHEN base.data.readings.temperature.quality = 'good' THEN 1 ELSE 0 END) AS goodTempReadings, AVG(base.data.metadata.transmissionDelay) AS avgTransmissionDelay FROM iot_readings base GROUP BY EXTRACT(HOUR FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.timestamp'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"'))) inner_query ORDER BY readingCount DESC FETCH FIRST 24 ROWS ONLY","sqlFormatted":"SELECT inner_query.*,\n       (maxTemperature - minTemperature) AS temperatureRange,\n       ROUND(((goodTempReadings / readingCount) * 100), 1) AS dataQualityRate\nFROM\n  (SELECT EXTRACT(HOUR\n                  FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.timestamp'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"')) AS hourOfDay,\n          SUM(1) AS readingCount,\n          AVG(base.data.readings.temperature.value) AS avgTemperature,\n          MIN(base.data.readings.temperature.value) AS minTemperature,\n          MAX(base.data.readings.temperature.value) AS maxTemperature,\n          AVG(base.data.readings.humidity.value) AS avgHumidity,\n          AVG(base.data.readings.pressure.value) AS avgPressure,\n          SUM(CASE\n                  WHEN base.data.readings.temperature.quality = 'good' THEN 1\n                  ELSE 0\n              END) AS goodTempReadings,\n          AVG(base.data.metadata.transmissionDelay) AS avgTransmissionDelay\n   FROM iot_readings base\n   GROUP BY EXTRACT(HOUR\n                    FROM TO_TIMESTAMP(JSON_VALUE(base.data, '$.timestamp'), 'YYYY-MM-DD\"T\"HH24:MI:SS.FF3\"Z\"'))) inner_query\nORDER BY readingCount DESC FETCH FIRST 24 ROWS ONLY","sqlError":null,"status":"PASS","mongodbCount":"24","oracleCount":"24","expectedCount":0,"comparisonResult":"","mongodbResults":[{"_id":{"hourOfDay":7},"readingCount":4261,"avgTemperature":15.436266134710161,"minTemperature":-20,"maxTemperature":49.99,"avgHumidity":49.8983102558085,"avgPressure":1000.2664632715326,"goodTempReadings":1459,"avgTransmissionDelay":2513.3651724947194,"temperatureRange":69.99000000000001,"dataQualityRate":34.2},{"_id":{"hourOfDay":4},"readingCount":4253,"avgTemperature":15.09588290618387,"minTemperature":-19.99,"maxTemperature":49.99,"avgHumidity":49.898048436397836,"avgPressure":1000.3036679990595,"goodTempReadings":1417,"avgTransmissionDelay":2509.779920056431,"temperatureRange":69.98,"dataQualityRate":33.3},{"_id":{"hourOfDay":14},"readingCount":4248,"avgTemperature":14.921935028248587,"minTemperature":-19.99,"maxTemperature":50,"avgHumidity":50.907933145009416,"avgPressure":1000.8773540489642,"goodTempReadings":1440,"avgTransmissionDelay":2528.447033898305,"temperatureRange":69.99,"dataQualityRate":33.9},{"_id":{"hourOfDay":20},"readingCount":4239,"avgTemperature":14.709641424864355,"minTemperature":-19.99,"maxTemperature":49.96,"avgHumidity":50.276102854446805,"avgPressure":1000.6887709365417,"goodTempReadings":1419,"avgTransmissionDelay":2509.840528426516,"temperatureRange":69.95,"dataQualityRate":33.5},{"_id":{"hourOfDay":1},"readingCount":4225,"avgTemperature":14.956208284023669,"minTemperature":-19.99,"maxTemperature":49.98,"avgHumidity":50.143076923076926,"avgPressure":1000.7376331360947,"goodTempReadings":1427,"avgTransmissionDelay":2540.934201183432,"temperatureRange":69.97,"dataQualityRate":33.8}],"oracleResults":[{"_id":{"hourOfDay":7},"readingCount":4261,"avgTemperature":15.436266134710161,"minTemperature":-20,"maxTemperature":49.99,"avgHumidity":49.8983102558085,"avgPressure":1000.2664632715326,"goodTempReadings":1459,"avgTransmissionDelay":2513.3651724947194,"temperatureRange":69.99000000000001,"dataQualityRate":34.2},{"_id":{"hourOfDay":4},"readingCount":4253,"avgTemperature":15.09588290618387,"minTemperature":-19.99,"maxTemperature":49.99,"avgHumidity":49.898048436397836,"avgPressure":1000.3036679990595,"goodTempReadings":1417,"avgTransmissionDelay":2509.779920056431,"temperatureRange":69.98,"dataQualityRate":33.3},{"_id":{"hourOfDay":14},"readingCount":4248,"avgTemperature":14.921935028248587,"minTemperature":-19.99,"maxTemperature":50,"avgHumidity":50.907933145009416,"avgPressure":1000.8773540489642,"goodTempReadings":1440,"avgTransmissionDelay":2528.447033898305,"temperatureRange":69.99,"dataQualityRate":33.9},{"_id":{"hourOfDay":20},"readingCount":4239,"avgTemperature":14.709641424864355,"minTemperature":-19.99,"maxTemperature":49.96,"avgHumidity":50.276102854446805,"avgPressure":1000.6887709365417,"goodTempReadings":1419,"avgTransmissionDelay":2509.840528426516,"temperatureRange":69.95,"dataQualityRate":33.5},{"_id":{"hourOfDay":1},"readingCount":4225,"avgTemperature":14.956208284023669,"minTemperature":-19.99,"maxTemperature":49.98,"avgHumidity":50.143076923076926,"avgPressure":1000.7376331360947,"goodTempReadings":1427,"avgTransmissionDelay":2540.934201183432,"temperatureRange":69.97,"dataQualityRate":33.8}],"mongodbTime":0,"oracleTime":0},{"id":"PIPE009","name":"User Follower Network Analysis","description":"Analyze social user networks with engagement and activity patterns using bucket aggregation","category":"large_scale","categoryName":"Large-Scale Pipelines","operator":"complex","collection":"social_users","skip":false,"testSuite":"large_scale","pipeline":[{"$match":{"metadata.status":"active"}},{"$bucket":{"groupBy":"$stats.followers","boundaries":[0,100,1000,10000,100000,1000000,10000000],"default":10000001,"output":{"userCount":{"$sum":1},"verifiedCount":{"$sum":{"$cond":["$profile.verified",1,0]}},"privateCount":{"$sum":{"$cond":["$profile.private",1,0]}},"avgFollowing":{"$avg":"$stats.following"},"avgPosts":{"$avg":"$stats.posts"},"avgLikes":{"$avg":"$stats.likes"},"avgComments":{"$avg":"$stats.comments"},"avgShares":{"$avg":"$stats.shares"},"avgLoginStreak":{"$avg":"$activity.loginStreak"},"avgTimeSpent":{"$avg":"$activity.totalTimeSpent"}}}},{"$addFields":{"verifiedPercentage":{"$round":[{"$multiply":[{"$divide":["$verifiedCount","$userCount"]},100]},1]},"privatePercentage":{"$round":[{"$multiply":[{"$divide":["$privateCount","$userCount"]},100]},1]},"avgEngagement":{"$round":[{"$add":["$avgLikes","$avgComments","$avgShares"]},0]}}}],"pipelineFormatted":"[\n  {\n    \"$match\": {\n      \"metadata.status\": \"active\"\n    }\n  },\n  {\n    \"$bucket\": {\n      \"groupBy\": \"$stats.followers\",\n      \"boundaries\": [\n        0,\n        100,\n        1000,\n        10000,\n        100000,\n        1000000,\n        10000000\n      ],\n      \"default\": 10000001,\n      \"output\": {\n        \"userCount\": {\n          \"$sum\": 1\n        },\n        \"verifiedCount\": {\n          \"$sum\": {\n            \"$cond\": [\n              \"$profile.verified\",\n              1,\n              0\n            ]\n          }\n        },\n        \"privateCount\": {\n          \"$sum\": {\n            \"$cond\": [\n              \"$profile.private\",\n              1,\n              0\n            ]\n          }\n        },\n        \"avgFollowing\": {\n          \"$avg\": \"$stats.following\"\n        },\n        \"avgPosts\": {\n          \"$avg\": \"$stats.posts\"\n        },\n        \"avgLikes\": {\n          \"$avg\": \"$stats.likes\"\n        },\n        \"avgComments\": {\n          \"$avg\": \"$stats.comments\"\n        },\n        \"avgShares\": {\n          \"$avg\": \"$stats.shares\"\n        },\n        \"avgLoginStreak\": {\n          \"$avg\": \"$activity.loginStreak\"\n        },\n        \"avgTimeSpent\": {\n          \"$avg\": \"$activity.totalTimeSpent\"\n        }\n      }\n    }\n  },\n  {\n    \"$addFields\": {\n      \"verifiedPercentage\": {\n        \"$round\": [\n          {\n            \"$multiply\": [\n              {\n                \"$divide\": [\n                  \"$verifiedCount\",\n                  \"$userCount\"\n                ]\n              },\n              100\n            ]\n          },\n          1\n        ]\n      },\n      \"privatePercentage\": {\n        \"$round\": [\n          {\n            \"$multiply\": [\n              {\n                \"$divide\": [\n                  \"$privateCount\",\n                  \"$userCount\"\n                ]\n              },\n              100\n            ]\n          },\n          1\n        ]\n      },\n      \"avgEngagement\": {\n        \"$round\": [\n          {\n            \"$add\": [\n              \"$avgLikes\",\n              \"$avgComments\",\n              \"$avgShares\"\n            ]\n          },\n          0\n        ]\n      }\n    }\n  }\n]","sql":"SELECT inner_query.*, ROUND(((verifiedCount / userCount) * 100), 1) AS verifiedPercentage, ROUND(((privateCount / userCount) * 100), 1) AS privatePercentage, ROUND((avgLikes + avgComments + avgShares), 0) AS avgEngagement FROM (SELECT CASE WHEN base.data.stats.followers >= 0 AND base.data.stats.followers < 100 THEN 0 WHEN base.data.stats.followers >= 100 AND base.data.stats.followers < 1000 THEN 100 WHEN base.data.stats.followers >= 1000 AND base.data.stats.followers < 10000 THEN 1000 WHEN base.data.stats.followers >= 10000 AND base.data.stats.followers < 100000 THEN 10000 WHEN base.data.stats.followers >= 100000 AND base.data.stats.followers < 1000000 THEN 100000 WHEN base.data.stats.followers >= 1000000 AND base.data.stats.followers < 10000000 THEN 1000000 ELSE 10000001 END AS \"_id\", SUM(1) AS userCount, SUM(CASE WHEN base.data.profile.verified THEN 1 ELSE 0 END) AS verifiedCount, SUM(CASE WHEN base.data.profile.private THEN 1 ELSE 0 END) AS privateCount, AVG(base.data.stats.following) AS avgFollowing, AVG(base.data.stats.posts) AS avgPosts, AVG(base.data.stats.likes) AS avgLikes, AVG(base.data.stats.comments) AS avgComments, AVG(base.data.stats.shares) AS avgShares, AVG(base.data.activity.loginStreak) AS avgLoginStreak, AVG(base.data.activity.totalTimeSpent) AS avgTimeSpent FROM social_users base WHERE base.data.metadata.status = 'active' GROUP BY CASE WHEN base.data.stats.followers >= 0 AND base.data.stats.followers < 100 THEN 0 WHEN base.data.stats.followers >= 100 AND base.data.stats.followers < 1000 THEN 100 WHEN base.data.stats.followers >= 1000 AND base.data.stats.followers < 10000 THEN 1000 WHEN base.data.stats.followers >= 10000 AND base.data.stats.followers < 100000 THEN 10000 WHEN base.data.stats.followers >= 100000 AND base.data.stats.followers < 1000000 THEN 100000 WHEN base.data.stats.followers >= 1000000 AND base.data.stats.followers < 10000000 THEN 1000000 ELSE 10000001 END) inner_query","sqlFormatted":"SELECT inner_query.*,\n       ROUND(((verifiedCount / userCount) * 100), 1) AS verifiedPercentage,\n       ROUND(((privateCount / userCount) * 100), 1) AS privatePercentage,\n       ROUND((avgLikes + avgComments + avgShares), 0) AS avgEngagement\nFROM\n  (SELECT CASE\n              WHEN base.data.stats.followers >= 0\n                   AND base.data.stats.followers < 100 THEN 0\n              WHEN base.data.stats.followers >= 100\n                   AND base.data.stats.followers < 1000 THEN 100\n              WHEN base.data.stats.followers >= 1000\n                   AND base.data.stats.followers < 10000 THEN 1000\n              WHEN base.data.stats.followers >= 10000\n                   AND base.data.stats.followers < 100000 THEN 10000\n              WHEN base.data.stats.followers >= 100000\n                   AND base.data.stats.followers < 1000000 THEN 100000\n              WHEN base.data.stats.followers >= 1000000\n                   AND base.data.stats.followers < 10000000 THEN 1000000\n              ELSE 10000001\n          END AS \"_id\",\n          SUM(1) AS userCount,\n          SUM(CASE\n                  WHEN base.data.profile.verified THEN 1\n                  ELSE 0\n              END) AS verifiedCount,\n          SUM(CASE\n                  WHEN base.data.profile.private THEN 1\n                  ELSE 0\n              END) AS privateCount,\n          AVG(base.data.stats.following) AS avgFollowing,\n          AVG(base.data.stats.posts) AS avgPosts,\n          AVG(base.data.stats.likes) AS avgLikes,\n          AVG(base.data.stats.comments) AS avgComments,\n          AVG(base.data.stats.shares) AS avgShares,\n          AVG(base.data.activity.loginStreak) AS avgLoginStreak,\n          AVG(base.data.activity.totalTimeSpent) AS avgTimeSpent\n   FROM social_users base\n   WHERE base.data.metadata.status = 'active'\n   GROUP BY CASE\n                WHEN base.data.stats.followers >= 0\n                     AND base.data.stats.followers < 100 THEN 0\n                WHEN base.data.stats.followers >= 100\n                     AND base.data.stats.followers < 1000 THEN 100\n                WHEN base.data.stats.followers >= 1000\n                     AND base.data.stats.followers < 10000 THEN 1000\n                WHEN base.data.stats.followers >= 10000\n                     AND base.data.stats.followers < 100000 THEN 10000\n                WHEN base.data.stats.followers >= 100000\n                     AND base.data.stats.followers < 1000000 THEN 100000\n                WHEN base.data.stats.followers >= 1000000\n                     AND base.data.stats.followers < 10000000 THEN 1000000\n                ELSE 10000001\n            END) inner_query","sqlError":null,"status":"PASS","mongodbCount":"4","oracleCount":"4","expectedCount":0,"comparisonResult":"","mongodbResults":[{"_id":100,"userCount":3,"verifiedCount":0,"privateCount":1,"avgFollowing":1294.3333333333333,"avgPosts":3892.3333333333335,"avgLikes":66854.33333333333,"avgComments":43180.333333333336,"avgShares":8266,"avgLoginStreak":288,"avgTimeSpent":602642,"verifiedPercentage":0,"privatePercentage":33.3,"avgEngagement":118301},{"_id":1000,"userCount":13,"verifiedCount":1,"privateCount":2,"avgFollowing":2186,"avgPosts":4034.6923076923076,"avgLikes":47751.846153846156,"avgComments":17858.76923076923,"avgShares":11329.692307692309,"avgLoginStreak":177.15384615384616,"avgTimeSpent":386691.23076923075,"verifiedPercentage":7.7,"privatePercentage":15.4,"avgEngagement":76940},{"_id":10000,"userCount":142,"verifiedCount":8,"privateCount":23,"avgFollowing":2331.443661971831,"avgPosts":5284.992957746479,"avgLikes":51545.788732394365,"avgComments":24543.24647887324,"avgShares":10109.457746478873,"avgLoginStreak":197.90845070422534,"avgTimeSpent":499474.0352112676,"verifiedPercentage":5.6,"privatePercentage":16.2,"avgEngagement":86198},{"_id":100000,"userCount":1489,"verifiedCount":64,"privateCount":278,"avgFollowing":2495.9724647414373,"avgPosts":4984.108126259234,"avgLikes":50953.07320349228,"avgComments":24804.36198791135,"avgShares":10120.986568166554,"avgLoginStreak":183.76091336467428,"avgTimeSpent":509014.643384822,"verifiedPercentage":4.3,"privatePercentage":18.7,"avgEngagement":85878}],"oracleResults":[{"_id":100,"userCount":3,"verifiedCount":0,"privateCount":1,"avgFollowing":1294.3333333333333,"avgPosts":3892.3333333333335,"avgLikes":66854.33333333333,"avgComments":43180.333333333336,"avgShares":8266,"avgLoginStreak":288,"avgTimeSpent":602642,"verifiedPercentage":0,"privatePercentage":33.3,"avgEngagement":118301},{"_id":1000,"userCount":13,"verifiedCount":1,"privateCount":2,"avgFollowing":2186,"avgPosts":4034.6923076923076,"avgLikes":47751.846153846156,"avgComments":17858.76923076923,"avgShares":11329.692307692309,"avgLoginStreak":177.15384615384616,"avgTimeSpent":386691.23076923075,"verifiedPercentage":7.7,"privatePercentage":15.4,"avgEngagement":76940},{"_id":10000,"userCount":142,"verifiedCount":8,"privateCount":23,"avgFollowing":2331.443661971831,"avgPosts":5284.992957746479,"avgLikes":51545.788732394365,"avgComments":24543.24647887324,"avgShares":10109.457746478873,"avgLoginStreak":197.90845070422534,"avgTimeSpent":499474.0352112676,"verifiedPercentage":5.6,"privatePercentage":16.2,"avgEngagement":86198},{"_id":100000,"userCount":1489,"verifiedCount":64,"privateCount":278,"avgFollowing":2495.9724647414373,"avgPosts":4984.108126259234,"avgLikes":50953.07320349228,"avgComments":24804.36198791135,"avgShares":10120.986568166554,"avgLoginStreak":183.76091336467428,"avgTimeSpent":509014.643384822,"verifiedPercentage":4.3,"privatePercentage":18.7,"avgEngagement":85878}],"mongodbTime":0,"oracleTime":0},{"id":"PIPE010","name":"Order Analysis by Payment and Shipping Method","description":"Analyze all orders by payment method with totals metrics (without array unwinding)","category":"large_scale","categoryName":"Large-Scale Pipelines","operator":"complex","collection":"ecommerce_orders","skip":false,"testSuite":"large_scale","pipeline":[{"$group":{"_id":{"paymentMethod":"$payment.method","shippingMethod":"$shipping.method"},"orderCount":{"$sum":1},"totalRevenue":{"$sum":"$pricing.subtotal"},"totalShipping":{"$sum":"$pricing.shipping"},"totalTax":{"$sum":"$pricing.tax"},"avgOrderValue":{"$avg":"$pricing.subtotal"},"maxOrderValue":{"$max":"$pricing.subtotal"},"minOrderValue":{"$min":"$pricing.subtotal"}}},{"$addFields":{"avgRevenuePerOrder":{"$round":[{"$divide":["$totalRevenue","$orderCount"]},2]},"shippingPercent":{"$round":[{"$cond":[{"$gt":["$totalRevenue",0]},{"$multiply":[{"$divide":["$totalShipping","$totalRevenue"]},100]},0]},1]}}},{"$sort":{"totalRevenue":-1}},{"$limit":50}],"pipelineFormatted":"[\n  {\n    \"$group\": {\n      \"_id\": {\n        \"paymentMethod\": \"$payment.method\",\n        \"shippingMethod\": \"$shipping.method\"\n      },\n      \"orderCount\": {\n        \"$sum\": 1\n      },\n      \"totalRevenue\": {\n        \"$sum\": \"$pricing.subtotal\"\n      },\n      \"totalShipping\": {\n        \"$sum\": \"$pricing.shipping\"\n      },\n      \"totalTax\": {\n        \"$sum\": \"$pricing.tax\"\n      },\n      \"avgOrderValue\": {\n        \"$avg\": \"$pricing.subtotal\"\n      },\n      \"maxOrderValue\": {\n        \"$max\": \"$pricing.subtotal\"\n      },\n      \"minOrderValue\": {\n        \"$min\": \"$pricing.subtotal\"\n      }\n    }\n  },\n  {\n    \"$addFields\": {\n      \"avgRevenuePerOrder\": {\n        \"$round\": [\n          {\n            \"$divide\": [\n              \"$totalRevenue\",\n              \"$orderCount\"\n            ]\n          },\n          2\n        ]\n      },\n      \"shippingPercent\": {\n        \"$round\": [\n          {\n            \"$cond\": [\n              {\n                \"$gt\": [\n                  \"$totalRevenue\",\n                  0\n                ]\n              },\n              {\n                \"$multiply\": [\n                  {\n                    \"$divide\": [\n                      \"$totalShipping\",\n                      \"$totalRevenue\"\n                    ]\n                  },\n                  100\n                ]\n              },\n              0\n            ]\n          },\n          1\n        ]\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"totalRevenue\": -1\n    }\n  },\n  {\n    \"$limit\": 50\n  }\n]","sql":"SELECT inner_query.*, ROUND((totalRevenue / orderCount), 2) AS avgRevenuePerOrder, ROUND(CASE WHEN totalRevenue > 0 THEN ((totalShipping / totalRevenue) * 100) ELSE 0 END, 1) AS shippingPercent FROM (SELECT base.data.payment.method AS paymentMethod, base.data.shipping.method AS shippingMethod, SUM(1) AS orderCount, SUM(base.data.pricing.subtotal) AS totalRevenue, SUM(base.data.pricing.shipping) AS totalShipping, SUM(base.data.pricing.tax) AS totalTax, AVG(base.data.pricing.subtotal) AS avgOrderValue, MAX(base.data.pricing.subtotal) AS maxOrderValue, MIN(base.data.pricing.subtotal) AS minOrderValue FROM ecommerce_orders base GROUP BY base.data.payment.method, base.data.shipping.method) inner_query ORDER BY totalRevenue DESC FETCH FIRST 50 ROWS ONLY","sqlFormatted":"SELECT inner_query.*,\n       ROUND((totalRevenue / orderCount), 2) AS avgRevenuePerOrder,\n       ROUND(CASE\n                 WHEN totalRevenue > 0 THEN ((totalShipping / totalRevenue) * 100)\n                 ELSE 0\n             END, 1) AS shippingPercent\nFROM\n  (SELECT base.data.payment.method AS paymentMethod,\n          base.data.shipping.method AS shippingMethod,\n          SUM(1) AS orderCount,\n          SUM(base.data.pricing.subtotal) AS totalRevenue,\n          SUM(base.data.pricing.shipping) AS totalShipping,\n          SUM(base.data.pricing.tax) AS totalTax,\n          AVG(base.data.pricing.subtotal) AS avgOrderValue,\n          MAX(base.data.pricing.subtotal) AS maxOrderValue,\n          MIN(base.data.pricing.subtotal) AS minOrderValue\n   FROM ecommerce_orders base\n   GROUP BY base.data.payment.method,\n            base.data.shipping.method) inner_query\nORDER BY totalRevenue DESC FETCH FIRST 50 ROWS ONLY","sqlError":null,"status":"PASS","mongodbCount":"35","oracleCount":"35","expectedCount":0,"comparisonResult":"","mongodbResults":[{"_id":{"paymentMethod":"apple_pay","shippingMethod":"freight"},"orderCount":334,"totalRevenue":1465271.75,"totalShipping":4090.54,"totalTax":88407.856754,"avgOrderValue":4387.041167664671,"maxOrderValue":11494.94,"minOrderValue":57.449999999999996,"avgRevenuePerOrder":4387.04,"shippingPercent":0.3},{"_id":{"paymentMethod":"bank_transfer","shippingMethod":"standard"},"orderCount":318,"totalRevenue":1350847.76,"totalShipping":4039.94,"totalTax":83876.69345,"avgOrderValue":4247.94893081761,"maxOrderValue":10777.95,"minOrderValue":53.94,"avgRevenuePerOrder":4247.95,"shippingPercent":0.3},{"_id":{"paymentMethod":"bank_transfer","shippingMethod":"pickup"},"orderCount":294,"totalRevenue":1341263.09,"totalShipping":3653.48,"totalTax":81666.745686,"avgOrderValue":4562.1193537414965,"maxOrderValue":13206.11,"minOrderValue":60.92,"avgRevenuePerOrder":4562.12,"shippingPercent":0.3},{"_id":{"paymentMethod":"bank_transfer","shippingMethod":"express"},"orderCount":307,"totalRevenue":1336451.84,"totalShipping":4078.71,"totalTax":80032.643725,"avgOrderValue":4353.26332247557,"maxOrderValue":12848.36,"minOrderValue":71.37,"avgRevenuePerOrder":4353.26,"shippingPercent":0.3},{"_id":{"paymentMethod":"crypto","shippingMethod":"overnight"},"orderCount":308,"totalRevenue":1309467.94,"totalShipping":4077.34,"totalTax":78041.008194,"avgOrderValue":4251.519285714286,"maxOrderValue":12829.09,"minOrderValue":16.66,"avgRevenuePerOrder":4251.52,"shippingPercent":0.3}],"oracleResults":[{"_id":{"paymentMethod":"apple_pay","shippingMethod":"freight"},"orderCount":334,"totalRevenue":1465271.75,"totalShipping":4090.54,"totalTax":88407.856754,"avgOrderValue":4387.041167664671,"maxOrderValue":11494.94,"minOrderValue":57.449999999999996,"avgRevenuePerOrder":4387.04,"shippingPercent":0.3},{"_id":{"paymentMethod":"bank_transfer","shippingMethod":"standard"},"orderCount":318,"totalRevenue":1350847.76,"totalShipping":4039.94,"totalTax":83876.69345,"avgOrderValue":4247.94893081761,"maxOrderValue":10777.95,"minOrderValue":53.94,"avgRevenuePerOrder":4247.95,"shippingPercent":0.3},{"_id":{"paymentMethod":"bank_transfer","shippingMethod":"pickup"},"orderCount":294,"totalRevenue":1341263.09,"totalShipping":3653.48,"totalTax":81666.745686,"avgOrderValue":4562.1193537414965,"maxOrderValue":13206.11,"minOrderValue":60.92,"avgRevenuePerOrder":4562.12,"shippingPercent":0.3},{"_id":{"paymentMethod":"bank_transfer","shippingMethod":"express"},"orderCount":307,"totalRevenue":1336451.84,"totalShipping":4078.71,"totalTax":80032.643725,"avgOrderValue":4353.26332247557,"maxOrderValue":12848.36,"minOrderValue":71.37,"avgRevenuePerOrder":4353.26,"shippingPercent":0.3},{"_id":{"paymentMethod":"crypto","shippingMethod":"overnight"},"orderCount":308,"totalRevenue":1309467.94,"totalShipping":4077.34,"totalTax":78041.008194,"avgOrderValue":4251.519285714286,"maxOrderValue":12829.09,"minOrderValue":16.66,"avgRevenuePerOrder":4251.52,"shippingPercent":0.3}],"mongodbTime":0,"oracleTime":0}]},"unit":{"name":"Unit Tests","description":"Java unit tests for AST, parsers, and generators","tests":[]},"integration":{"name":"Integration Tests","description":"Oracle Testcontainers integration tests","tests":[]}}};</script>
</head>
<body>
    <div class="loading-overlay show" id="loadingOverlay">
        <div class="spinner"></div>
        <div>Loading test catalog...</div>
    </div>

    <div class="container">
        <header>
            <h1>MongoPLSQL-Bridge Test Catalog</h1>
            <div class="subtitle">Comprehensive test suite for MongoDB to Oracle SQL translation</div>
            <div class="generated-time" id="generatedTime"></div>
        </header>

        <!-- Test Suite Tabs -->
        <div class="suite-tabs" id="suiteTabs">
            <button class="suite-tab active" data-suite="query">
                Query Tests
                <span class="count" id="queryCount">0</span>
            </button>
            <button class="suite-tab" data-suite="large_scale">
                Large-Scale
                <span class="count" id="largeScaleCount">0</span>
            </button>
            <button class="suite-tab" data-suite="unit">
                Unit Tests
                <span class="count" id="unitCount">0</span>
            </button>
            <button class="suite-tab" data-suite="integration">
                Integration
                <span class="count" id="integrationCount">0</span>
            </button>
        </div>

        <!-- Summary Cards -->
        <div class="summary-grid">
            <div class="summary-card total">
                <div class="value" id="totalCount">-</div>
                <div class="label">Total Tests</div>
            </div>
            <div class="summary-card passed">
                <div class="value" id="passedCount">-</div>
                <div class="label">Passed</div>
            </div>
            <div class="summary-card failed">
                <div class="value" id="failedCount">-</div>
                <div class="label">Failed</div>
            </div>
            <div class="summary-card skipped">
                <div class="value" id="skippedCount">-</div>
                <div class="label">Skipped</div>
            </div>
        </div>

        <!-- Search and Filters -->
        <div class="controls">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Search tests by ID, name, or operator...">
            </div>
            <div class="filter-group">
                <button class="filter-btn active" data-filter="all">All</button>
                <button class="filter-btn" data-filter="pass">Passed</button>
                <button class="filter-btn" data-filter="fail">Failed</button>
                <button class="filter-btn" data-filter="skip">Skipped</button>
            </div>
        </div>

        <!-- Category Tabs (for query tests) -->
        <div class="category-tabs" id="categoryTabs">
            <button class="category-tab active" data-category="all">
                All <span class="count" id="allCount">0</span>
            </button>
        </div>

        <!-- Test List -->
        <div class="test-list" id="testList"></div>

        <div class="no-results" id="noResults" style="display: none;">
            <h3>No tests found</h3>
            <p>Try adjusting your search or filters</p>
        </div>
    </div>

    <button class="settings-btn" id="settingsBtn" title="Server Configuration">&#9881;</button>

    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <h3>Server Configuration</h3>
            <p style="color: var(--text-secondary); margin-bottom: 16px; font-size: 0.9rem;">
                Configure database connections for live test execution.
            </p>
            <div class="form-group">
                <label>MongoDB URI</label>
                <input type="text" id="mongoUri" value="mongodb://admin:admin123@localhost:27017/testdb?authSource=admin">
            </div>
            <div class="form-group">
                <label>Oracle JDBC URL</label>
                <input type="text" id="oracleUrl" value="jdbc:oracle:thin:@localhost:1521/FREEPDB1">
            </div>
            <div class="form-group">
                <label>Oracle User</label>
                <input type="text" id="oracleUser" value="translator">
            </div>
            <div class="form-group">
                <label>Oracle Password</label>
                <input type="password" id="oraclePassword" value="translator123">
            </div>
            <div class="modal-buttons">
                <button class="modal-btn secondary" id="cancelSettings">Cancel</button>
                <button class="modal-btn primary" id="saveSettings">Save</button>
            </div>
        </div>
    </div>

    <div class="modal" id="runTestModal">
        <div class="modal-content" style="max-width: 600px;">
            <h3>Run Test: <span id="runTestId"></span></h3>
            <p style="color: var(--text-secondary); margin-bottom: 16px; font-size: 0.9rem;">
                Tests must be run from the command line. Copy the command below and run it in your terminal.
            </p>
            <div style="background: var(--code-bg); border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                <code id="runTestCommand" style="color: var(--accent); font-size: 0.95rem; word-break: break-all;"></code>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn secondary" id="closeRunTest">Close</button>
                <button class="modal-btn primary" id="copyRunCommand">Copy Command</button>
            </div>
        </div>
    </div>

    <script>
        let testData = null;
        let currentSuite = 'query';
        let currentFilter = 'all';
        let currentCategory = 'all';
        let searchQuery = '';

        async function loadTestData() {
            try {
                // Try fetch first (works when served via HTTP)
                const response = await fetch('test-catalog-data.json');
                if (!response.ok) throw new Error('Failed to load test data');
                testData = await response.json();
                initializeUI();
            } catch (error) {
                // If fetch fails (file:// protocol), try loading from inline script
                if (typeof TEST_CATALOG_DATA !== 'undefined') {
                    testData = TEST_CATALOG_DATA;
                    initializeUI();
                } else {
                    console.error('Error loading test data:', error);
                    document.getElementById('loadingOverlay').innerHTML = `
                        <div style="color: var(--error);">Error loading test data</div>
                        <div style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 10px;">
                            For file:// access, run:<br>
                            <code style="background: #1a1a2e; padding: 4px 8px; border-radius: 4px; display: inline-block; margin-top: 8px;">
                                cd docs && python3 -m http.server 8080
                            </code><br>
                            Then open: <a href="http://localhost:8080/test-catalog.html" style="color: var(--accent);">http://localhost:8080/test-catalog.html</a>
                        </div>
                    `;
                }
            }
        }

        function initializeUI() {
            const summary = testData.summary;

            // Update suite tabs counts
            document.getElementById('queryCount').textContent = summary.queryTests?.total || 0;
            document.getElementById('largeScaleCount').textContent = summary.largeScaleTests?.total || 0;
            document.getElementById('unitCount').textContent = summary.unitTests?.count || 0;
            document.getElementById('integrationCount').textContent = summary.integrationTests?.count || 0;

            // Set generated time
            const genTime = new Date(testData.generated);
            document.getElementById('generatedTime').textContent = `Generated: ${genTime.toLocaleString()}`;

            updateSummary();
            buildCategoryTabs();
            renderTests();

            document.getElementById('loadingOverlay').classList.remove('show');
            setupEventListeners();
        }

        function updateSummary() {
            const suite = testData.testSuites[currentSuite];
            if (!suite) return;

            const tests = suite.tests || [];
            const total = tests.length;
            const passed = tests.filter(t => t.status === 'PASS').length;
            const failed = tests.filter(t => t.status === 'FAIL' || t.status === 'ERROR').length;
            const skipped = tests.filter(t => t.status === 'SKIP').length;

            document.getElementById('totalCount').textContent = total;
            document.getElementById('passedCount').textContent = passed;
            document.getElementById('failedCount').textContent = failed;
            document.getElementById('skippedCount').textContent = skipped;
            document.getElementById('allCount').textContent = total;
        }

        function buildCategoryTabs() {
            const container = document.getElementById('categoryTabs');
            const suite = testData.testSuites[currentSuite];
            if (!suite) return;

            // Hide category tabs for unit/integration tests
            if (currentSuite === 'unit' || currentSuite === 'integration') {
                container.style.display = 'none';
                return;
            }
            container.style.display = 'flex';

            const tests = suite.tests || [];
            const categories = {};

            tests.forEach(test => {
                const cat = test.category || 'uncategorized';
                if (!categories[cat]) {
                    categories[cat] = { name: test.categoryName || cat, count: 0 };
                }
                categories[cat].count++;
            });

            let html = `<button class="category-tab active" data-category="all">All <span class="count">${tests.length}</span></button>`;
            const sortedCats = Object.entries(categories).sort((a, b) => b[1].count - a[1].count);

            for (const [key, cat] of sortedCats) {
                html += `<button class="category-tab" data-category="${key}">${cat.name} <span class="count">${cat.count}</span></button>`;
            }

            container.innerHTML = html;
            currentCategory = 'all';
        }

        function renderTests() {
            const container = document.getElementById('testList');
            const noResults = document.getElementById('noResults');
            const suite = testData.testSuites[currentSuite];

            if (!suite) {
                container.innerHTML = '';
                noResults.style.display = 'block';
                return;
            }

            let filteredTests = (suite.tests || []).filter(test => {
                if (currentFilter !== 'all') {
                    const status = (test.status || '').toLowerCase();
                    if (currentFilter === 'fail' && status !== 'fail' && status !== 'error') return false;
                    if (currentFilter !== 'fail' && status !== currentFilter) return false;
                }
                if (currentCategory !== 'all' && test.category !== currentCategory) return false;
                if (searchQuery) {
                    const q = searchQuery.toLowerCase();
                    const searchable = `${test.id} ${test.name} ${test.operator || ''} ${test.description || ''} ${test.className || ''}`.toLowerCase();
                    if (!searchable.includes(q)) return false;
                }
                return true;
            });

            if (filteredTests.length === 0) {
                container.innerHTML = '';
                noResults.style.display = 'block';
                return;
            }

            noResults.style.display = 'none';

            if (currentSuite === 'unit' || currentSuite === 'integration') {
                container.innerHTML = filteredTests.map(test => renderSimpleTestCard(test)).join('');
            } else {
                container.innerHTML = filteredTests.map(test => renderQueryTestCard(test)).join('');
            }

            attachCardListeners();
        }

        function renderSimpleTestCard(test) {
            const statusClass = (test.status || 'na').toLowerCase();
            return `
                <div class="test-card simple status-${statusClass}" data-test-id="${test.id}">
                    <div class="test-header">
                        <div class="test-info">
                            <span class="test-id">${escapeHtml(test.name)}</span>
                            <span class="test-name">${escapeHtml(test.className || '')}</span>
                        </div>
                        <div class="test-meta">
                            <span class="status-badge ${statusClass}">${test.status}</span>
                            <span class="test-time">${(test.time || 0).toFixed(3)}s</span>
                            <span class="expand-icon">&#9660;</span>
                        </div>
                    </div>
                    <div class="test-details">
                        ${test.failureMessage ? `<div class="comparison-status mismatch">${escapeHtml(test.failureMessage)}</div>` : ''}
                        ${test.errorMessage ? `<div class="comparison-status mismatch">${escapeHtml(test.errorMessage)}</div>` : ''}
                        ${!test.failureMessage && !test.errorMessage ? `<div style="color: var(--text-secondary);">Test passed in ${(test.time || 0).toFixed(3)}s</div>` : ''}
                    </div>
                </div>
            `;
        }

        function renderQueryTestCard(test) {
            const statusClass = (test.status || 'na').toLowerCase();
            const statusBadge = `<span class="status-badge ${statusClass}">${test.status}</span>`;
            const matchType = test.matchType || '';
            const matchIndicator = matchType ? `<span class="match-indicator ${matchType}" title="Match: ${matchType}"></span>` : '';

            return `
                <div class="test-card status-${statusClass}" data-test-id="${test.id}">
                    <div class="test-header">
                        <div class="test-info">
                            <span class="test-id">${test.id}</span>
                            <span class="test-name">${escapeHtml(test.name)}</span>
                            ${test.operator ? `<span class="test-operator">${test.operator}</span>` : ''}
                        </div>
                        <div class="test-meta">
                            ${statusBadge}${matchIndicator}
                            <span class="count-badge">MongoDB: ${test.mongodbCount || 'N/A'} | Oracle: ${test.oracleCount || 'N/A'}</span>
                            <span class="expand-icon">&#9660;</span>
                        </div>
                    </div>
                    <div class="test-details">
                        ${test.description ? `<div class="test-description">${escapeHtml(test.description)}</div>` : ''}

                        <div class="code-tabs">
                            <button class="code-tab active" data-tab="pipeline">MongoDB Pipeline</button>
                            <button class="code-tab" data-tab="sql">Generated SQL</button>
                        </div>
                        <div class="code-panels">
                            <div class="code-panel active" data-panel="pipeline">
                                <pre class="json-code">${escapeHtml(test.pipelineFormatted || JSON.stringify(test.pipeline, null, 2))}</pre>
                            </div>
                            <div class="code-panel" data-panel="sql">
                                <pre class="sql-code">${escapeHtml(test.sqlFormatted || test.sql || '-- No SQL generated')}</pre>
                            </div>
                        </div>

                        <div class="results-section">
                            <div class="results-header">
                                <h4>Test Results</h4>
                                <button class="run-test-btn" ${test.skip ? 'disabled title="Test is skipped"' : ''}>Run Test</button>
                            </div>
                            <div class="results-grid">
                                <div class="result-panel">
                                    <div class="result-panel-header">
                                        <h5>MongoDB Results</h5>
                                        <span class="count">${test.mongodbCount || 'N/A'} docs</span>
                                    </div>
                                    <div class="result-panel-content">
                                        ${test.mongodbResults ? `<pre>${escapeHtml(JSON.stringify(test.mongodbResults, null, 2))}</pre>` : '<em>Run test to see results</em>'}
                                    </div>
                                </div>
                                <div class="result-panel">
                                    <div class="result-panel-header">
                                        <h5>Oracle Results</h5>
                                        <span class="count">${test.oracleCount || 'N/A'} docs</span>
                                    </div>
                                    <div class="result-panel-content">
                                        ${test.oracleResults ? `<pre>${escapeHtml(JSON.stringify(test.oracleResults, null, 2))}</pre>` : '<em>Run test to see results</em>'}
                                    </div>
                                </div>
                            </div>
                            ${test.comparisonResult ? `<div class="comparison-status ${test.comparisonResult.includes('MATCH') ? 'match' : 'mismatch'}">${escapeHtml(test.comparisonResult)}</div>` : ''}
                        </div>
                    </div>
                </div>
            `;
        }

        function showRunTestModal(testId) {
            const command = `./query-tests/scripts/run-tests.sh --test ${testId}`;
            document.getElementById('runTestId').textContent = testId;
            document.getElementById('runTestCommand').textContent = command;
            document.getElementById('runTestModal').classList.add('show');
        }

        function escapeHtml(text) {
            if (!text) return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function attachCardListeners() {
            document.querySelectorAll('.test-card').forEach(card => {
                const header = card.querySelector('.test-header');
                header.addEventListener('click', () => card.classList.toggle('expanded'));

                card.querySelectorAll('.code-tab').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const tabId = tab.dataset.tab;
                        card.querySelectorAll('.code-tab').forEach(t => t.classList.remove('active'));
                        card.querySelectorAll('.code-panel').forEach(p => p.classList.remove('active'));
                        tab.classList.add('active');
                        card.querySelector(`.code-panel[data-panel="${tabId}"]`)?.classList.add('active');
                    });
                });

                const runBtn = card.querySelector('.run-test-btn');
                if (runBtn) {
                    runBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        showRunTestModal(card.dataset.testId);
                    });
                }
            });
        }

        function setupEventListeners() {
            document.getElementById('searchInput').addEventListener('input', (e) => {
                searchQuery = e.target.value;
                renderTests();
            });

            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentFilter = btn.dataset.filter;
                    renderTests();
                });
            });

            document.getElementById('suiteTabs').addEventListener('click', (e) => {
                const tab = e.target.closest('.suite-tab');
                if (!tab) return;
                document.querySelectorAll('.suite-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                currentSuite = tab.dataset.suite;
                currentCategory = 'all';
                updateSummary();
                buildCategoryTabs();
                renderTests();
            });

            document.getElementById('categoryTabs').addEventListener('click', (e) => {
                const tab = e.target.closest('.category-tab');
                if (!tab) return;
                document.querySelectorAll('.category-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                currentCategory = tab.dataset.category;
                renderTests();
            });

            document.getElementById('settingsBtn').addEventListener('click', () => document.getElementById('settingsModal').classList.add('show'));
            document.getElementById('cancelSettings').addEventListener('click', () => document.getElementById('settingsModal').classList.remove('show'));
            document.getElementById('saveSettings').addEventListener('click', () => {
                localStorage.setItem('mongoUri', document.getElementById('mongoUri').value);
                localStorage.setItem('oracleUrl', document.getElementById('oracleUrl').value);
                localStorage.setItem('oracleUser', document.getElementById('oracleUser').value);
                localStorage.setItem('oraclePassword', document.getElementById('oraclePassword').value);
                document.getElementById('settingsModal').classList.remove('show');
            });

            ['mongoUri', 'oracleUrl', 'oracleUser', 'oraclePassword'].forEach(key => {
                const saved = localStorage.getItem(key);
                if (saved) document.getElementById(key).value = saved;
            });

            document.getElementById('settingsModal').addEventListener('click', (e) => {
                if (e.target === document.getElementById('settingsModal')) {
                    document.getElementById('settingsModal').classList.remove('show');
                }
            });

            // Run test modal event listeners
            document.getElementById('closeRunTest').addEventListener('click', () => {
                document.getElementById('runTestModal').classList.remove('show');
            });
            document.getElementById('copyRunCommand').addEventListener('click', () => {
                const command = document.getElementById('runTestCommand').textContent;
                navigator.clipboard.writeText(command).then(() => {
                    const btn = document.getElementById('copyRunCommand');
                    const originalText = btn.textContent;
                    btn.textContent = 'Copied!';
                    btn.style.background = 'var(--success)';
                    setTimeout(() => {
                        btn.textContent = originalText;
                        btn.style.background = '';
                    }, 2000);
                });
            });
            document.getElementById('runTestModal').addEventListener('click', (e) => {
                if (e.target === document.getElementById('runTestModal')) {
                    document.getElementById('runTestModal').classList.remove('show');
                }
            });
        }

        document.addEventListener('DOMContentLoaded', loadTestData);
    </script>
</body>
</html>
