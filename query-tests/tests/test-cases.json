{
  "version": "1.0",
  "description": "Comprehensive test cases for MongoPLSQL-Bridge operator validation",
  "test_cases": [
    {
      "id": "CMP001",
      "name": "Equality match - string",
      "category": "comparison",
      "operator": "$eq",
      "description": "Tests $eq operator with string field",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "status": "completed"
          }
        },
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "status": 1
          }
        }
      ],
      "expected_count": 5,
      "sort_by": "_id"
    },
    {
      "id": "CMP002",
      "name": "Greater than - numeric",
      "category": "comparison",
      "operator": "$gt",
      "description": "Tests $gt operator with numeric field",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "amount": {
              "$gt": 200
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "amount": 1
          }
        }
      ],
      "expected_count": 5,
      "sort_by": "_id"
    },
    {
      "id": "CMP003",
      "name": "Greater than or equal - numeric",
      "category": "comparison",
      "operator": "$gte",
      "description": "Tests $gte operator with numeric field",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$match": {
            "salary": {
              "$gte": 90000
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "salary": 1
          }
        }
      ],
      "expected_count": 3,
      "sort_by": "_id"
    },
    {
      "id": "CMP004",
      "name": "Less than - numeric",
      "category": "comparison",
      "operator": "$lt",
      "description": "Tests $lt operator with numeric field",
      "collection": "products",
      "mongodb_pipeline": [
        {
          "$match": {
            "price": {
              "$lt": 50
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "price": 1
          }
        }
      ],
      "expected_count": 4,
      "sort_by": "_id"
    },
    {
      "id": "CMP005",
      "name": "Less than or equal - numeric",
      "category": "comparison",
      "operator": "$lte",
      "description": "Tests $lte operator with numeric field",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$match": {
            "yearsOfService": {
              "$lte": 2
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "yearsOfService": 1
          }
        }
      ],
      "expected_count": 4,
      "sort_by": "_id"
    },
    {
      "id": "CMP006",
      "name": "Not equal - string",
      "category": "comparison",
      "operator": "$ne",
      "description": "Tests $ne operator with string field",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "status": {
              "$ne": "completed"
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "status": 1
          }
        }
      ],
      "expected_count": 5,
      "sort_by": "_id"
    },
    {
      "id": "CMP007",
      "name": "In array - string values",
      "category": "comparison",
      "operator": "$in",
      "description": "Tests $in operator with array of strings",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "status": {
              "$in": [
                "completed",
                "pending"
              ]
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "status": 1
          }
        }
      ],
      "expected_count": 7,
      "sort_by": "_id"
    },
    {
      "id": "CMP008",
      "name": "Not in array - string values",
      "category": "comparison",
      "operator": "$nin",
      "description": "Tests $nin operator with array of strings",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "region": {
              "$nin": [
                "north",
                "south"
              ]
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "region": 1
          }
        }
      ],
      "expected_count": 4,
      "sort_by": "_id"
    },
    {
      "id": "LOG001",
      "name": "Logical AND - two conditions",
      "category": "logical",
      "operator": "$and",
      "description": "Tests $and operator with two conditions",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "$and": [
              {
                "status": "completed"
              },
              {
                "category": "electronics"
              }
            ]
          }
        },
        {
          "$project": {
            "_id": 1,
            "status": 1,
            "category": 1
          }
        }
      ],
      "expected_count": 3,
      "sort_by": "_id"
    },
    {
      "id": "LOG002",
      "name": "Logical AND - three conditions",
      "category": "logical",
      "operator": "$and",
      "description": "Tests $and operator with three conditions",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$match": {
            "$and": [
              {
                "department": "Engineering"
              },
              {
                "active": true
              },
              {
                "salary": {
                  "$gte": 90000
                }
              }
            ]
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "department": 1,
            "salary": 1
          }
        }
      ],
      "expected_count": 3,
      "sort_by": "_id"
    },
    {
      "id": "LOG003",
      "name": "Logical OR - two conditions",
      "category": "logical",
      "operator": "$or",
      "description": "Tests $or operator with two conditions",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "$or": [
              {
                "status": "cancelled"
              },
              {
                "status": "refunded"
              }
            ]
          }
        },
        {
          "$project": {
            "_id": 1,
            "status": 1
          }
        }
      ],
      "expected_count": 2,
      "sort_by": "_id"
    },
    {
      "id": "LOG004",
      "name": "Logical OR with AND",
      "category": "logical",
      "operator": "$or/$and",
      "description": "Tests combination of $or and $and operators",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$match": {
            "$or": [
              {
                "department": "Engineering"
              },
              {
                "$and": [
                  {
                    "department": "Sales"
                  },
                  {
                    "active": true
                  }
                ]
              }
            ]
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "department": 1
          }
        }
      ],
      "expected_count": 6,
      "sort_by": "_id"
    },
    {
      "id": "LOG005",
      "name": "Logical NOT",
      "category": "logical",
      "operator": "$not",
      "description": "Tests $not operator",
      "collection": "products",
      "mongodb_pipeline": [
        {
          "$match": {
            "price": {
              "$not": {
                "$gt": 100
              }
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "price": 1
          }
        }
      ],
      "expected_count": 5,
      "sort_by": "_id"
    },
    {
      "id": "AGG001",
      "name": "Group with count",
      "category": "accumulator",
      "operator": "$count",
      "description": "Tests $group with $sum: 1 for counting",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$group": {
            "_id": "$status",
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 5,
      "sort_by": "_id"
    },
    {
      "id": "AGG002",
      "name": "Group with sum",
      "category": "accumulator",
      "operator": "$sum",
      "description": "Tests $group with $sum on numeric field",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "status": "completed"
          }
        },
        {
          "$group": {
            "_id": "$category",
            "totalAmount": {
              "$sum": "$amount"
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 3,
      "sort_by": "_id"
    },
    {
      "id": "AGG003",
      "name": "Group with average",
      "category": "accumulator",
      "operator": "$avg",
      "description": "Tests $group with $avg on numeric field",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$group": {
            "_id": "$department",
            "avgSalary": {
              "$avg": "$salary"
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 4,
      "sort_by": "_id"
    },
    {
      "id": "AGG004",
      "name": "Group with min",
      "category": "accumulator",
      "operator": "$min",
      "description": "Tests $group with $min on numeric field",
      "collection": "products",
      "mongodb_pipeline": [
        {
          "$match": {
            "active": true
          }
        },
        {
          "$group": {
            "_id": "$category",
            "minPrice": {
              "$min": "$price"
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 3,
      "sort_by": "_id"
    },
    {
      "id": "AGG005",
      "name": "Group with max",
      "category": "accumulator",
      "operator": "$max",
      "description": "Tests $group with $max on numeric field",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$group": {
            "_id": "$department",
            "maxSalary": {
              "$max": "$salary"
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 4,
      "sort_by": "_id"
    },
    {
      "id": "AGG006",
      "name": "Group with multiple accumulators",
      "category": "accumulator",
      "operator": "$sum/$avg/$min/$max",
      "description": "Tests $group with multiple accumulators",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$group": {
            "_id": "$department",
            "count": {
              "$sum": 1
            },
            "totalSalary": {
              "$sum": "$salary"
            },
            "avgSalary": {
              "$avg": "$salary"
            },
            "minSalary": {
              "$min": "$salary"
            },
            "maxSalary": {
              "$max": "$salary"
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 4,
      "sort_by": "_id"
    },
    {
      "id": "STG001",
      "name": "Limit results",
      "category": "stage",
      "operator": "$limit",
      "description": "Tests $limit stage",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$sort": {
            "orderId": 1
          }
        },
        {
          "$limit": 3
        },
        {
          "$project": {
            "_id": 1,
            "orderId": 1
          }
        }
      ],
      "expected_count": 3,
      "sort_by": "orderId"
    },
    {
      "id": "STG002",
      "name": "Skip results",
      "category": "stage",
      "operator": "$skip",
      "description": "Tests $skip stage",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$sort": {
            "name": 1
          }
        },
        {
          "$skip": 5
        },
        {
          "$project": {
            "_id": 1,
            "name": 1
          }
        }
      ],
      "expected_count": 5,
      "sort_by": "name"
    },
    {
      "id": "STG003",
      "name": "Skip and limit combined",
      "category": "stage",
      "operator": "$skip/$limit",
      "description": "Tests $skip and $limit stages combined (pagination)",
      "collection": "products",
      "mongodb_pipeline": [
        {
          "$sort": {
            "price": -1
          }
        },
        {
          "$skip": 2
        },
        {
          "$limit": 3
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "price": 1
          }
        }
      ],
      "expected_count": 3,
      "sort_by": null
    },
    {
      "id": "STG004",
      "name": "Sort ascending",
      "category": "stage",
      "operator": "$sort",
      "description": "Tests $sort stage with ascending order",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$sort": {
            "salary": 1
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "salary": 1
          }
        }
      ],
      "expected_count": 10,
      "sort_by": null
    },
    {
      "id": "STG005",
      "name": "Sort descending",
      "category": "stage",
      "operator": "$sort",
      "description": "Tests $sort stage with descending order",
      "collection": "products",
      "mongodb_pipeline": [
        {
          "$match": {
            "active": true
          }
        },
        {
          "$sort": {
            "price": -1
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "price": 1
          }
        }
      ],
      "expected_count": 7,
      "sort_by": null
    },
    {
      "id": "STG006",
      "name": "Sort with multiple fields",
      "category": "stage",
      "operator": "$sort",
      "description": "Tests $sort stage with multiple fields",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$sort": {
            "department": 1,
            "salary": -1
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "department": 1,
            "salary": 1
          }
        }
      ],
      "expected_count": 10,
      "sort_by": null
    },
    {
      "id": "STG007",
      "name": "Project include fields",
      "category": "stage",
      "operator": "$project",
      "description": "Tests $project stage with field inclusion",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "status": "completed"
          }
        },
        {
          "$project": {
            "orderId": 1,
            "amount": 1,
            "tax": 1,
            "_id": 0
          }
        },
        {
          "$sort": {
            "orderId": 1
          }
        }
      ],
      "expected_count": 5,
      "sort_by": "orderId"
    },
    {
      "id": "ARITH001",
      "name": "Addition in project",
      "category": "arithmetic",
      "operator": "$add",
      "description": "Tests $add operator in projection",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "status": "completed"
          }
        },
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "total": {
              "$add": [
                "$amount",
                "$tax"
              ]
            }
          }
        },
        {
          "$sort": {
            "orderId": 1
          }
        }
      ],
      "expected_count": 5,
      "sort_by": "orderId"
    },
    {
      "id": "ARITH002",
      "name": "Subtraction in project",
      "category": "arithmetic",
      "operator": "$subtract",
      "description": "Tests $subtract operator in projection",
      "collection": "products",
      "mongodb_pipeline": [
        {
          "$match": {
            "active": true
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "profit": {
              "$subtract": [
                "$price",
                "$cost"
              ]
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 7,
      "sort_by": "_id"
    },
    {
      "id": "ARITH003",
      "name": "Multiplication in project",
      "category": "arithmetic",
      "operator": "$multiply",
      "description": "Tests $multiply operator in projection",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "totalComp": {
              "$add": [
                "$salary",
                {
                  "$multiply": [
                    "$bonus",
                    1
                  ]
                }
              ]
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 10,
      "sort_by": "_id"
    },
    {
      "id": "ARITH004",
      "name": "Division in project",
      "category": "arithmetic",
      "operator": "$divide",
      "description": "Tests $divide operator in projection",
      "collection": "products",
      "mongodb_pipeline": [
        {
          "$match": {
            "cost": {
              "$gt": 0
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "margin": {
              "$divide": [
                {
                  "$subtract": [
                    "$price",
                    "$cost"
                  ]
                },
                "$cost"
              ]
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 8,
      "sort_by": "_id"
    },
    {
      "id": "ARITH005",
      "name": "Modulo in project",
      "category": "arithmetic",
      "operator": "$mod",
      "description": "Tests $mod operator in projection",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "orderIdMod3": {
              "$mod": [
                "$orderId",
                3
              ]
            }
          }
        },
        {
          "$sort": {
            "orderId": 1
          }
        }
      ],
      "expected_count": 10,
      "sort_by": "orderId"
    },
    {
      "id": "COND001",
      "name": "Conditional with $cond",
      "category": "conditional",
      "operator": "$cond",
      "description": "Tests $cond operator for conditional logic",
      "collection": "products",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "priceCategory": {
              "$cond": {
                "if": {
                  "$gte": [
                    "$price",
                    100
                  ]
                },
                "then": "expensive",
                "else": "affordable"
              }
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 8,
      "sort_by": "_id"
    },
    {
      "id": "COND002",
      "name": "IfNull handling",
      "category": "conditional",
      "operator": "$ifNull",
      "description": "Tests $ifNull operator for null handling",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "discountApplied": {
              "$ifNull": [
                "$discount",
                0
              ]
            }
          }
        },
        {
          "$sort": {
            "orderId": 1
          }
        }
      ],
      "expected_count": 10,
      "sort_by": "orderId"
    },
    {
      "id": "COMPLEX001",
      "name": "Complex pipeline - match, group, sort",
      "category": "complex",
      "operator": "multiple",
      "description": "Tests complex pipeline with multiple stages",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "status": {
              "$in": [
                "completed",
                "processing"
              ]
            }
          }
        },
        {
          "$group": {
            "_id": "$region",
            "totalSales": {
              "$sum": "$amount"
            },
            "orderCount": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "totalSales": -1
          }
        }
      ],
      "expected_count": 4,
      "sort_by": null
    },
    {
      "id": "COMPLEX002",
      "name": "Complex pipeline - filter, project, sort, limit",
      "category": "complex",
      "operator": "multiple",
      "description": "Tests complex pipeline with filter, projection, sort, and limit",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$match": {
            "active": true
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "department": 1,
            "totalComp": {
              "$add": [
                "$salary",
                "$bonus"
              ]
            }
          }
        },
        {
          "$sort": {
            "totalComp": -1
          }
        },
        {
          "$limit": 5
        }
      ],
      "expected_count": 5,
      "sort_by": null
    },
    {
      "id": "COMPLEX003",
      "name": "Complex pipeline - nested AND/OR",
      "category": "complex",
      "operator": "multiple",
      "description": "Tests complex pipeline with nested logical operators",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "$and": [
              {
                "$or": [
                  {
                    "category": "electronics"
                  },
                  {
                    "category": "jewelry"
                  }
                ]
              },
              {
                "amount": {
                  "$gte": 100
                }
              }
            ]
          }
        },
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "category": 1,
            "amount": 1
          }
        },
        {
          "$sort": {
            "amount": -1
          }
        }
      ],
      "expected_count": 5,
      "sort_by": null
    },
    {
      "id": "EDGE001",
      "name": "Zero values in aggregation",
      "category": "edge",
      "operator": "$sum",
      "description": "Tests aggregation with zero values",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "quantity": 0
          }
        },
        {
          "$group": {
            "_id": null,
            "totalAmount": {
              "$sum": "$amount"
            }
          }
        }
      ],
      "expected_count": 1,
      "sort_by": null
    },
    {
      "id": "EDGE002",
      "name": "Negative values in aggregation",
      "category": "edge",
      "operator": "$sum",
      "description": "Tests aggregation with negative values",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "amount": {
              "$lt": 0
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "totalRefunds": {
              "$sum": "$amount"
            }
          }
        }
      ],
      "expected_count": 1,
      "sort_by": null
    },
    {
      "id": "EDGE003",
      "name": "Empty result set",
      "category": "edge",
      "operator": "$match",
      "description": "Tests query that returns no results",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "status": "nonexistent_status"
          }
        },
        {
          "$project": {
            "_id": 1
          }
        }
      ],
      "expected_count": 0,
      "sort_by": null
    },
    {
      "id": "STR001",
      "name": "String concatenation",
      "category": "string",
      "operator": "$concat",
      "description": "Tests $concat operator to join strings",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "fullInfo": {
              "$concat": [
                "$name",
                " - ",
                "$department"
              ]
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 10,
      "sort_by": "_id"
    },
    {
      "id": "STR002",
      "name": "String to lowercase",
      "category": "string",
      "operator": "$toLower",
      "description": "Tests $toLower operator",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "deptLower": {
              "$toLower": "$department"
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 10,
      "sort_by": "_id"
    },
    {
      "id": "STR003",
      "name": "String to uppercase",
      "category": "string",
      "operator": "$toUpper",
      "description": "Tests $toUpper operator",
      "collection": "products",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "nameUpper": {
              "$toUpper": "$name"
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 8,
      "sort_by": "_id"
    },
    {
      "id": "STR004",
      "name": "Substring extraction",
      "category": "string",
      "operator": "$substr",
      "description": "Tests $substr operator to extract part of string",
      "collection": "customers",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "namePrefix": {
              "$substr": [
                "$name",
                0,
                4
              ]
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 7,
      "sort_by": "_id"
    },
    {
      "id": "STR005",
      "name": "String length",
      "category": "string",
      "operator": "$strLenCP",
      "description": "Tests $strLenCP operator to get string length",
      "collection": "products",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "nameLength": {
              "$strLenCP": "$name"
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 8,
      "sort_by": "_id"
    },
    {
      "id": "STR006",
      "name": "String trim",
      "category": "string",
      "operator": "$trim",
      "description": "Tests $trim operator (using existing data)",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "trimmedName": {
              "$trim": {
                "input": "$name"
              }
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 10,
      "sort_by": "_id"
    },
    {
      "id": "DATE001",
      "name": "Extract year from date",
      "category": "date",
      "operator": "$year",
      "description": "Tests $year operator to extract year component",
      "collection": "events",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "title": 1,
            "eventYear": {
              "$year": "$eventDate"
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 8,
      "sort_by": "_id"
    },
    {
      "id": "DATE002",
      "name": "Extract month from date",
      "category": "date",
      "operator": "$month",
      "description": "Tests $month operator to extract month component",
      "collection": "events",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "title": 1,
            "eventMonth": {
              "$month": "$eventDate"
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 8,
      "sort_by": "_id"
    },
    {
      "id": "DATE003",
      "name": "Extract day from date",
      "category": "date",
      "operator": "$dayOfMonth",
      "description": "Tests $dayOfMonth operator to extract day component",
      "collection": "events",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "title": 1,
            "eventDay": {
              "$dayOfMonth": "$eventDate"
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 8,
      "sort_by": "_id"
    },
    {
      "id": "DATE004",
      "name": "Extract hour from date",
      "category": "date",
      "operator": "$hour",
      "description": "Tests $hour operator to extract hour component",
      "collection": "events",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "title": 1,
            "eventHour": {
              "$hour": "$eventDate"
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 8,
      "sort_by": "_id"
    },
    {
      "id": "DATE005",
      "name": "Group events by month",
      "category": "date",
      "operator": "$month/$group",
      "description": "Tests $month with $group for monthly aggregation",
      "collection": "events",
      "mongodb_pipeline": [
        {
          "$group": {
            "_id": {
              "$month": "$eventDate"
            },
            "eventCount": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 8,
      "sort_by": "_id"
    },
    {
      "id": "ARR001",
      "name": "Get first array element",
      "category": "array",
      "operator": "$arrayElemAt",
      "description": "Tests $arrayElemAt to get first element",
      "collection": "products",
      "mongodb_pipeline": [
        {
          "$match": {
            "tags": {
              "$ne": []
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "firstTag": {
              "$arrayElemAt": [
                "$tags",
                0
              ]
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 7,
      "sort_by": "_id"
    },
    {
      "id": "ARR002",
      "name": "Get array size",
      "category": "array",
      "operator": "$size",
      "description": "Tests $size operator to get array length",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "itemCount": {
              "$size": "$items"
            }
          }
        },
        {
          "$sort": {
            "orderId": 1
          }
        }
      ],
      "expected_count": 10,
      "sort_by": "orderId"
    },
    {
      "id": "ARR003",
      "name": "Array first element with $first",
      "category": "array",
      "operator": "$first",
      "description": "Tests $first operator as array accessor",
      "collection": "products",
      "mongodb_pipeline": [
        {
          "$match": {
            "tags": {
              "$ne": []
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "firstTag": {
              "$first": "$tags"
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 7,
      "sort_by": "_id"
    },
    {
      "id": "ARR004",
      "name": "Array last element with $last",
      "category": "array",
      "operator": "$last",
      "description": "Tests $last operator as array accessor",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "tags": {
              "$ne": []
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "lastTag": {
              "$last": "$tags"
            }
          }
        },
        {
          "$sort": {
            "orderId": 1
          }
        }
      ],
      "expected_count": 8,
      "sort_by": "orderId"
    },
    {
      "id": "LOOKUP001",
      "name": "Basic $lookup join",
      "category": "lookup",
      "operator": "$lookup",
      "description": "Tests $lookup stage for basic left outer join",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "status": "completed"
          }
        },
        {
          "$lookup": {
            "from": "customers",
            "localField": "customerId",
            "foreignField": "_id",
            "as": "customerInfo"
          }
        },
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "customerTier": {
              "$arrayElemAt": [
                "$customerInfo.tier",
                0
              ]
            }
          }
        },
        {
          "$sort": {
            "orderId": 1
          }
        }
      ],
      "expected_count": 5,
      "sort_by": "orderId"
    },
    {
      "id": "LOOKUP002",
      "name": "$lookup with inventory",
      "category": "lookup",
      "operator": "$lookup",
      "description": "Tests $lookup stage joining products with inventory",
      "collection": "products",
      "mongodb_pipeline": [
        {
          "$match": {
            "active": true
          }
        },
        {
          "$lookup": {
            "from": "inventory",
            "localField": "_id",
            "foreignField": "productId",
            "as": "inventoryRecords"
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "warehouseCount": {
              "$size": "$inventoryRecords"
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 7,
      "sort_by": "_id"
    },
    {
      "id": "UNWIND001",
      "name": "Basic $unwind array",
      "category": "unwind",
      "operator": "$unwind",
      "description": "Tests $unwind stage to flatten array",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "orderId": 1001
          }
        },
        {
          "$unwind": "$items"
        },
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "product": "$items.product",
            "qty": "$items.qty"
          }
        }
      ],
      "expected_count": 2,
      "sort_by": null
    },
    {
      "id": "UNWIND002",
      "name": "$unwind with preserveNullAndEmptyArrays",
      "category": "unwind",
      "operator": "$unwind",
      "description": "Tests $unwind with empty array preservation",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "orderId": {
              "$in": [
                1001,
                1007
              ]
            }
          }
        },
        {
          "$unwind": {
            "path": "$tags",
            "preserveNullAndEmptyArrays": true
          }
        },
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "tag": "$tags"
          }
        },
        {
          "$sort": {
            "orderId": 1
          }
        }
      ],
      "expected_count": 3,
      "sort_by": "orderId"
    },
    {
      "id": "ADDFIELDS001",
      "name": "Add computed field",
      "category": "addFields",
      "operator": "$addFields",
      "description": "Tests $addFields stage to add computed column",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$addFields": {
            "totalCompensation": {
              "$add": [
                "$salary",
                "$bonus"
              ]
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "totalCompensation": 1
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 10,
      "sort_by": "_id"
    },
    {
      "id": "ADDFIELDS002",
      "name": "$set as alias for $addFields",
      "category": "addFields",
      "operator": "$set",
      "description": "Tests $set stage (alias for $addFields)",
      "collection": "products",
      "mongodb_pipeline": [
        {
          "$match": {
            "active": true
          }
        },
        {
          "$set": {
            "profitMargin": {
              "$subtract": [
                "$price",
                "$cost"
              ]
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "profitMargin": 1
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 7,
      "sort_by": "_id"
    },
    {
      "id": "AGG007",
      "name": "Group with $push",
      "category": "accumulator",
      "operator": "$push",
      "description": "Tests $group with $push to collect values into array",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$group": {
            "_id": "$department",
            "employees": {
              "$push": "$name"
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 4,
      "sort_by": "_id"
    },
    {
      "id": "AGG008",
      "name": "Group with $addToSet",
      "category": "accumulator",
      "operator": "$addToSet",
      "description": "Tests $group with $addToSet to collect unique values",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$group": {
            "_id": "$region",
            "statuses": {
              "$addToSet": "$status"
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 4,
      "sort_by": "_id"
    },
    {
      "id": "COND003",
      "name": "Nested $cond expressions",
      "category": "conditional",
      "operator": "$cond",
      "description": "Tests nested $cond for multi-branch logic",
      "collection": "products",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "priceRange": {
              "$cond": {
                "if": {
                  "$gte": [
                    "$price",
                    200
                  ]
                },
                "then": "high",
                "else": {
                  "$cond": {
                    "if": {
                      "$gte": [
                        "$price",
                        50
                      ]
                    },
                    "then": "medium",
                    "else": "low"
                  }
                }
              }
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 8,
      "sort_by": "_id"
    },
    {
      "id": "COMPLEX004",
      "name": "Complex pipeline - lookup with group",
      "category": "complex",
      "operator": "multiple",
      "description": "Tests complex pipeline combining $lookup and $group",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "status": "completed"
          }
        },
        {
          "$lookup": {
            "from": "customers",
            "localField": "customerId",
            "foreignField": "_id",
            "as": "customer"
          }
        },
        {
          "$unwind": "$customer"
        },
        {
          "$group": {
            "_id": "$customer.tier",
            "totalAmount": {
              "$sum": "$amount"
            },
            "orderCount": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 3,
      "sort_by": "_id"
    },
    {
      "id": "COMPLEX005",
      "name": "Complex pipeline - string operations with grouping",
      "category": "complex",
      "operator": "multiple",
      "description": "Tests complex pipeline with string operations and grouping",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$addFields": {
            "deptUpper": {
              "$toUpper": "$department"
            }
          }
        },
        {
          "$group": {
            "_id": "$deptUpper",
            "avgSalary": {
              "$avg": "$salary"
            },
            "headcount": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 4,
      "sort_by": "_id"
    },
    {
      "id": "UNION001",
      "name": "Basic $unionWith - two collections",
      "category": "unionWith",
      "operator": "$unionWith",
      "description": "Tests $unionWith to combine employees and customers (names from both)",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "source": {
              "$literal": "employee"
            }
          }
        },
        {
          "$unionWith": {
            "coll": "customers",
            "pipeline": [
              {
                "$project": {
                  "_id": 1,
                  "name": 1,
                  "source": {
                    "$literal": "customer"
                  }
                }
              }
            ]
          }
        },
        {
          "$sort": {
            "source": 1,
            "name": 1
          }
        },
        {
          "$limit": 10
        }
      ],
      "expected_count": 10,
      "sort_by": null
    },
    {
      "id": "UNION002",
      "name": "$unionWith with match filter",
      "category": "unionWith",
      "operator": "$unionWith",
      "description": "Tests $unionWith with $match in sub-pipeline",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "status": "completed"
          }
        },
        {
          "$project": {
            "_id": 1,
            "amount": 1,
            "category": 1
          }
        },
        {
          "$unionWith": {
            "coll": "sales",
            "pipeline": [
              {
                "$match": {
                  "status": "pending"
                }
              },
              {
                "$project": {
                  "_id": 1,
                  "amount": 1,
                  "category": 1
                }
              }
            ]
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 7,
      "sort_by": "_id"
    },
    {
      "id": "UNION003",
      "name": "$unionWith with aggregation",
      "category": "unionWith",
      "operator": "$unionWith",
      "description": "Tests $unionWith followed by group aggregation",
      "collection": "products",
      "mongodb_pipeline": [
        {
          "$match": {
            "category": "electronics"
          }
        },
        {
          "$project": {
            "_id": 1,
            "price": 1
          }
        },
        {
          "$unionWith": {
            "coll": "products",
            "pipeline": [
              {
                "$match": {
                  "category": "tools"
                }
              },
              {
                "$project": {
                  "_id": 1,
                  "price": 1
                }
              }
            ]
          }
        },
        {
          "$group": {
            "_id": null,
            "totalProducts": {
              "$sum": 1
            },
            "avgPrice": {
              "$avg": "$price"
            }
          }
        }
      ],
      "expected_count": 1,
      "sort_by": null
    },
    {
      "id": "BUCKET001",
      "name": "Basic $bucket - price ranges",
      "category": "bucket",
      "operator": "$bucket",
      "description": "Tests $bucket to group products by price ranges (no default needed - all values covered)",
      "collection": "products",
      "mongodb_pipeline": [
        {
          "$bucket": {
            "groupBy": "$price",
            "boundaries": [
              0,
              25,
              100,
              1000
            ],
            "output": {
              "count": {
                "$sum": 1
              },
              "products": {
                "$push": "$name"
              }
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 3,
      "sort_by": "_id"
    },
    {
      "id": "BUCKET002",
      "name": "$bucket - salary bands",
      "category": "bucket",
      "operator": "$bucket",
      "description": "Tests $bucket to group employees by salary bands (all values covered)",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$bucket": {
            "groupBy": "$salary",
            "boundaries": [
              60000,
              75000,
              90000,
              110000
            ],
            "output": {
              "count": {
                "$sum": 1
              },
              "avgBonus": {
                "$avg": "$bonus"
              }
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 3,
      "sort_by": "_id"
    },
    {
      "id": "BUCKETAUTO001",
      "name": "Basic $bucketAuto - auto price groups",
      "category": "bucketAuto",
      "operator": "$bucketAuto",
      "description": "Tests $bucketAuto to automatically group products by price",
      "collection": "products",
      "mongodb_pipeline": [
        {
          "$match": {
            "active": true
          }
        },
        {
          "$bucketAuto": {
            "groupBy": "$price",
            "buckets": 3,
            "output": {
              "count": {
                "$sum": 1
              },
              "avgPrice": {
                "$avg": "$price"
              }
            }
          }
        }
      ],
      "expected_count": 3,
      "sort_by": null
    },
    {
      "id": "BUCKETAUTO002",
      "name": "$bucketAuto - employee salary distribution",
      "category": "bucketAuto",
      "operator": "$bucketAuto",
      "description": "Tests $bucketAuto to distribute employees into salary quartiles",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$bucketAuto": {
            "groupBy": "$salary",
            "buckets": 4,
            "output": {
              "count": {
                "$sum": 1
              },
              "minSalary": {
                "$min": "$salary"
              },
              "maxSalary": {
                "$max": "$salary"
              }
            }
          }
        }
      ],
      "expected_count": 4,
      "sort_by": null
    },
    {
      "id": "FACET001",
      "name": "Basic $facet - multiple aggregations",
      "category": "facet",
      "operator": "$facet",
      "description": "Tests $facet for parallel aggregation pipelines",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$facet": {
            "byStatus": [
              {
                "$group": {
                  "_id": "$status",
                  "count": {
                    "$sum": 1
                  }
                }
              },
              {
                "$sort": {
                  "_id": 1
                }
              }
            ],
            "byRegion": [
              {
                "$group": {
                  "_id": "$region",
                  "totalAmount": {
                    "$sum": "$amount"
                  }
                }
              },
              {
                "$sort": {
                  "_id": 1
                }
              }
            ]
          }
        }
      ],
      "expected_count": 1,
      "sort_by": null
    },
    {
      "id": "FACET002",
      "name": "$facet - product analysis",
      "category": "facet",
      "operator": "$facet",
      "description": "Tests $facet for multi-faceted product analysis",
      "collection": "products",
      "mongodb_pipeline": [
        {
          "$match": {
            "active": true
          }
        },
        {
          "$facet": {
            "categorySummary": [
              {
                "$group": {
                  "_id": "$category",
                  "count": {
                    "$sum": 1
                  },
                  "avgPrice": {
                    "$avg": "$price"
                  }
                }
              },
              {
                "$sort": {
                  "_id": 1
                }
              }
            ],
            "priceStats": [
              {
                "$group": {
                  "_id": null,
                  "minPrice": {
                    "$min": "$price"
                  },
                  "maxPrice": {
                    "$max": "$price"
                  },
                  "avgPrice": {
                    "$avg": "$price"
                  }
                }
              }
            ]
          }
        }
      ],
      "expected_count": 1,
      "sort_by": null
    },
    {
      "id": "FACET003",
      "name": "$facet - employee dashboard",
      "category": "facet",
      "operator": "$facet",
      "description": "Tests $facet for employee dashboard with multiple views",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$facet": {
            "departmentCounts": [
              {
                "$group": {
                  "_id": "$department",
                  "count": {
                    "$sum": 1
                  }
                }
              },
              {
                "$sort": {
                  "count": -1
                }
              }
            ],
            "topEarners": [
              {
                "$sort": {
                  "salary": -1
                }
              },
              {
                "$limit": 3
              },
              {
                "$project": {
                  "_id": 1,
                  "name": 1,
                  "salary": 1
                }
              }
            ],
            "totalStats": [
              {
                "$group": {
                  "_id": null,
                  "totalEmployees": {
                    "$sum": 1
                  },
                  "avgSalary": {
                    "$avg": "$salary"
                  },
                  "totalPayroll": {
                    "$sum": "$salary"
                  }
                }
              }
            ]
          }
        }
      ],
      "expected_count": 1,
      "sort_by": null
    },
    {
      "id": "WINDOW001",
      "name": "$setWindowFields - rank by salary",
      "category": "setWindowFields",
      "operator": "$setWindowFields",
      "description": "Tests $setWindowFields with $rank partitioned by department",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$setWindowFields": {
            "partitionBy": "$department",
            "sortBy": {
              "salary": -1
            },
            "output": {
              "salaryRank": {
                "$rank": {}
              }
            }
          }
        },
        {
          "$match": {
            "salaryRank": 1
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "department": 1,
            "salary": 1,
            "salaryRank": 1
          }
        },
        {
          "$sort": {
            "department": 1
          }
        }
      ],
      "expected_count": 4,
      "sort_by": "department"
    },
    {
      "id": "WINDOW002",
      "name": "$setWindowFields - cumulative sum",
      "category": "setWindowFields",
      "operator": "$setWindowFields",
      "description": "Tests $setWindowFields with cumulative $sum",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "status": "completed"
          }
        },
        {
          "$setWindowFields": {
            "sortBy": {
              "orderDate": 1
            },
            "output": {
              "runningTotal": {
                "$sum": "$amount",
                "window": {
                  "documents": [
                    "unbounded",
                    "current"
                  ]
                }
              }
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "amount": 1,
            "runningTotal": 1
          }
        }
      ],
      "expected_count": 5,
      "sort_by": null
    },
    {
      "id": "WINDOW003",
      "name": "$setWindowFields - document number",
      "category": "setWindowFields",
      "operator": "$setWindowFields",
      "description": "Tests $setWindowFields with $documentNumber",
      "collection": "products",
      "mongodb_pipeline": [
        {
          "$match": {
            "active": true
          }
        },
        {
          "$setWindowFields": {
            "partitionBy": "$category",
            "sortBy": {
              "price": -1
            },
            "output": {
              "priceRankInCategory": {
                "$documentNumber": {}
              }
            }
          }
        },
        {
          "$match": {
            "priceRankInCategory": 1
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "category": 1,
            "price": 1
          }
        }
      ],
      "expected_count": 3,
      "sort_by": null
    },
    {
      "id": "WINDOW004",
      "name": "$setWindowFields - dense rank",
      "category": "setWindowFields",
      "operator": "$setWindowFields",
      "description": "Tests $setWindowFields with $denseRank",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$setWindowFields": {
            "sortBy": {
              "salary": -1
            },
            "output": {
              "denseRank": {
                "$denseRank": {}
              }
            }
          }
        },
        {
          "$match": {
            "denseRank": {
              "$lte": 3
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "salary": 1,
            "denseRank": 1
          }
        },
        {
          "$sort": {
            "denseRank": 1
          }
        }
      ],
      "expected_count": 3,
      "sort_by": "denseRank"
    },
    {
      "id": "TYPE001",
      "name": "$type - get field type",
      "category": "typeConversion",
      "operator": "$type",
      "description": "Tests $type operator to get BSON type of a field",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "statusType": {
              "$type": "$status"
            },
            "amountType": {
              "$type": "$amount"
            }
          }
        },
        {
          "$limit": 3
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 3,
      "sort_by": "_id"
    },
    {
      "id": "TYPE002",
      "name": "$toInt - convert string to integer",
      "category": "typeConversion",
      "operator": "$toInt",
      "description": "Tests $toInt operator to convert values to integers",
      "collection": "products",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "priceInt": {
              "$toInt": "$price"
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        },
        {
          "$limit": 5
        }
      ],
      "expected_count": 5,
      "sort_by": "_id"
    },
    {
      "id": "TYPE003",
      "name": "$toString - convert number to string",
      "category": "typeConversion",
      "operator": "$toString",
      "description": "Tests $toString operator to convert values to strings",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "salaryStr": {
              "$toString": "$salary"
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        },
        {
          "$limit": 5
        }
      ],
      "expected_count": 5,
      "sort_by": "_id"
    },
    {
      "id": "TYPE004",
      "name": "$toDouble - convert to double",
      "category": "typeConversion",
      "operator": "$toDouble",
      "description": "Tests $toDouble operator to convert values to doubles",
      "collection": "products",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "priceDouble": {
              "$toDouble": "$price"
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        },
        {
          "$limit": 5
        }
      ],
      "expected_count": 5,
      "sort_by": "_id"
    },
    {
      "id": "TYPE005",
      "name": "$toBool - convert to boolean",
      "category": "typeConversion",
      "operator": "$toBool",
      "description": "Tests $toBool operator to convert values to booleans",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "isActive": {
              "$toBool": "$active"
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        },
        {
          "$limit": 5
        }
      ],
      "expected_count": 5,
      "sort_by": "_id"
    },
    {
      "id": "STR007",
      "name": "$split - split string into array",
      "category": "string",
      "operator": "$split",
      "description": "Tests $split operator to split strings by delimiter",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$addFields": {
            "nameParts": {
              "$split": [
                "$name",
                " "
              ]
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "firstName": {
              "$arrayElemAt": [
                {
                  "$split": [
                    "$name",
                    " "
                  ]
                },
                0
              ]
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        },
        {
          "$limit": 5
        }
      ],
      "expected_count": 5,
      "sort_by": "_id"
    },
    {
      "id": "STR008",
      "name": "$indexOfCP - find substring position",
      "category": "string",
      "operator": "$indexOfCP",
      "description": "Tests $indexOfCP operator to find position of substring",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "aPosition": {
              "$indexOfCP": [
                "$name",
                "a"
              ]
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        },
        {
          "$limit": 5
        }
      ],
      "expected_count": 5,
      "sort_by": "_id"
    },
    {
      "id": "STR009",
      "name": "$regexMatch - regex pattern matching",
      "category": "string",
      "operator": "$regexMatch",
      "description": "Tests $regexMatch operator for pattern matching",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "hasVowelStart": {
              "$regexMatch": {
                "input": "$name",
                "regex": "^[AEIOUaeiou]"
              }
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        },
        {
          "$limit": 5
        }
      ],
      "expected_count": 5,
      "sort_by": "_id"
    },
    {
      "id": "STR010",
      "name": "$replaceOne - replace first occurrence",
      "category": "string",
      "operator": "$replaceOne",
      "description": "Tests $replaceOne operator to replace first match",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "modifiedDept": {
              "$replaceOne": {
                "input": "$department",
                "find": "Engineering",
                "replacement": "Tech"
              }
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        },
        {
          "$limit": 5
        }
      ],
      "expected_count": 5,
      "sort_by": "_id"
    },
    {
      "id": "STR011",
      "name": "$replaceAll - replace all occurrences",
      "category": "string",
      "operator": "$replaceAll",
      "description": "Tests $replaceAll operator to replace all matches",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "nameNoSpaces": {
              "$replaceAll": {
                "input": "$name",
                "find": " ",
                "replacement": "_"
              }
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        },
        {
          "$limit": 5
        }
      ],
      "expected_count": 5,
      "sort_by": "_id"
    },
    {
      "id": "ARR005",
      "name": "$filter - filter array elements",
      "category": "array",
      "operator": "$filter",
      "description": "Tests $filter operator to filter array elements by condition",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "highValueItems": {
              "$filter": {
                "input": "$items",
                "as": "item",
                "cond": {
                  "$gt": [
                    "$$item.qty",
                    1
                  ]
                }
              }
            }
          }
        },
        {
          "$sort": {
            "orderId": 1
          }
        },
        {
          "$limit": 5
        }
      ],
      "expected_count": 5,
      "sort_by": "orderId"
    },
    {
      "id": "ARR006",
      "name": "$map - transform array elements",
      "category": "array",
      "operator": "$map",
      "description": "Tests $map operator to transform array elements",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "itemProducts": {
              "$map": {
                "input": "$items",
                "as": "item",
                "in": "$$item.product"
              }
            }
          }
        },
        {
          "$sort": {
            "orderId": 1
          }
        },
        {
          "$limit": 5
        }
      ],
      "expected_count": 5,
      "sort_by": "orderId"
    },
    {
      "id": "ARR007",
      "name": "$reduce - reduce array to single value",
      "category": "array",
      "operator": "$reduce",
      "description": "Tests $reduce operator to reduce array to single value",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "totalQty": {
              "$reduce": {
                "input": "$items",
                "initialValue": 0,
                "in": {
                  "$add": [
                    "$$value",
                    "$$this.qty"
                  ]
                }
              }
            }
          }
        },
        {
          "$sort": {
            "orderId": 1
          }
        },
        {
          "$limit": 5
        }
      ],
      "expected_count": 5,
      "sort_by": "orderId"
    },
    {
      "id": "ARR008",
      "name": "$concatArrays - concatenate arrays",
      "category": "array",
      "operator": "$concatArrays",
      "description": "Tests $concatArrays operator to concatenate multiple arrays",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "tags": {
              "$exists": true
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "allLabels": {
              "$concatArrays": [
                "$tags",
                [
                  "extra"
                ]
              ]
            }
          }
        },
        {
          "$sort": {
            "orderId": 1
          }
        },
        {
          "$limit": 5
        }
      ],
      "expected_count": 5,
      "sort_by": "orderId"
    },
    {
      "id": "ARR009",
      "name": "$slice - get subset of array",
      "category": "array",
      "operator": "$slice",
      "description": "Tests $slice operator to get array subset",
      "collection": "products",
      "mongodb_pipeline": [
        {
          "$match": {
            "tags": {
              "$exists": true
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "firstTwoTags": {
              "$slice": [
                "$tags",
                2
              ]
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        },
        {
          "$limit": 5
        }
      ],
      "expected_count": 5,
      "sort_by": "_id"
    },
    {
      "id": "ARR010",
      "name": "$slice - get last elements",
      "category": "array",
      "operator": "$slice",
      "description": "Tests $slice operator to get last N elements",
      "collection": "products",
      "mongodb_pipeline": [
        {
          "$match": {
            "tags": {
              "$exists": true
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "lastTwoTags": {
              "$slice": [
                "$tags",
                -2
              ]
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        },
        {
          "$limit": 5
        }
      ],
      "expected_count": 5,
      "sort_by": "_id"
    },
    {
      "id": "REDACT001",
      "name": "$redact - document level filtering with PRUNE",
      "category": "redact",
      "operator": "$redact",
      "description": "Tests $redact stage to filter documents based on condition",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$redact": {
            "$cond": {
              "if": {
                "$gte": [
                  "$salary",
                  80000
                ]
              },
              "then": "$$KEEP",
              "else": "$$PRUNE"
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "salary": 1
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 6,
      "sort_by": "_id"
    },
    {
      "id": "REDACT002",
      "name": "$redact - with DESCEND for nested documents",
      "category": "redact",
      "operator": "$redact",
      "description": "Tests $redact stage with DESCEND option",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$redact": {
            "$cond": {
              "if": {
                "$eq": [
                  "$status",
                  "completed"
                ]
              },
              "then": "$$DESCEND",
              "else": "$$PRUNE"
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "status": 1
          }
        },
        {
          "$sort": {
            "orderId": 1
          }
        }
      ],
      "expected_count": 5,
      "sort_by": "orderId"
    },
    {
      "id": "SAMPLE001",
      "name": "$sample - random document selection",
      "category": "sample",
      "operator": "$sample",
      "description": "Tests $sample stage to randomly select documents",
      "collection": "products",
      "mongodb_pipeline": [
        {
          "$sample": {
            "size": 3
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1
          }
        }
      ],
      "expected_count": 3,
      "sort_by": null
    },
    {
      "id": "SAMPLE002",
      "name": "$sample - with subsequent processing",
      "category": "sample",
      "operator": "$sample",
      "description": "Tests $sample stage followed by other stages",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$sample": {
            "size": 5
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "department": 1
          }
        }
      ],
      "expected_count": 5,
      "sort_by": null
    },
    {
      "id": "COUNT001",
      "name": "$count - count all documents",
      "category": "count",
      "operator": "$count",
      "description": "Tests $count stage to count documents",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$count": "totalEmployees"
        }
      ],
      "expected_count": 1,
      "sort_by": null
    },
    {
      "id": "COUNT002",
      "name": "$count - count after filter",
      "category": "count",
      "operator": "$count",
      "description": "Tests $count stage after $match filter",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "status": "completed"
          }
        },
        {
          "$count": "completedOrders"
        }
      ],
      "expected_count": 1,
      "sort_by": null
    },
    {
      "id": "COUNT003",
      "name": "$count - count with complex filter",
      "category": "count",
      "operator": "$count",
      "description": "Tests $count stage with complex $match conditions",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$match": {
            "$and": [
              {
                "active": true
              },
              {
                "salary": {
                  "$gte": 80000
                }
              }
            ]
          }
        },
        {
          "$count": "highEarningActiveEmployees"
        }
      ],
      "expected_count": 1,
      "sort_by": null
    },
    {
      "id": "GRAPHLOOKUP001",
      "name": "$graphLookup - with restrictSearchWithMatch",
      "category": "graphLookup",
      "operator": "$graphLookup",
      "description": "Tests $graphLookup with restrictSearchWithMatch filter",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$match": {
            "_id": "E001"
          }
        },
        {
          "$graphLookup": {
            "from": "employees",
            "startWith": "$department",
            "connectFromField": "department",
            "connectToField": "department",
            "as": "colleagues",
            "maxDepth": 0,
            "restrictSearchWithMatch": {
              "active": true
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "colleagueCount": {
              "$size": "$colleagues"
            }
          }
        }
      ],
      "expected_count": 1,
      "sort_by": null
    },
    {
      "id": "NULL001",
      "name": "Null equality comparison",
      "category": "null_handling",
      "operator": "$eq",
      "description": "Tests matching documents where field equals null explicitly",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "discount": null
          }
        },
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "discount": 1
          }
        }
      ],
      "expected_count": 1,
      "sort_by": "_id"
    },
    {
      "id": "NULL002",
      "name": "IfNull default value",
      "category": "null_handling",
      "operator": "$ifNull",
      "description": "Tests $ifNull operator to replace null with default value",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "discountApplied": {
              "$ifNull": [
                "$discount",
                0
              ]
            }
          }
        }
      ],
      "expected_count": 10,
      "sort_by": "_id"
    },
    {
      "id": "NULL003",
      "name": "Null campaign field handling",
      "category": "null_handling",
      "operator": "$eq",
      "description": "Tests matching nested field with null value in metadata.campaign",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "metadata.campaign": null
          }
        },
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "campaign": "$metadata.campaign"
          }
        }
      ],
      "expected_count": 4,
      "sort_by": "_id"
    },
    {
      "id": "NULL004",
      "name": "Null in accumulator - sum",
      "category": "null_handling",
      "operator": "$sum",
      "description": "Tests $sum accumulator behavior with null values in group",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$group": {
            "_id": "$region",
            "totalDiscount": {
              "$sum": "$discount"
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 4,
      "sort_by": "_id"
    },
    {
      "id": "NULL005",
      "name": "Null in accumulator - avg",
      "category": "null_handling",
      "operator": "$avg",
      "description": "Tests $avg accumulator behavior with null values - nulls are ignored",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$group": {
            "_id": "$category",
            "avgDiscount": {
              "$avg": "$discount"
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 5,
      "sort_by": "_id"
    },
    {
      "id": "DATE006",
      "name": "Extract minute from date",
      "category": "date",
      "operator": "$minute",
      "description": "Tests $minute operator to extract minute component from date",
      "collection": "events",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "eventName": 1,
            "minute": {
              "$minute": "$eventDate"
            }
          }
        }
      ],
      "expected_count": 8,
      "sort_by": "_id"
    },
    {
      "id": "DATE007",
      "name": "Extract second from date",
      "category": "date",
      "operator": "$second",
      "description": "Tests $second operator to extract second component from date",
      "collection": "events",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "eventName": 1,
            "second": {
              "$second": "$eventDate"
            }
          }
        }
      ],
      "expected_count": 8,
      "sort_by": "_id"
    },
    {
      "id": "DATE008",
      "name": "Day of week",
      "category": "date",
      "operator": "$dayOfWeek",
      "description": "Tests $dayOfWeek operator - returns 1 (Sunday) to 7 (Saturday)",
      "collection": "events",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "eventName": 1,
            "dayOfWeek": {
              "$dayOfWeek": "$eventDate"
            }
          }
        }
      ],
      "expected_count": 8,
      "sort_by": "_id"
    },
    {
      "id": "DATE009",
      "name": "Day of year",
      "category": "date",
      "operator": "$dayOfYear",
      "description": "Tests $dayOfYear operator - returns day of year (1-366)",
      "collection": "events",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "eventName": 1,
            "dayOfYear": {
              "$dayOfYear": "$eventDate"
            }
          }
        }
      ],
      "expected_count": 8,
      "sort_by": "_id"
    },
    {
      "id": "DATE010",
      "name": "Week of year",
      "category": "date",
      "operator": "$week",
      "description": "Tests $week operator - returns ISO week number",
      "collection": "events",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "eventName": 1,
            "week": {
              "$week": "$eventDate"
            }
          }
        }
      ],
      "expected_count": 8,
      "sort_by": "_id"
    },
    {
      "id": "DATE012",
      "name": "Group by month from date",
      "category": "date",
      "operator": "$month",
      "description": "Tests grouping by month extracted from date field",
      "collection": "events",
      "mongodb_pipeline": [
        {
          "$group": {
            "_id": {
              "$month": "$eventDate"
            },
            "eventCount": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 3,
      "sort_by": "_id"
    },
    {
      "id": "ARITH006",
      "name": "Absolute value",
      "category": "arithmetic",
      "operator": "$abs",
      "description": "Tests $abs operator to get absolute value of negative numbers",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "amount": 1,
            "absoluteAmount": {
              "$abs": "$amount"
            }
          }
        }
      ],
      "expected_count": 10,
      "sort_by": "_id"
    },
    {
      "id": "ARITH007",
      "name": "Ceiling function",
      "category": "arithmetic",
      "operator": "$ceil",
      "description": "Tests $ceil operator to round up to nearest integer",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "tax": 1,
            "taxCeiled": {
              "$ceil": "$tax"
            }
          }
        }
      ],
      "expected_count": 10,
      "sort_by": "_id"
    },
    {
      "id": "ARITH008",
      "name": "Floor function",
      "category": "arithmetic",
      "operator": "$floor",
      "description": "Tests $floor operator to round down to nearest integer",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "amount": 1,
            "amountFloored": {
              "$floor": "$amount"
            }
          }
        }
      ],
      "expected_count": 10,
      "sort_by": "_id"
    },
    {
      "id": "ARITH009",
      "name": "Round function",
      "category": "arithmetic",
      "operator": "$round",
      "description": "Tests $round operator to round to specified decimal places",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "amount": 1,
            "amountRounded": {
              "$round": [
                "$amount",
                0
              ]
            }
          }
        }
      ],
      "expected_count": 10,
      "sort_by": "_id"
    },
    {
      "id": "ARITH010",
      "name": "Truncate function",
      "category": "arithmetic",
      "operator": "$trunc",
      "description": "Tests $trunc operator to truncate decimal places",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "amount": 1,
            "amountTruncated": {
              "$trunc": [
                "$amount",
                1
              ]
            }
          }
        }
      ],
      "expected_count": 10,
      "sort_by": "_id"
    },
    {
      "id": "STR012",
      "name": "Left trim",
      "category": "string",
      "operator": "$ltrim",
      "description": "Tests $ltrim operator to remove leading whitespace",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "trimmedName": {
              "$ltrim": {
                "input": "$name"
              }
            }
          }
        }
      ],
      "expected_count": 10,
      "sort_by": "_id"
    },
    {
      "id": "STR013",
      "name": "Right trim",
      "category": "string",
      "operator": "$rtrim",
      "description": "Tests $rtrim operator to remove trailing whitespace",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "trimmedName": {
              "$rtrim": {
                "input": "$name"
              }
            }
          }
        }
      ],
      "expected_count": 10,
      "sort_by": "_id"
    },
    {
      "id": "STR014",
      "name": "String case comparison",
      "category": "string",
      "operator": "$strcasecmp",
      "description": "Tests $strcasecmp operator for case-insensitive string comparison",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "department": 1,
            "compareResult": {
              "$strcasecmp": [
                "$department",
                "ENGINEERING"
              ]
            }
          }
        }
      ],
      "expected_count": 10,
      "sort_by": "_id"
    },
    {
      "id": "ARR011",
      "name": "Reverse array",
      "category": "array",
      "operator": "$reverseArray",
      "description": "Tests $reverseArray operator to reverse array element order",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "_id": "S001"
          }
        },
        {
          "$project": {
            "_id": 1,
            "tags": 1,
            "reversedTags": {
              "$reverseArray": "$tags"
            }
          }
        }
      ],
      "expected_count": 1,
      "sort_by": "_id"
    },
    {
      "id": "ARR012",
      "name": "Is array check",
      "category": "array",
      "operator": "$isArray",
      "description": "Tests $isArray operator to check if field is an array",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "isTagsArray": {
              "$isArray": "$tags"
            },
            "isAmountArray": {
              "$isArray": "$amount"
            }
          }
        }
      ],
      "expected_count": 10,
      "sort_by": "_id"
    },
    {
      "id": "ARR013",
      "name": "Set union",
      "category": "array",
      "operator": "$setUnion",
      "description": "Tests $setUnion operator for union of two arrays",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "_id": "S001"
          }
        },
        {
          "$project": {
            "_id": 1,
            "tags": 1,
            "unionResult": {
              "$setUnion": [
                "$tags",
                [
                  "new-tag",
                  "premium"
                ]
              ]
            }
          }
        }
      ],
      "expected_count": 1,
      "sort_by": "_id"
    },
    {
      "id": "ARR014",
      "name": "Set intersection",
      "category": "array",
      "operator": "$setIntersection",
      "description": "Tests $setIntersection operator for intersection of arrays",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "_id": "S001"
          }
        },
        {
          "$project": {
            "_id": 1,
            "tags": 1,
            "intersectResult": {
              "$setIntersection": [
                "$tags",
                [
                  "premium",
                  "discount"
                ]
              ]
            }
          }
        }
      ],
      "expected_count": 1,
      "sort_by": "_id"
    },
    {
      "id": "CMP009",
      "name": "Field exists - true",
      "category": "comparison",
      "operator": "$exists",
      "description": "Tests $exists operator to match documents where field exists",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "metadata": {
              "$exists": true
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "orderId": 1
          }
        }
      ],
      "expected_count": 9,
      "sort_by": "_id"
    },
    {
      "id": "CMP010",
      "name": "Field exists - false",
      "category": "comparison",
      "operator": "$exists",
      "description": "Tests $exists operator to match documents where field does not exist",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "metadata": {
              "$exists": false
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "orderId": 1
          }
        }
      ],
      "expected_count": 1,
      "sort_by": "_id"
    },
    {
      "id": "LOG006",
      "name": "Nor condition",
      "category": "logical",
      "operator": "$nor",
      "description": "Tests $nor operator - none of the conditions match",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "$nor": [
              {
                "status": "completed"
              },
              {
                "status": "pending"
              }
            ]
          }
        },
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "status": 1
          }
        }
      ],
      "expected_count": 4,
      "sort_by": "_id"
    },
    {
      "id": "AGG009",
      "name": "First in group",
      "category": "accumulator",
      "operator": "$first",
      "description": "Tests $first accumulator to get first value in each group",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$sort": {
            "salary": -1
          }
        },
        {
          "$group": {
            "_id": "$department",
            "highestPaidEmployee": {
              "$first": "$name"
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 4,
      "sort_by": "_id"
    },
    {
      "id": "AGG010",
      "name": "Last in group",
      "category": "accumulator",
      "operator": "$last",
      "description": "Tests $last accumulator to get last value in each group",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$sort": {
            "salary": -1
          }
        },
        {
          "$group": {
            "_id": "$department",
            "lowestPaidEmployee": {
              "$last": "$name"
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 4,
      "sort_by": "_id"
    },
    {
      "id": "COMPLEX006",
      "name": "Unwind then group",
      "category": "complex",
      "operator": "$unwind+$group",
      "description": "Tests flattening array with $unwind then aggregating with $group",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$unwind": "$items"
        },
        {
          "$group": {
            "_id": "$items.product",
            "totalQuantity": {
              "$sum": "$items.qty"
            },
            "totalRevenue": {
              "$sum": {
                "$multiply": [
                  "$items.qty",
                  "$items.price"
                ]
              }
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 10,
      "sort_by": "_id"
    },
    {
      "id": "COMPLEX007",
      "name": "Group sort limit - Top N",
      "category": "complex",
      "operator": "$group+$sort+$limit",
      "description": "Tests Top N pattern - aggregate, sort, and limit",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$group": {
            "_id": "$category",
            "totalAmount": {
              "$sum": "$amount"
            },
            "orderCount": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "totalAmount": -1
          }
        },
        {
          "$limit": 3
        }
      ],
      "expected_count": 3,
      "sort_by": null
    },
    {
      "id": "COMPLEX008",
      "name": "Union then aggregate",
      "category": "complex",
      "operator": "$unionWith+$group",
      "description": "Tests combining collections with $unionWith then aggregating",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$project": {
            "source": "sales",
            "amount": 1
          }
        },
        {
          "$unionWith": {
            "coll": "products",
            "pipeline": [
              {
                "$project": {
                  "source": "products",
                  "amount": "$price"
                }
              }
            ]
          }
        },
        {
          "$group": {
            "_id": "$source",
            "totalAmount": {
              "$sum": "$amount"
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ],
      "expected_count": 2,
      "sort_by": "_id"
    },
    {
      "id": "EXPR001",
      "name": "Switch expression",
      "category": "expression",
      "operator": "$switch",
      "description": "Tests $switch operator for multi-branch conditional logic",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "salary": 1,
            "salaryBand": {
              "$switch": {
                "branches": [
                  {
                    "case": {
                      "$lt": [
                        "$salary",
                        60000
                      ]
                    },
                    "then": "Junior"
                  },
                  {
                    "case": {
                      "$lt": [
                        "$salary",
                        90000
                      ]
                    },
                    "then": "Mid"
                  },
                  {
                    "case": {
                      "$gte": [
                        "$salary",
                        90000
                      ]
                    },
                    "then": "Senior"
                  }
                ],
                "default": "Unknown"
              }
            }
          }
        }
      ],
      "expected_count": 10,
      "sort_by": "_id"
    },
    {
      "id": "EXPR002",
      "name": "Nested conditional",
      "category": "expression",
      "operator": "$cond",
      "description": "Tests deeply nested $cond expressions",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "status": 1,
            "priority": {
              "$cond": {
                "if": {
                  "$eq": [
                    "$status",
                    "completed"
                  ]
                },
                "then": "low",
                "else": {
                  "$cond": {
                    "if": {
                      "$eq": [
                        "$status",
                        "pending"
                      ]
                    },
                    "then": "high",
                    "else": "medium"
                  }
                }
              }
            }
          }
        }
      ],
      "expected_count": 10,
      "sort_by": "_id"
    },
    {
      "id": "REPLACEROOT001",
      "name": "Replace root with nested object",
      "category": "replaceRoot",
      "operator": "$replaceRoot",
      "description": "Tests $replaceRoot to promote nested object to root",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "metadata": {
              "$ne": null
            }
          }
        },
        {
          "$replaceRoot": {
            "newRoot": {
              "orderId": "$orderId",
              "source": "$metadata.source",
              "campaign": "$metadata.campaign"
            }
          }
        }
      ],
      "expected_count": 9,
      "sort_by": null
    },
    {
      "id": "OBJ001",
      "name": "Merge objects in projection",
      "category": "object",
      "operator": "$mergeObjects",
      "description": "Tests $mergeObjects operator to combine objects in projection",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "_id": "S001"
          }
        },
        {
          "$project": {
            "_id": 1,
            "merged": {
              "$mergeObjects": [
                {
                  "orderId": "$orderId"
                },
                "$metadata"
              ]
            }
          }
        }
      ],
      "expected_count": 1,
      "sort_by": "_id"
    },
    {
      "id": "LOOKUP003",
      "name": "Self join lookup",
      "category": "lookup",
      "operator": "$lookup",
      "description": "Tests $lookup self-join on same collection",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$match": {
            "_id": "E001"
          }
        },
        {
          "$lookup": {
            "from": "employees",
            "localField": "department",
            "foreignField": "department",
            "as": "colleagues"
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "department": 1,
            "colleagueCount": {
              "$size": "$colleagues"
            }
          }
        }
      ],
      "expected_count": 1,
      "sort_by": "_id"
    },
    {
      "id": "LOOKUP004",
      "name": "Multiple lookups in pipeline",
      "category": "lookup",
      "operator": "$lookup",
      "description": "Tests chain of multiple $lookup stages",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "_id": "S001"
          }
        },
        {
          "$lookup": {
            "from": "customers",
            "localField": "customerId",
            "foreignField": "customerId",
            "as": "customer"
          }
        },
        {
          "$lookup": {
            "from": "inventory",
            "localField": "orderId",
            "foreignField": "productId",
            "as": "inventoryItems"
          }
        },
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "hasCustomer": {
              "$gt": [
                {
                  "$size": "$customer"
                },
                0
              ]
            },
            "inventoryCount": {
              "$size": "$inventoryItems"
            }
          }
        }
      ],
      "expected_count": 1,
      "sort_by": "_id"
    },
    {
      "id": "LOOKUP_PIPELINE001",
      "name": "$lookup with pipeline - basic let/match",
      "category": "lookup",
      "operator": "$lookup",
      "description": "Tests $lookup with pipeline form using let variables and $match",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "status": "completed"
          }
        },
        {
          "$lookup": {
            "from": "customers",
            "let": {
              "custId": "$customerId"
            },
            "pipeline": [
              {
                "$match": {
                  "$expr": {
                    "$eq": [
                      "$_id",
                      "$$custId"
                    ]
                  }
                }
              }
            ],
            "as": "customerData"
          }
        },
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "customerData": 1
          }
        },
        {
          "$sort": {
            "orderId": 1
          }
        }
      ],
      "expected_count": 5
    },
    {
      "id": "LOOKUP_PIPELINE002",
      "name": "$lookup with pipeline - filter by status",
      "category": "lookup",
      "operator": "$lookup",
      "description": "Tests $lookup pipeline filtering related documents by status",
      "collection": "customers",
      "mongodb_pipeline": [
        {
          "$match": {
            "tier": "gold"
          }
        },
        {
          "$lookup": {
            "from": "sales",
            "let": {
              "custId": "$_id"
            },
            "pipeline": [
              {
                "$match": {
                  "$expr": {
                    "$and": [
                      {
                        "$eq": [
                          "$customerId",
                          "$$custId"
                        ]
                      },
                      {
                        "$eq": [
                          "$status",
                          "completed"
                        ]
                      }
                    ]
                  }
                }
              }
            ],
            "as": "completedOrders"
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "orderCount": {
              "$size": "$completedOrders"
            }
          }
        }
      ],
      "expected_count": 2
    },
    {
      "id": "LOOKUP_PIPELINE003",
      "name": "$lookup with pipeline - with $sort inside",
      "category": "lookup",
      "operator": "$lookup",
      "description": "Tests $lookup pipeline with $sort stage to order results",
      "collection": "customers",
      "mongodb_pipeline": [
        {
          "$match": {
            "_id": "C001"
          }
        },
        {
          "$lookup": {
            "from": "sales",
            "let": {
              "custId": "$_id"
            },
            "pipeline": [
              {
                "$match": {
                  "$expr": {
                    "$eq": [
                      "$customerId",
                      "$$custId"
                    ]
                  }
                }
              },
              {
                "$sort": {
                  "amount": -1
                }
              }
            ],
            "as": "ordersByAmount"
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "ordersByAmount": 1
          }
        }
      ],
      "expected_count": 1
    },
    {
      "id": "LOOKUP_PIPELINE004",
      "name": "$lookup with pipeline - with $limit inside",
      "category": "lookup",
      "operator": "$lookup",
      "description": "Tests $lookup pipeline with $limit to restrict results",
      "collection": "customers",
      "mongodb_pipeline": [
        {
          "$match": {
            "tier": "gold"
          }
        },
        {
          "$lookup": {
            "from": "sales",
            "let": {
              "custId": "$_id"
            },
            "pipeline": [
              {
                "$match": {
                  "$expr": {
                    "$eq": [
                      "$customerId",
                      "$$custId"
                    ]
                  }
                }
              },
              {
                "$sort": {
                  "orderDate": -1
                }
              },
              {
                "$limit": 3
              }
            ],
            "as": "recentOrders"
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "recentOrders": 1
          }
        }
      ],
      "expected_count": 2
    },
    {
      "id": "LOOKUP_PIPELINE005",
      "name": "$lookup with empty pipeline",
      "category": "lookup",
      "operator": "$lookup",
      "description": "Tests $lookup pipeline form with empty pipeline (selects all)",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "_id": "S001"
          }
        },
        {
          "$lookup": {
            "from": "inventory",
            "let": {},
            "pipeline": [],
            "as": "allInventory"
          }
        },
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "inventoryCount": {
              "$size": "$allInventory"
            }
          }
        }
      ],
      "expected_count": 1
    },
    {
      "id": "WINDOW005",
      "name": "Window running total",
      "category": "window",
      "operator": "$setWindowFields",
      "description": "Tests running total with window function",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$match": {
            "status": "completed"
          }
        },
        {
          "$setWindowFields": {
            "sortBy": {
              "orderDate": 1
            },
            "output": {
              "runningTotal": {
                "$sum": "$amount",
                "window": {
                  "documents": [
                    "unbounded",
                    "current"
                  ]
                }
              }
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "amount": 1,
            "runningTotal": 1
          }
        }
      ],
      "expected_count": 5,
      "sort_by": null
    },
    {
      "id": "WINDOW006",
      "name": "Window moving average",
      "category": "window",
      "operator": "$setWindowFields",
      "description": "Tests moving average with 3-row window",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$setWindowFields": {
            "sortBy": {
              "salary": 1
            },
            "output": {
              "movingAvgSalary": {
                "$avg": "$salary",
                "window": {
                  "documents": [
                    -1,
                    1
                  ]
                }
              }
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "salary": 1,
            "movingAvgSalary": 1
          }
        }
      ],
      "expected_count": 10,
      "sort_by": null
    },
    {
      "id": "REDUCE001",
      "name": "$reduce - sum array elements",
      "category": "array",
      "operator": "$reduce",
      "description": "Tests $reduce operator with sum pattern to total item prices",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "itemTotal": {
              "$reduce": {
                "input": "$items",
                "initialValue": 0,
                "in": {
                  "$add": [
                    "$$value",
                    "$$this.price"
                  ]
                }
              }
            }
          }
        }
      ],
      "expected_count": 10,
      "sort_by": "_id"
    },
    {
      "id": "REDUCE002",
      "name": "$reduce - concatenate tags",
      "category": "array",
      "operator": "$reduce",
      "description": "Tests $reduce operator with concat pattern to join tags",
      "collection": "products",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "allTags": {
              "$reduce": {
                "input": "$tags",
                "initialValue": "",
                "in": {
                  "$concat": [
                    "$$value",
                    "$$this"
                  ]
                }
              }
            }
          }
        }
      ],
      "expected_count": 10,
      "sort_by": "name"
    },
    {
      "id": "GRAPHLOOKUP002",
      "name": "$graphLookup - recursive hierarchy",
      "category": "graphLookup",
      "operator": "$graphLookup",
      "description": "Tests $graphLookup with recursive depth for hierarchical data traversal",
      "collection": "employees",
      "mongodb_pipeline": [
        {
          "$graphLookup": {
            "from": "employees",
            "startWith": "$_id",
            "connectFromField": "reportsTo",
            "connectToField": "_id",
            "as": "reportingChain",
            "maxDepth": 3,
            "depthField": "depth"
          }
        },
        {
          "$project": {
            "_id": 1,
            "name": 1,
            "reportingChain": 1
          }
        }
      ],
      "skip": true,
      "skip_reason": "$graphLookup requires hierarchical test data with reportsTo field - unit tests in PipelineRendererTest cover recursive CTE generation"
    },
    {
      "id": "ARR015",
      "name": "$filter on field path array",
      "category": "array",
      "operator": "$filter",
      "description": "Tests $filter operator with field path array input - supported case",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "expensiveItems": {
              "$filter": {
                "input": "$items",
                "as": "item",
                "cond": {
                  "$gte": [
                    "$$item.price",
                    100
                  ]
                }
              }
            }
          }
        }
      ],
      "expected_count": 10,
      "sort_by": "_id"
    },
    {
      "id": "ARR016",
      "name": "$map on field path array",
      "category": "array",
      "operator": "$map",
      "description": "Tests $map operator with field path array input - supported case",
      "collection": "sales",
      "mongodb_pipeline": [
        {
          "$project": {
            "_id": 1,
            "orderId": 1,
            "productNames": {
              "$map": {
                "input": "$items",
                "as": "item",
                "in": "$$item.product"
              }
            }
          }
        }
      ],
      "expected_count": 10,
      "sort_by": "_id"
    }
  ]
}
